cscope 15 $HOME\Cplusplus\Github\myjdkmidi"               0000266291
	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\advancedsequencer.h

5 #iâdeà
_JDKMIDI_ADVANCEDSEQUENCER_H


6 
	#_JDKMIDI_ADVANCEDSEQUENCER_H


	)

8 
	~<veùÜ
>

9 
	~<¡ršg
>

15 
	~"msg.h
"

16 
	~"driv”.h
"

17 
	~"muÉ™¿ck.h
"

18 
	~"£qu’ûr.h
"

19 
	~"mªag”.h
"

24 şas 
	cAdvªûdSequ’ûr
 {

25 
	mpublic
:

28 
AdvªûdSequ’ûr
(
MIDISequ’ûrGUINÙif›r
 *
n
 = 0);

29 
AdvªûdSequ’ûr
(
MIDIMuÉiT¿ck
* 
mÉ
, 
MIDISequ’ûrGUINÙif›r
 *
n
 = 0);

30 
AdvªûdSequ’ûr
(
MIDIMªag”
* 
mg
);

31 
	mvœtu®
 ~
AdvªûdSequ’ûr
();

33 
S‘OuutPÜt
Ğ
p
);

34 
	$G‘OuutPÜt
(ècÚ¡ {  
out_pÜt
; }

35 
	`S‘IÅutPÜt
Ğ
p
);

36 
	$G‘IÅutPÜt
(ècÚ¡ {  
š_pÜt
; 
	}
}

38 
	$S‘MIDIThruEÇbË
 (
boŞ
 
f
è{ 
mgr
->
	`S‘ThruEÇbË
 (f); 
	}
};

39 
boŞ
 
	$G‘MIDIThruEÇbË
(ècÚ¡ {  
mgr
->
	`G‘ThruEÇbË
(); 
	}
};

40 
S‘MIDIThruChªÃl
 (
chª
);

41 
	$G‘MIDIThruChªÃl
(ècÚ¡ {  
thru_»chªÃliz”
.
	`G‘RechªM­
(0); 
	}
};

42 
S‘MIDIThruT¿n¥o£
 (
v®
);

43 
	$G‘MIDIThruT¿n¥o£
(ècÚ¡ {  
thru_Œª¥o£r
.
	`G‘T¿n¥o£ChªÃl
(0); 
	}
};

45 
boŞ
 
Lßd
(cÚ¡ *
âame
);

46 
UnLßd
();

47 
Re£t
();

48 
boŞ
 
	$IsLßded
(ècÚ¡ {  
fe_lßded
; 
	}
};

50 
MIDIMuÉiT¿ck
* 
	$G‘MuÉiT¿ck
(è{  
Œacks
; 
	}
}

51 cÚ¡ 
MIDIMuÉiT¿ck
* 
	$G‘MUÉiT¿ck
(ècÚ¡ {  
Œacks
; 
	}
}

53 
GoToZ”o
();

54 
GoToM—su»
(
m—su»
, 
b—t
 = 0);

55 
GoToTime
(
MIDIClockTime
 
t
);

57 
PÏy
();

58 
Stİ
();

59 
OuutMes§ge
(
MIDITimedMes§ge
& 
msg
);

60 
S‘R•—tPÏy
(
boŞ
 
’abË
, 
¡¬t_m—su»
, 
’d_m—su»
);

61 
boŞ
 
	$G‘R•—tPÏy
(ècÚ¡ {  
»³©_¶ay_mode
; 
	}
}

62 
	$G‘R•—tPÏyS¹
(ècÚ¡ {  
»³©_¡¬t_m—su»
; 
	}
}

63 
	$G‘R•—tPÏyEnd
(ècÚ¡ {  
»³©_’d_m—su»
; 
	}
}

64 
boŞ
 
	$IsPÏy
(ècÚ¡ {  
mgr
->
	`IsSeqPÏy
(); 
	}
};

66 
SŞoT¿ck
(
Œk
);

67 
UnSŞoT¿ck
();

68 
boŞ
 
	$G‘T¿ckSŞo
(
Œk
è{  
£q
->
	`G‘T¿ckProûssÜ
 (Œk)->
sŞo
; 
	}
}

69 
S‘T¿ckMu‹
(
Œk
, 
boŞ
 
f
);

70 
boŞ
 
	$G‘T¿ckMu‹
 (
Œk
è{  
£q
->
	`G‘T¿ckProûssÜ
 (Œk)->
mu‹
; 
	}
}

71 
Unmu‹AÎT¿cks
();

72 
	$S‘TempoSÿË
(
sÿË
)

73 { ià(
fe_lßded
è
£q
->
	`S‘Cu¼’tTempoSÿË
Ğ()
sÿË
); 
	}
}

74 
	$G‘TempoW™houtSÿË
() const

75 {  
£q
->
	`G‘Cu¼’tTempo
(); 
	}
}

76 
	$G‘TempoW™hSÿË
() const

77 {  
£q
->
	`G‘Cu¼’tTempo
(è* seq->
	`G‘Cu¼’tTempoSÿË
(); 
	}
}

81 
MIDIClockTime
 
	$G‘Cu¼’tMIDIClockTime
() const;

85 
tM£cs
 
	$G‘Cu¼’tTimeInMs
() const;

92 
boŞ
 
	`S‘ClksP”B—t
 ( 
ıb
 );

95 
	$G‘ClksP”B—t
() const

96 {  
Œacks
->
	`G‘ClksP”B—t
(); 
	}
}

99 
	$G‘NumT¿cks
() const

104 {  
£q
->
	`G‘NumT¿cks
(); 
	}
}

107 
	$G‘NumM—su»s
(ècÚ¡ {  
num_m—su»s
; 
	}
}

108 
	$G‘M—su»
() const;

109 
	$G‘B—t
() const;

110 
	$G‘TimeSigNum”©Ü
() const;

111 
	$G‘TimeSigD’omš©Ü
() const;

112 
	$G‘KeySigSh¬pFÏt
() const;

113 
	$G‘KeySigMode
() const;

114 
	$G‘T¿ckNÙeCouÁ
(
Œk
) const;

115 
¡d
::
¡ršg
 
	$G‘T¿ckName
(
Œk
) const;

116 
	$G‘T¿ckVŞume
(
Œk
) const;

117 
	$G‘T¿ckProg¿m
 ( 
Œk
 ) const;

118 
	`S‘T¿ckV–oc™ySÿË
(
Œk
, 
sÿË
);

119 
	$G‘T¿ckV–oc™ySÿË
(
Œk
) const;

120 
	`S‘T¿ckRechªÃlize
(
Œk
, 
chª
);

121 
	$G‘T¿ckRechªÃlize
(
Œk
) const;

122 
	`S‘T¿ckT¿n¥o£
(
Œk
, 
Œªs
);

123 
	$G‘T¿ckT¿n¥o£
(
Œk
) const;

124 
¡d
::
¡ršg
 
	$G‘Cu¼’tM¬k”
() const;

126 
	`FšdFœ¡ChªÃlOnT¿ck
(
Œk
);

127 
	`S‘Chªged
();

129 
	$MIDItoMs
(
MIDIClockTime
 
t
è{  
£q
->
	`MIDItoMs
Ñ); 
	}
}

131 
	g´Ùeùed
:

133 cÚ¡ 
MEASURES_PER_WARP
 = 4;

145 
ExŒaùW¬pPos™iÚs
();

146 
C©chEv’tsBefÜe
();

147 
C©chEv’tsBefÜe
(
Œk
);

149 
MIDISequ’ûrGUINÙif›r
* 
	gnÙif›r
;

150 
MIDIMuÉiT¿ck
* 
	gŒacks
;

151 
MIDISequ’ûr
* 
	g£q
;

152 
MIDIMªag”
* 
	gmgr
;

154 
MIDIMuÉiProûssÜ
 
	gthru_´oûssÜ
;

155 
MIDIProûssÜT¿n¥o£r
 
	gthru_Œª¥o£r
;

156 
MIDIProûssÜRechªÃliz”
 
	gthru_»chªÃliz”
;

158 
	gnum_m—su»s
;

159 
	g»³©_¡¬t_m—su»
;

160 
	g»³©_’d_m—su»
;

161 
boŞ
 
	g»³©_¶ay_mode
;

162 
boŞ
 
	gfe_lßded
;

164 
	g¡d
::
veùÜ
<
MIDISequ’ûrS‹
> 
w¬p_pos™iÚs
;

169 
	gš_pÜt
;

170 
	gout_pÜt
;

172 
	g´iv©e
:

173 ’um { 
CTOR_1
, 
	gCTOR_2
, 
	gCTOR_3
 };

174 
	gùÜ_ty³
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\driver.h

27 #iâdeà
_JDKMIDI_DRIVER_H


28 
	#_JDKMIDI_DRIVER_H


	)

30 
	~"msg.h
"

31 
	~"m©rix.h
"

32 
	~"´oûss.h
"

35 
	~"../¹midi-2.1.1/RtMidi.h
"

37 
	~<veùÜ
>

38 
	~<¡ršg
>

39 
	~<mu‹x
>

40 
	~<©omic
>

47 
	#DRIVER_USES_MIDIMATRIX
 0

	)

50 
	#DRIVER_MAX_RETRIES
 100

	)

52 
	#DRIVER_WAIT_AFTER_SYSEX
 20

	)

54 şas 
	cMIDIOutDriv”
 {

55 
	mpublic
:

60 
MIDIOutDriv”
 (
id
);

62 
	mvœtu®
 ~
MIDIOutDriv”
();

65 
	$G‘PÜtId
(ècÚ¡ {  
pÜt_id
; }

67 
¡d
::
¡ršg
 
	$G‘PÜtName
(è{  
pÜt
->
	`g‘PÜtName
(
pÜt_id
); 
	}
}

69 
boŞ
 
	$IsPÜtO³n
(ècÚ¡ {  
pÜt
->
	`isPÜtO³n
(); 
	}
}

71 
MIDIProûssÜ
* 
	$G‘OutProûssÜ
(è{  
´oûssÜ
; 
	}
}

72 cÚ¡ 
MIDIProûssÜ
* 
	$G‘OutProûssÜ
(ècÚ¡ {  
´oûssÜ
; 
	}
}

75 
vœtu®
 
	$S‘OutProûssÜ
(
MIDIProûssÜ
* 
´oc
)

76 { 
´oûssÜ
 = 
´oc
; 
	}
}

80 
vœtu®
 
O³nPÜt
();

82 
vœtu®
 
Clo£PÜt
();

86 
vœtu®
 
AÎNÙesOff
(
chª
);

88 
vœtu®
 
AÎNÙesOff
();

93 
vœtu®
 
OuutMes§ge
(cÚ¡ 
MIDITimedMes§ge
& 
msg
);

95 
	g´Ùeùed
:

97 
vœtu®
 
H¬dw¬eMsgOut
(cÚ¡ 
MIDIMes§ge
 &
msg
);

99 
MIDIProûssÜ
* 
	g´oûssÜ
;

100 
RtMidiOut
* 
	gpÜt
;

101 cÚ¡ 
	gpÜt_id
;

105 
	g¡d
::
©omic
<> 
busy
;

107 #ià
DRIVER_USES_MIDIMATRIX


108 
MIDIM©rix
 
	gout_m©rix
;

110 
	g´iv©e
:

112 
¡d
::
veùÜ
<> 
msg_by‹s
;

119 şas 
	cMIDIInDriv”
 {

120 
	mpublic
:

122 
MIDIInDriv”
(
queue_size
 );

123 
	mvœtu®
 ~
MIDIInDriv”
();

128 
	$G‘PÜtId
(ècÚ¡ {  
pÜt_id
; }

130 
¡d
::
¡ršg
 
	$G‘PÜtName
(è{  
pÜt
->
	`g‘PÜtName
(
pÜt_id
); 
	}
}

132 
boŞ
 
	$IsPÜtO³n
(ècÚ¡ {  
pÜt
->
	`isPÜtO³n
(); 
	}
}

134 
MIDIProûssÜ
* 
	$G‘InProûssÜ
(è{  
´oûssÜ
; 
	}
}

135 cÚ¡ 
MIDIProûssÜ
* 
	$G‘InProûssÜ
(ècÚ¡ {  
´oûssÜ
; 
	}
}

138 
vœtu®
 
	$S‘InProûssÜ
(
MIDIProûssÜ
* 
´oc
)

139 { 
´oûssÜ
 = 
´oc
; 
	}
}

141 
vœtu®
 
O³nPÜt
();

144 
vœtu®
 
Clo£PÜt
();

153 
	g´Ùeùed
:

159 
MIDIProûssÜ
* 
´oûssÜ
;

160 
RtMidiIn
* 
	gpÜt
;

161 cÚ¡ 
	gpÜt_id
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\dump_tracks.h

1 #iâdeà
DUMP_TRACKS_H_INCLUDED


2 
	#DUMP_TRACKS_H_INCLUDED


	)

5 
	~"muÉ™¿ck.h
"

7 
DumpMIDITimedMes§ge
 (
MIDITimedMes§ge
* cÚ¡ 
msg
);

8 
DumpMIDIT¿ck
 (
MIDIT¿ck
* cÚ¡ 
t
);

9 
DumpAÎT¿cks
 (
MIDIMuÉiT¿ck
* cÚ¡ 
mÉ
);

10 
DumpMIDIMuÉiT¿ck
 (
MIDIMuÉiT¿ck
*cÚ¡ 
mÉ
);

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\file.h

44 #iâdeà
_JDKMIDI_FILE_H


45 
	#_JDKMIDI_FILE_H


	)

47 
	~"midi.h
"

48 
	~"msg.h
"

54 cÚ¡ 
	g_MThd
=
OSTYPE
('M','T','h','d');

55 cÚ¡ 
	g_MTrk
=
OSTYPE
('M','T','r','k');

58 
	sMIDIFeChunk
 {

59 
	mid
;

60 
	mËngth
;

64 
	sMIDIFeH—d”
 {

65 
MIDIFeH—d”
(è: 
fÜm©
(0), 
Árks
(0), 
divisiÚ
(0) {}

66 
	mfÜm©
;

67 
	mÁrks
;

68 
	mdivisiÚ
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\fileread.h

46 #iâdeà
_JDKMIDI_FILEREAD_H


47 
	#_JDKMIDI_FILEREAD_H


	)

49 
	~<f¡»am
>

51 
	~"midi.h
"

52 
	~"msg.h
"

53 
	~"sy£x.h
"

54 
	~"fe.h
"

61 şas 
	cMIDIFeR—dSŒ—m
 {

62 
	mpublic
:

65 
ex¶ic™
 
MIDIFeR—dSŒ—m
(cÚ¡ *
âame
);

68 
ex¶ic™
 
MIDIFeR—dSŒ—m
(
¡d
::
i¡»am
* 
ifs
);

70 
	mvœtu®
 ~
MIDIFeR—dSŒ—m
();

73 
vœtu®
 
Rewšd
();

75 
vœtu®
 
R—dCh¬
();

77 
vœtu®
 
boŞ
 
IsV®id
();

79 
	m´iv©e
:

80 
¡d
::
i¡»am
* 
šfs
;

81 
boŞ
 
	md–
;

89 şas 
	cMIDIFeEv’tHªdËr
 {

90 
	mpublic
:

91 
	$MIDIFeEv’tHªdËr
() {}

92 
vœtu®
 ~
	$MIDIFeEv’tHªdËr
(è{
	}
}

98 
vœtu®
 
	$mf_sy¡em_mode
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

99 
vœtu®
 
	$mf_nÙe_Ú
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

100 
vœtu®
 
	$mf_nÙe_off
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

101 
vœtu®
 
	$mf_pŞy_aá”
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

102 
vœtu®
 
	$mf_b’d”
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

103 
vœtu®
 
	$mf_´og¿m
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

104 
vœtu®
 
	$mf_chª_aá”
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

105 
vœtu®
 
	$mf_cÚŒŞ
(cÚ¡ 
MIDITimedMes§ge
 &
msg
è{
	}
}

107 
vœtu®
 
	$mf_sy£x
(
MIDIClockTime
 
time
, cÚ¡ 
MIDISy¡emExşusive
 &
ex
è{
	}
}

108 
vœtu®
 
	$mf_¬b™¿ry
(
MIDIClockTime
 
time
, 
Ën
, *
d©a
è{
	}
}

109 
vœtu®
 
	$mf_m‘amisc
(
MIDIClockTime
 
time
, , , *è{
	}
}

110 
vœtu®
 
	$mf_m‘a16
 (
MIDIClockTime
 
time
, 
ty³
, 
b1
, 
b2
 ) {
	}
}

111 
vœtu®
 
	$mf_sm±e
Ğ
MIDIClockTime
 
time
, 
h
, 
m
, 
s
, 
f
, 
sf
 ) {
	}
}

112 
vœtu®
 
	$mf_timesig
Ğ
MIDIClockTime
 
time
, 
m1
, 
m2
, 
m3
, 
m4
 ) {
	}
}

113 
vœtu®
 
	$mf_‹mpo
Ğ
MIDIClockTime
 
time
, 
b1
, 
b2
, 
b3
è{
	}
}

114 
vœtu®
 
	$mf_keysig
(
MIDIClockTime
 
time
, 
sf
, 
majmš
 ) {
	}
}

115 
vœtu®
 
	$mf_sq¥ecific
Ğ
MIDIClockTime
 
time
, 
Ën
, *
d©a
 ) {
	}
}

116 
vœtu®
 
	$mf_‹xt
Ğ
MIDIClockTime
 
time
, 
ty³
, 
Ën
, *
d©a
 ) {
	}
}

117 
vœtu®
 
	$mf_eÙ
Ğ
MIDIClockTime
 
time
 ) {
	}
}

123 
vœtu®
 
	$mf_”rÜ
(cÚ¡ * 
”r
è{
	}
}

124 
vœtu®
 
	$mf_¡¬‰¿ck
(
Œk
è{
	}
}

125 
vœtu®
 
	$mf_’dŒack
(
Œk
è{
	}
}

126 
vœtu®
 
	$mf_h—d”
(, , è{
	}
}

131 
vœtu®
 
	$Upd©eTime
(
MIDIClockTime
 
d–_time
è{
	}
}

132 
vœtu®
 
ChªMes§ge
(cÚ¡ 
MIDITimedMes§ge
 &
msg
);

133 
vœtu®
 
M‘aEv’t
(
MIDIClockTime
 
time
, 
ty³
, 
Ën
, *
buf
);

141 şas 
	cMIDIFeR—d”
 {

142 
	mpublic
:

145 
MIDIFeR—d”
 (
MIDIFeR—dSŒ—m
* 
šput_¡»am_
,

146 
MIDIFeEv’tHªdËr
 *
ev’t_hªdËr_
,

147 
max_msg_Ën
 = 8192);

149 
	mvœtu®
 ~
MIDIFeR—d”
();

150 
vœtu®
 
R—dH—d”
();

151 
vœtu®
 
boŞ
 
P¬£
();

153 
	$G‘FÜm©
(è{  
h—d”
.
fÜm©
; }

154 
	$G‘Numb”T¿cks
(è{  
h—d”
.
Árks
; 
	}
}

155 
	$G‘DivisiÚ
(è{  
h—d”
.
divisiÚ
; 
	}
}

157 
	g´Ùeùed
:

159 
vœtu®
 
mf_”rÜ
(const *);

161 
	gno_m”ge
;

162 
MIDIClockTime
 
	gcur_time
;

163 
	gsk_š™
;

164 
	gto_be_»ad
;

165 
	gcur_Œack
;

166 
	gabÜt_·r£
;

168 * 
	gthe_msg
;

169 
	gmax_msg_Ën
;

170 
	gmsg_šdex
;

172 
	g´iv©e
:

173 
R—dV¬ŸbËNum
();

174 
R—d32B™
();

175 
R—d16B™
();

176 
R—dT¿ck
();

177 
MsgAdd
();

178 
MsgIn™
();

179 
EG‘C
();

180 
R—dMT
(, );

181 
BadBy‹
();

182 
FÜmChªMes§ge
(
¡
, 
b1
, 
b2
);

184 
MIDIFeH—d”
 
	gh—d”
;

186 
MIDIFeR—dSŒ—m
* 
	gšput_¡»am
;

187 
MIDIFeEv’tHªdËr
* 
	gev’t_hªdËr
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\filereadmultitrack.h

40 #iâdeà
_JDKMIDI_FILEREADMULTITRACK_H


41 
	#_JDKMIDI_FILEREADMULTITRACK_H


	)

43 
	~"midi.h
"

44 
	~"msg.h
"

45 
	~"sy£x.h
"

47 
	~"f”—d.h
"

48 
	~"muÉ™¿ck.h
"

50 
	~<¡ršg
>

53 şas 
	cMIDIFeR—dMuÉiT¿ck
 : 
public
 
MIDIFeEv’tHªdËr
 {

54 
public
:

55 
MIDIFeR—dMuÉiT¿ck
 (
MIDIMuÉiT¿ck
 *
Œacks
);

56 
	mvœtu®
 ~
MIDIFeR—dMuÉiT¿ck
();

63 
vœtu®
 
mf_sy£x
Ğ
MIDIClockTime
 
time
, cÚ¡ 
MIDISy¡emExşusive
 &
ex
 );

64 
vœtu®
 
mf_¬b™¿ry
Ğ
MIDIClockTime
 
time
, 
Ën
, *
d©a
 );

65 
vœtu®
 
mf_m‘amisc
Ğ
MIDIClockTime
 
time
, , , * );

66 
vœtu®
 
mf_m‘a16
Ğ
MIDIClockTime
 
time
, 
ty³
, 
b1
, 
b2
 );

67 
vœtu®
 
mf_sm±e
Ğ
MIDIClockTime
 
time
, 
h
, 
m
, 
s
, 
f
, 
sf
 );

68 
vœtu®
 
mf_timesig
Ğ
MIDIClockTime
 
time
, 
a
, 
b
, 
c
, 
d
 );

69 
vœtu®
 
mf_‹mpo
Ğ
MIDIClockTime
 
time
, 
b1
, 
b2
, 
b3
 );

70 
vœtu®
 
mf_keysig
(
MIDIClockTime
 
time
, 
sf
, 
majmš
 );

71 
vœtu®
 
mf_sq¥ecific
Ğ
MIDIClockTime
 
time
, 
Ën
, *
d©a
 );

72 
vœtu®
 
mf_‹xt
Ğ
MIDIClockTime
 
time
, 
ty³
, 
Ën
, *
d©a
 );

73 
vœtu®
 
mf_eÙ
Ğ
MIDIClockTime
 
time
 );

79 
vœtu®
 
mf_”rÜ
Ğ* 
”r
 );

80 
vœtu®
 
mf_¡¬‰¿ck
Ğ
Œk
 );

81 
vœtu®
 
mf_’dŒack
Ğ
Œk
 );

82 
vœtu®
 
mf_h—d”
Ğ
fÜm©_
, 
Árks_
, 
divisiÚ_
 );

88 
vœtu®
 
ChªMes§ge
ĞcÚ¡ 
MIDITimedMes§ge
 &
msg
 );

90 
	m´Ùeùed
:

92 
MIDIMuÉiT¿ck
* 
muÉ™¿ck
;

93 
	mcur_Œack
;

94 
MIDIFeH—d”
 
	mh—d”
;

101 
MIDIFeH—d”
 
G‘MIDIFeH—d”
(cÚ¡ * 
f’ame
);

106 
boŞ
 
LßdMIDIFe
(cÚ¡ * 
f’ame
, 
MIDIMuÉiT¿ck
* 
Œacks
);

108 
boŞ
 
LßdMIDIFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
MIDIMuÉiT¿ck
* 
Œacks
);

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\filewrite.h

44 #iâdeà
_JDKMIDI_FILEWRITE_H


45 
	#_JDKMIDI_FILEWRITE_H


	)

47 
	~<f¡»am
>

49 
	~"midi.h
"

50 
	~"msg.h
"

51 
	~"sy£x.h
"

52 
	~"fe.h
"

59 şas 
	cMIDIFeWr™eSŒ—m
 {

60 
	mpublic
:

63 
MIDIFeWr™eSŒ—m
ĞcÚ¡ *
âame
 );

66 
MIDIFeWr™eSŒ—m
(
¡d
::
o¡»am
* 
ofs
);

68 
	mvœtu®
 ~
MIDIFeWr™eSŒ—m
();

71 
S“k
Ğ
pos
, 
wh’û
=
SEEK_SET
 );

73 
Wr™eCh¬
Ğ
c
 );

75 
boŞ
 
IsV®id
();

77 
	m´iv©e
:

78 
¡d
::
o¡»am
* 
outfs
;

79 
	m¡d
::
¡»ampos
 
begš
;

80 
boŞ
 
	md–
;

89 şas 
	cMIDIFeWr™”
 {

90 
	mpublic
:

91 
MIDIFeWr™”
(
MIDIFeWr™eSŒ—m
 *
out_¡»am_
);

92 
	mvœtu®
 ~
MIDIFeWr™”
();

95 
boŞ
 
	$E¼ÜOccu¼ed
(è{  
”rÜ
; }

96 
	$G‘FeL’gth
(è{  
fe_Ëngth
; 
	}
}

97 
	$G‘T¿ckL’gth
(è{  
Œack_Ëngth
; 
	}
}

98 
	$Re£tT¿ckL’gth
(è{ 
Œack_Ëngth
 = 0; 
	}
}

99 
	$Re£tT¿ckTime
(è{ 
Œack_time
 = 0; 
	}
}

101 
Wr™eFeH—d”
(
fÜm©
, 
Árks
, 
divisiÚ
);

102 
Wr™eT¿ckH—d”
(
Ëngth
);

103 
Wr™eEv’t
(cÚ¡ 
MIDITimedMes§ge
 &
msg
);

104 
Wr™eChªÃlEv’t
(cÚ¡ 
MIDITimedMes§ge
 &
msg
);

105 
Wr™eSysExEv’t
(cÚ¡ 
MIDITimedMes§ge
 &
msg
);

107 
Wr™eM‘aEv’t
Ğ
time
, 
ty³
, cÚ¡ *
d©a
, 
Ëngth
 );

118 
Wr™eEndOfT¿ck
(
time
);

120 
vœtu®
 
Rewr™eT¿ckL’gth
();

122 
	g´Ùeùed
:

123 
vœtu®
 
E¼Ü
(*
s
);

125 
	$Wr™eCh¬aù”
Ğ
uch¬
 
c
 ) { if(
out_¡»am
->
	`Wr™eCh¬
(cè< 0è
”rÜ
 = 
Œue
; 
	}
}

126 
	$S“k
(
pos
è{ if(
out_¡»am
->
	`S“k
Õosè< 0è
”rÜ
 = 
Œue
; 
	}
}

127 
	$Inüem’tCouÁ”s
(
c
è{ 
Œack_Ëngth
 +ğc; 
fe_Ëngth
 +ğc; 
	}
}

128 
Wr™eShÜt
(
c
);

129 
Wr™e3Ch¬
(
c
);

130 
Wr™eLÚg
(
c
);

131 
Wr™eV¬ŸbËNum
(
n
);

132 
Wr™eD–Time
(
time
);

134 
	g´iv©e
:

135 
boŞ
 
”rÜ
;

136 
boŞ
 
	gw™hš_Œack
;

137 
	gfe_Ëngth
;

138 
	gŒack_Ëngth
;

139 
	gŒack_time
;

140 
	gŒack_pos™iÚ
;

141 
uch¬
 
	gruÂšg_¡©us
;

143 
MIDIFeWr™eSŒ—m
 *
	gout_¡»am
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\filewritemultitrack.h

31 #iâdeà
_JDKMIDI_FILEWRITEMULTITRACK_H


32 
	#_JDKMIDI_FILEWRITEMULTITRACK_H


	)

34 
	~"fewr™e.h
"

35 
	~"muÉ™¿ck.h
"

38 şas 
	cMIDIFeWr™eMuÉiT¿ck
 {

39 
	mpublic
:

41 
MIDIFeWr™eMuÉiT¿ck
(cÚ¡ 
MIDIMuÉiT¿ck
 *
mÉ_
, 
MIDIFeWr™eSŒ—m
 *
¡rm_
);

42 
	mvœtu®
 ~
MIDIFeWr™eMuÉiT¿ck
();

44 
boŞ
 
Wr™e
(
num_Œacks
, 
divisiÚ
);

46 
	m´iv©e
:

48 
vœtu®
 
boŞ
 
P»Wr™e
();

49 
vœtu®
 
boŞ
 
Po¡Wr™e
();

51 cÚ¡ 
MIDIMuÉiT¿ck
 *
	mmuÉ™¿ck
;

52 
MIDIFeWr™”
 
	mwr™”
;

58 
boŞ
 
Wr™eMIDIFe
(cÚ¡ * 
f’ame
, 
fÜm©
, cÚ¡ 
MIDIMuÉiT¿ck
* 
Œacks
);

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\manager.h

27 #iâdeà
_JDKMIDI_MANAGER_H


28 
	#_JDKMIDI_MANAGER_H


	)

30 
	~"msg.h
"

31 
	~"driv”.h
"

32 
	~"£qu’ûr.h
"

33 
	~"tim”.h
"

36 
	~<veùÜ
>

50 şas 
	cMIDIMªag”
 {

51 
	mpublic
:

52 
MIDIMªag”
Ğ
MIDISequ’ûrGUINÙif›r
 *
n
=0,

53 
MIDISequ’ûr
 *
£q_
=0 );

55 
	mvœtu®
 ~
MIDIMªag”
();

57 
Re£t
();

60 
S‘Seq
Ğ
MIDISequ’ûr
 *
£q
 );

61 
MIDISequ’ûr
* 
	$G‘Seq
(è{  
£qu’ûr
; }

62 cÚ¡ 
MIDISequ’ûr
* 
	$G‘Seq
(ècÚ¡ {  
£qu’ûr
; 
	}
}

65 
	$S‘O³nPŞicy
(
p
è{ 
İ’_pŞicy
 =…; 
	}
}

66 
	$G‘O³ÅŞicy
(ècÚ¡ {  
İ’_pŞicy
; 
	}
}

69 
	$G‘NumMIDIOuts
(è{  
MIDI_out_Çmes
.
	`size
(); 
	}
}

70 cÚ¡ 
	g¡d
::
¡ršg
& 
	$G‘MIDIOutName
(
n
è{  
MIDI_out_Çmes
[n]; 
	}
}

71 
	$G‘NumMIDIIns
(è{  
MIDI_š_Çmes
.
	`size
(); 
	}
}

72 cÚ¡ 
	g¡d
::
¡ršg
& 
	$G‘MIDIInName
(
n
è{  
MIDI_š_Çmes
[n]; 
	}
}

73 
MIDIOutDriv”
* 
	$G‘OutDriv”
(
n
è{  
MIDI_outs
[n]; 
	}
}

74 
MIDIInDriv”
* 
	$G‘InDriv”
(
n
è{  
MIDI_šs
[n]; 
	}
}

75 
O³nOutPÜts
();

76 
Clo£OutPÜts
();

79 
tM£cs
 
	$G‘Cu¼’tTimeInMs
() const

80 {  
¶ay_mode
 ?

81 
tim”
->
	`G‘SysTimeMs
(è+ 
£q_time_off£t
 - 
sys_time_off£t
 : 0; 
	}
}

85 
SeqPÏy
();

86 
SeqStİ
();

87 
S‘R•—tPÏy
Ğ
boŞ
 
æag
, 
¡¬t_m—su»
, 
’d_m—su»
 );

90 
	$S‘ThruEÇbË
Ğ
boŞ
 
f
 ) { 
thru_’abË
 = f; 
	}
}

91 
boŞ
 
	$G‘ThruEÇbË
(ècÚ¡ {  
thru_’abË
; 
	}
}

93 
AÎNÙesOff
();

96 
boŞ
 
	$IsSeqPÏy
(ècÚ¡ {  
¶ay_mode
; 
	}
}

97 
boŞ
 
	$IsSeqStİ
(ècÚ¡ {  
¡İ_mode
; 
	}
}

98 
boŞ
 
	$IsSeqR•—t
(ècÚ¡ {  
»³©_¶ay_mode
 && 
¶ay_mode
; 
	}
}

100 
TickProc
(
sys_time
, * 
p
);

102 ’um { 
	gAUTO_OPEN
, 
	gEXT_OPEN
 };

104 
	g´Ùeùed
:

106 
TimeTickPÏyMode
Ğ
sys_time_
 );

107 
TimeTickStİMode
Ğ
sys_time_
 );

109 
	g¡d
::
veùÜ
<
MIDIOutDriv”
*> 
MIDI_outs
;

110 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
MIDI_out_Çmes
;

111 
	g¡d
::
veùÜ
<
MIDIInDriv”
*> 
MIDI_šs
;

112 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
MIDI_š_Çmes
;

114 
MIDISequ’ûr
* 
	g£qu’ûr
;

115 
MIDISequ’ûrGUINÙif›r
* 
	gnÙif›r
;

117 
MIDITim”
* 
	gtim”
;

119 
tM£cs
 
	gsys_time_off£t
;

120 
tM£cs
 
	g£q_time_off£t
;

122 vŞ©
boŞ
 
	g¶ay_mode
;

123 vŞ©
boŞ
 
	g¡İ_mode
;

124 
boŞ
 
	gthru_’abË
;

126 vŞ©
boŞ
 
	g»³©_¶ay_mode
;

127 
	g»³©_¡¬t_m—su»
;

128 
	g»³©_’d_m—su»
;

130 
	gİ’_pŞicy
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\matrix.h

42 #iâdeà
_JDKMIDI_MATRIX_H


43 
	#_JDKMIDI_MATRIX_H


	)

46 
	~"midi.h
"

47 
	~"msg.h
"

55 şas 
	cMIDIM©rix


57 
	mpublic
:

59 
MIDIM©rix
();

61 
	mvœtu®
 ~
MIDIM©rix
();

64 
vœtu®
 
boŞ
 
Proûss
(cÚ¡ 
MIDIMes§ge
 &
m
);

66 
vœtu®
 
CË¬
();

69 
	$G‘TÙ®CouÁ
(ècÚ¡ {  
tÙ®_couÁ
; }

71 
	$G‘ChªÃlCouÁ
(
chªÃl
ècÚ¡ {  
chªÃl_couÁ
[chªÃl]; 
	}
}

73 
	$G‘NÙeCouÁ
(
chªÃl
, 
nÙe
ècÚ¡ {  
nÙe_Ú_couÁ
[chªÃl][nÙe]; 
	}
}

75 
boŞ
 
	$G‘HŞdPed®
(
chªÃl
ècÚ¡ {  
hŞd_³d®
[chªÃl]; 
	}
}

77 
	g´Ùeùed
:

80 
vœtu®
 
DecNÙeCouÁ
(cÚ¡ 
MIDIMes§ge
 &
m
, 
chªÃl
, 
nÙe
);

82 
vœtu®
 
IncNÙeCouÁ
 (cÚ¡ 
MIDIMes§ge
 &
m
, 
chªÃl
, 
nÙe
);

84 
vœtu®
 
CË¬ChªÃl
(
chªÃl
);

86 
vœtu®
 
Oth”Mes§ge
(cÚ¡ 
MIDIMes§ge
 &
m
);

88 
	$S‘NÙeCouÁ
(
chª
, 
nÙe
, 
v®
)

89 { 
nÙe_Ú_couÁ
[
chª
][
nÙe
] = 
v®
; 
	}
}

91 
	$S‘ChªÃlCouÁ
(
chª
, 
v®
è{ 
chªÃl_couÁ
[chª] = v®; 
	}
}

93 
	g´iv©e
:

94 
nÙe_Ú_couÁ
[16][128];

95 
	gchªÃl_couÁ
[16];

96 
boŞ
 
	ghŞd_³d®
[16];

97 
	gtÙ®_couÁ
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\midi.h

35 #iâdeà
_JDKMIDI_MIDI_H


36 
	#_JDKMIDI_MIDI_H


	)

38 
	~"wÜld.h
"

47 
	mNOTE_OFF
 =0x80,

48 
	mNOTE_ON
 =0x90,

49 
	mPOLY_PRESSURE
 =0xa0,

50 
	mCONTROL_CHANGE
 =0xb0,

51 
	mPROGRAM_CHANGE
 =0xc0,

52 
	mCHANNEL_PRESSURE
 =0xd0,

53 
	mPITCH_BEND
 =0xe0,

54 
	mSYSEX_START
 =0xf0,

55 
	mMTC
 =0xf1,

56 
	mSONG_POSITION
 =0xf2,

57 
	mSONG_SELECT
 =0xf3,

58 
	mTUNE_REQUEST
 =0xf6,

59 
	mSYSEX_END
 =0xf7,

60 
	mRESET
 =0xff,

61 
	mMETA_EVENT
 =0xff

72 
	mRT_TIMING_CLOCK
 =0xf8,

73 
	mRT_MEASURE_END
 =0xf9,

74 
	mRT_START
 =0xfa,

75 
	mRT_CONTINUE
 =0xfb,

76 
	mRT_STOP
 =0xfc,

77 
	mRT_ACTIVE_SENSE
 =0xfe

87 
	mC_LSB
 =0x20,

90 
	mC_GM_BANK
 =0x00,

91 
	mC_MODULATION
 =0x01,

92 
	mC_BREATH
 =0x02,

93 
	mC_FOOT
 =0x04,

94 
	mC_PORTA_TIME
 =0x05,

95 
	mC_DATA_ENTRY
 =0x06,

96 
	mC_MAIN_VOLUME
 =0x07,

97 
	mC_BALANCE
 =0x08,

98 
	mC_PAN
 =0x0a,

99 
	mC_EXPRESSION
 =0x0b,

100 
	mC_GENERAL_1
 =0x10,

101 
	mC_GENERAL_2
 =0x11,

102 
	mC_GENERAL_3
 =0x12,

103 
	mC_GENERAL_4
 =0x13,

105 
	mC_DAMPER
 =0x40,

106 
	mC_PORTA
 =0x41,

107 
	mC_SOSTENUTO
 =0x42,

108 
	mC_SOFT_PEDAL
 =0x43,

109 
	mC_HOLD_2
 =0x45,

111 
	mC_GENERAL_5
 =0x50,

112 
	mC_GENERAL_6
 =0x51,

113 
	mC_GENERAL_7
 =0x52,

114 
	mC_GENERAL_8
 =0x53,

116 
	mC_EFFECT_DEPTH
 =0x5b,

117 
	mC_TREMELO_DEPTH
 =0x5c,

118 
	mC_CHORUS_DEPTH
 =0x5d,

119 
	mC_CELESTE_DEPTH
 =0x5e,

120 
	mC_PHASER_DEPTH
 =0x5f,

122 
	mC_DATA_INC
 =0x60,

123 
	mC_DATA_DEC
 =0x61,

125 
	mC_NONRPN_LSB
 =0x62,

126 
	mC_NONRPN_MSB
 =0x63,

128 
	mC_RPN_LSB
 =0x64,

129 
	mC_RPN_MSB
 =0x65,

132 
	mC_ALL_SOUND_OFF
 =0x78,

133 
	mC_RESET
 =0x79,

134 
	mC_LOCAL
 =0x7a,

135 
	mC_ALL_NOTES_OFF
 =0x7b,

136 
	mC_OMNI_OFF
 =0x7c,

137 
	mC_OMNI_ON
 =0x7d,

138 
	mC_MONO
 =0x7e,

139 
	mC_POLY
 =0x7f

149 
	mRPN_BEND_WIDTH
 =0x00,

150 
	mRPN_FINE_TUNE
 =0x01,

151 
	mRPN_COARSE_TUNE
 =0x02

172 
	mMETA_SEQUENCE_NUMBER
 = 0x00,

175 
	mMETA_GENERIC_TEXT
 = 0x01,

176 
	mMETA_COPYRIGHT
 = 0x02,

177 
	mMETA_TRACK_NAME
 = 0x03,

178 
	mMETA_INSTRUMENT_NAME
 = 0x04,

179 
	mMETA_LYRIC_TEXT
 = 0x05,

180 
	mMETA_MARKER_TEXT
 = 0x06,

181 
	mMETA_CUE_TEXT
 = 0x07,

182 
	mMETA_PROGRAM_NAME
 = 0x08,

183 
	mMETA_DEVICE_NAME
 = 0x09,

184 
	mMETA_GENERIC_TEXT_A
 = 0x0A,

185 
	mMETA_GENERIC_TEXT_B
 = 0x0B,

186 
	mMETA_GENERIC_TEXT_C
 = 0x0C,

187 
	mMETA_GENERIC_TEXT_D
 = 0x0D,

188 
	mMETA_GENERIC_TEXT_E
 = 0x0E,

189 
	mMETA_GENERIC_TEXT_F
 = 0x0F,

194 
	mMETA_CHANNEL_PREFIX
 = 0x20,

197 
	mMETA_OUTPUT_CABLE
 = 0x21,

200 
	mMETA_END_OF_TRACK
 = 0x2F,

205 
	mMETA_TEMPO
 = 0x51,

211 
	mMETA_SMPTE
 = 0x54,

221 
	mMETA_TIMESIG
 = 0x58,

225 
	mMETA_KEYSIG
 = 0x59,

229 
	mMETA_BEAT_MARKER
 = 0x7e,

234 
	mMETA_SEQUENCER_SPECIFIC
 = 0x7F

241 cÚ¡ sigÃd 
lut_msgËn
[16];

242 cÚ¡ sigÃd 
lut_sysmsgËn
[16];

243 cÚ¡ 
boŞ
 
lut_is_wh™e
[12];

246 cÚ¡ * 
chª_msg_Çmes
[16];

247 cÚ¡ * 
sys_msg_Çmes
[16];

248 cÚ¡ * 
chª_mode_Çmes
[8];

250 cÚ¡ * 
g‘_chª_msg_Çme
(
¡©us
);

251 cÚ¡ * 
g‘_m‘a_Çme
(
¡©us
);

252 cÚ¡ * 
g‘_chª_mode_Çme
(
¡©us
);

258 
šlše
 sigÃd 
	$G‘Mes§geL’gth
Ğ
¡©
 )

260  
lut_msgËn
[
¡©
>>4];

261 
	}
}

263 
šlše
 sigÃd 
	$G‘Sy¡emMes§geL’gth
Ğ
¡©
 )

265  
lut_sysmsgËn
[
¡©
-0xf0];

266 
	}
}

273 
šlše
 
boŞ
 
	$IsNÙeWh™e
Ğ
nÙe
 )

275  
lut_is_wh™e
[ 
nÙe
%12 ];

276 
	}
}

278 
šlše
 
boŞ
 
	$IsNÙeBÏck
Ğ
nÙe
 )

280  !
lut_is_wh™e
[ 
nÙe
%12 ];

281 
	}
}

288 
šlše
 
	$G‘NÙeOùave
Ğ
nÙe
 )

289 {  (
nÙe
/12)-1; 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\msg.h

38 #iâdeà
_JDKMIDI_MSG_H


39 
	#_JDKMIDI_MSG_H


	)

41 
	~"midi.h
"

43 
	~"sy£x.h
"

45 
	~<¡ršg
>

54 şas 
	cMIDIMes§ge
 {

55 
	mpublic
:

60 
MIDIMes§ge
();

63 
MIDIMes§ge
(cÚ¡ MIDIMes§g&
msg
);

65 
	mvœtu®
 ~
MIDIMes§ge
();

68 
CË¬
();

70 
CË¬SysEx
();

73 cÚ¡ 
	mMIDIMes§ge
& 
	mİ”©Ü
ğ(cÚ¡ 
MIDIMes§ge
 &
msg
);

79 
	m¡d
::
¡ršg
 
	$MsgToText
() const;

85 
	$G‘L’gth
() const;

87 
	$G‘Stus
(ècÚ¡ {  ()
¡©us
; }

89 
	$G‘ChªÃl
(ècÚ¡ {  ()(
¡©us
 &0x0f); 
	}
}

92 
	$G‘Ty³
(ècÚ¡ {  ()(
¡©us
 & 0xf0); 
	}
}

94 
	$G‘M‘aTy³
(ècÚ¡ {  
by‹1
; 
	}
}

96 
	$G‘By‹1
(ècÚ¡ {  
by‹1
; 
	}
}

98 
	$G‘By‹2
(ècÚ¡ {  
by‹2
; 
	}
}

100 
	$G‘By‹3
(ècÚ¡ {  
by‹3
; 
	}
}

102 
MIDISy¡emExşusive
* 
	$G‘SysEx
(è{  
sy£x
; 
	}
}

103 cÚ¡ 
MIDISy¡emExşusive
*
	$G‘SysEx
(ècÚ¡ {  
sy£x
; 
	}
}

105 
	$G‘NÙe
(ècÚ¡ {  
by‹1
; 
	}
}

108 
	$G‘V–oc™y
(ècÚ¡ {  
by‹2
; 
	}
}

110 
	$G‘ChªÃlP»ssu»
(ècÚ¡ {  
by‹1
; 
	}
}

112 
	$G‘Prog¿mV®ue
(ècÚ¡ {  
by‹1
; 
	}
}

114 
	$G‘CÚŒŞËr
(ècÚ¡ {  
by‹1
; 
	}
}

116 
	$G‘CÚŒŞËrV®ue
(ècÚ¡ {  
by‹2
; 
	}
}

118 
	$G‘B’d”V®ue
(ècÚ¡ {  ()(((
by‹2
 << 7è| 
by‹1
è- 8192); 
	}
}

120 
	$G‘M‘aV®ue
(ècÚ¡ {  ()((
by‹3
 << 8è| 
by‹2
); 
	}
}

122 
	$G‘TimeSigNum”©Ü
(ècÚ¡ {  
by‹2
; 
	}
}

124 
	$G‘TimeSigD’omš©Ü
(ècÚ¡ {  
by‹3
; 
	}
}

127 sigÃd 
	$G‘KeySigSh¬pFÏts
(ècÚ¡ {  (sigÃd )
by‹2
; 
	}
}

130 
	$G‘KeySigMajÜMšÜ
(ècÚ¡ {  
by‹3
; 
	}
}

132 
	$G‘Tempo
() const;

135 
	$G‘IÁ”ÇlTempo
() const;

137 
¡d
::
¡ršg
 
	$G‘Text
() const;

141 
boŞ
 
	$IsChªÃlMsg
(ècÚ¡ {  (
¡©us
 >ğ0x80è&& (¡©u < 0xf0); 
	}
}

144 
boŞ
 
	$IsNÙeOn
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
NOTE_ON
è&& 
by‹2
; 
	}
}

148 
boŞ
 
	$IsNÙeOff
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
NOTE_OFF
) ||

149 (((
¡©us
 & 0xf0è=ğ
NOTE_ON
è&& 
by‹2
 =ğ0); 
	}
}

151 
boŞ
 
	$IsNÙe
(ècÚ¡ {  
	`IsNÙeOn
(è|| 
	`IsNÙeOff
(); 
	}
}

154 
boŞ
 
	$IsPŞyP»ssu»
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
POLY_PRESSURE
); 
	}
}

158 
boŞ
 
	$IsCÚŒŞChªge
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
CONTROL_CHANGE
) &&

159 (
by‹1
 < 
C_ALL_SOUND_OFF
); 
	}
}

162 
boŞ
 
	$IsVŞumeChªge
(ècÚ¡ {  
	`IsCÚŒŞChªge
(è&& 
	`G‘CÚŒŞËr
(è=ğ
C_MAIN_VOLUME
; 
	}
}

165 
boŞ
 
	$IsPªChªge
(ècÚ¡ {  
	`IsCÚŒŞChªge
(è&& 
	`G‘CÚŒŞËr
(è=ğ
C_PAN
; 
	}
}

168 
boŞ
 
	$IsPed®On
(ècÚ¡ {  
	`IsCÚŒŞChªge
(è&& 
	`G‘CÚŒŞËr
(è=ğ
C_DAMPER
 &&

169 
	`G‘CÚŒŞËrV®ue
(è& 0x40; 
	}
}

172 
boŞ
 
	$IsPed®Off
(ècÚ¡ {  
	`IsCÚŒŞChªge
(è&& 
	`G‘CÚŒŞËr
(è=ğ
C_DAMPER
 &&

173 !(
	`G‘CÚŒŞËrV®ue
(è& 0x40); 
	}
}

176 
boŞ
 
	$IsProg¿mChªge
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
PROGRAM_CHANGE
); 
	}
}

179 
boŞ
 
	$IsChªÃlP»ssu»
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
CHANNEL_PRESSURE
); 
	}
}

182 
boŞ
 
	$IsP™chB’d
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
PITCH_BEND
); 
	}
}

184 
boŞ
 
	$IsChªÃlMode
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
CONTROL_CHANGE
) &&

185 (
by‹1
 >ğ
C_ALL_SOUND_OFF
); 
	}
}

187 
boŞ
 
	$IsAÎNÙesOff
(ècÚ¡ {  ((
¡©us
 & 0xf0è=ğ
CONTROL_CHANGE
) &&

188 (
by‹1
 =ğ
C_ALL_NOTES_OFF
); 
	}
}

190 
boŞ
 
	$IsSy¡emMes§ge
(ècÚ¡ {  (
¡©us
 & 0xf0è=ğ0xf0; 
	}
}

192 
boŞ
 
	$IsSysEx
(ècÚ¡ {  (
¡©us
 =ğ
SYSEX_START
); 
	}
}

195 
boŞ
 
	$IsM‘aEv’t
(ècÚ¡ {  (
¡©us
 =ğ
META_EVENT
); 
	}
}

198 
boŞ
 
	$IsTextEv’t
(ècÚ¡ {  (
¡©us
 =ğ
META_EVENT
 && 
by‹1
 >ğ0x1 && by‹1 <ğ0xf); 
	}
}

201 
boŞ
 
	$IsT¿ckName
(ècÚ¡ {  (
	`IsTextEv’t
(è&& 
	`G‘M‘aTy³
(è=ğ
META_TRACK_NAME
); 
	}
}

204 
boŞ
 
	$IsM¬k”Text
(ècÚ¡ {  (
	`IsTextEv’t
(è&& 
	`G‘M‘aTy³
(è=ğ
META_MARKER_TEXT
); 
	}
}

207 
boŞ
 
	$IsTempo
(ècÚ¡ {  (
¡©us
 =ğ
META_EVENT
è&& (
by‹1
 =ğ
META_TEMPO
); 
	}
}

209 
boŞ
 
	$IsD©aEnd
(ècÚ¡ {  (
¡©us
 =ğ
META_EVENT
è&& (
by‹1
 =ğ
META_END_OF_TRACK
); 
	}
}

212 
boŞ
 
	$IsTimeSig
(ècÚ¡ {  (
¡©us
 =ğ
META_EVENT
è&& (
by‹1
 =ğ
META_TIMESIG
); 
	}
}

215 
boŞ
 
	$IsKeySig
(ècÚ¡ {  (
¡©us
 =ğ
META_EVENT
è&& (
by‹1
 =ğ
META_KEYSIG
); 
	}
}

218 
boŞ
 
	$IsB—tM¬k”
(ècÚ¡ {  (
¡©us
 =ğ
META_EVENT
è&& (
by‹1
 =ğ
META_BEAT_MARKER
); 
	}
}

221 
boŞ
 
	$IsNoOp
(ècÚ¡ {  (
¡©us
 & 0xF0è=ğ0; 
	}
}

230 
	$S‘Stus
(
s
è{ 
¡©us
 = s; 
	}
}

232 
	$S‘ChªÃl
(
s
è{ 
¡©us
 = ()((¡©u & 0xf0è| s); 
	}
}

234 
	$S‘Ty³
(
s
è{ 
¡©us
 = ()((¡©u & 0x0fè| s); 
	}
}

236 
	$S‘By‹1
(
b
è{ 
by‹1
 = b; 
	}
}

238 
	$S‘By‹2
(
b
è{ 
by‹2
 = b; 
	}
}

240 
	$S‘By‹3
(
b
è{ 
by‹3
 = b; 
	}
}

242 
	$S‘NÙe
(
n
è{ 
by‹1
 =‚; 
	}
}

244 
	$S‘V–oc™y
(
v
è{ 
by‹2
 = v; 
	}
}

246 
	$S‘CÚŒŞËr
(
c
è{ 
by‹1
 = c; 
	}
}

248 
	$S‘CÚŒŞËrV®ue
(
v
è{ 
by‹2
 = v; 
	}
}

250 
	$S‘Prog¿mV®ue
(
v
è{ 
by‹1
 = v; 
	}
}

252 
S‘B’d”V®ue
(
v
);

254 
	$S‘M‘aTy³
(
t
è{ 
by‹1
 =; 
	}
}

256 
S‘M‘aV®ue
(
v
);

258 
S‘NÙeOn
(
chª
, 
nÙe
, 
v–
);

260 
S‘NÙeOff
(
chª
, 
nÙe
, 
v–
);

263 
S‘PŞyP»ssu»
(
chª
, 
nÙe
, 
´es
);

266 
S‘CÚŒŞChªge
(
chª
, 
ù¾
, 
v®
);

269 
	$S‘VŞumeChªge
 (
chª
, 
v®
)

270 { 
	`S‘CÚŒŞChªge
Ğ
chª
, 
C_MAIN_VOLUME
, 
v®
); 
	}
}

273 
	$S‘PªChªge
 (
chª
, 
v®
)

274 { 
	`S‘CÚŒŞChªge
Ğ
chª
, 
C_PAN
, 
v®
); 
	}
}

276 
S‘Prog¿mChªge
(
chª
, 
´og
);

278 
S‘ChªÃlP»ssu»
(
chª
, 
´es
);

281 
S‘P™chB’d
Ğ
chª
, 
v®
 );

292 
	$S‘ChªÃlMode
(
chª
, 
ty³
, 
v®
 = 0)

293 { 
	`S‘CÚŒŞChªge
(
chª
, 
ty³
, 
v®
); 
	}
}

295 
	$S‘AÎNÙesOff
(
chª
)

296 { 
	`S‘CÚŒŞChªge
(
chª
, 
C_ALL_NOTES_OFF
, 0); 
	}
}

299 
S‘SysEx
(cÚ¡ 
MIDISy¡emExşusive
* 
£
);

302 
S‘MTC
(
f›ld
, 
v®
);

304 
S‘SÚgPos™iÚ
(
pos
);

306 
S‘SÚgS–eù
(
¢g
);

310 
S‘Sy¡emMes§ge
(
ty³
);

313 
S‘M‘aEv’t
(
ty³
, 
v1
, 
v2
);

316 
S‘M‘aEv’t
(
ty³
, 
v®
);

321 
S‘Text
(cÚ¡ * 
‹xt
, 
ty³
 = 
META_GENERIC_TEXT
);

323 
	$S‘D©aEnd
(è{ 
	`S‘M‘aEv’t
(
META_END_OF_TRACK
, 0); 
	}
}

326 
S‘Tempo
(
‹mpo_bpm
);

329 
S‘SMPTEOff£t
(
hour
, 
mš
, 
£c
,

330 
äame
,
subäame
);

332 
S‘TimeSig
(
num
, 
d’
,

333 
şocks_³r_m‘rÚome
 = 0, 
num_32_³r_qu¬‹r
 = 8);

336 
	$S‘KeySig
ĞsigÃd 
sh¬p_æ©s
, 
majÜ_mšÜ
 )

337 { 
	`S‘M‘aEv’t
(
META_KEYSIG
, 
sh¬p_æ©s
, 
majÜ_mšÜ
); 
	}
}

340 
	$S‘B—tM¬k”
(è{ 
	`S‘M‘aEv’t
(
META_BEAT_MARKER
, 0); 
	}
}

343 
	$S‘NoOp
(è{ 
	`CË¬
(); 
	}
}

346 
AÎoÿ‹SysEx
(
Ën
);

349 
CİySysEx
(cÚ¡ 
MIDISy¡emExşusive
* 
£
);

351 
ä›nd
 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
MIDIMes§ge
 &
m1
, cÚ¡ 
	gMIDIMes§ge
 &
	gm2
);

353 
	g´Ùeùed
:

355 
¡©us
;

356 
	gby‹1
;

357 
	gby‹2
;

358 
	gby‹3
;

359 
MIDISy¡emExşusive
* 
	gsy£x
;

373 şas 
	cMIDITimedMes§ge
 : 
public
 
MIDIMes§ge
 {

374 
public
:

380 
MIDITimedMes§ge
();

382 
MIDITimedMes§ge
(cÚ¡ MIDITimedMes§g&
msg
);

383 
MIDITimedMes§ge
(cÚ¡ 
MIDIMes§ge
 &
msg
);

385 ~
MIDITimedMes§ge
();

388 
CË¬
();

391 cÚ¡ 
	mMIDITimedMes§ge
 &
	mİ”©Ü
ğ(cÚ¡ 
MIDITimedMes§ge
 &
msg
);

392 cÚ¡ 
	mMIDITimedMes§ge
 &
	mİ”©Ü
ğ(cÚ¡ 
MIDIMes§ge
 &
msg
);

395 
MIDIClockTime
 
	$G‘Time
(ècÚ¡ {  
time
; }

398 
	$S‘Time
(
MIDIClockTime
 
t
è{ 
time
 =; 
	}
}

400 
	$AddTime
(
MIDIClockTime
 
t
è{ 
time
 +ğt; 
	}
}

402 
	$SubTime
(
MIDIClockTime
 
t
è{ 
time
 = (ˆ>im? 0 :im-); 
	}
}

405 
	g¡d
::
¡ršg
 
	$MsgToText
() const;

418 
	`Com·»Ev’tsFÜIn£¹
 (cÚ¡ 
MIDITimedMes§ge
 &
m1
, cÚ¡ MIDITimedMes§g&
m2
);

432 
boŞ
 
	`IsSameKšd
 (cÚ¡ 
MIDITimedMes§ge
 &
m1
, cÚ¡ MIDITimedMes§g&
m2
);

434 
´Ùeùed
:

436 
MIDIClockTime
 
time
;

437 
	}
};

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\multitrack.h

23 #iâdeà
MIDI_MULTITRACK_H


24 
	#MIDI_MULTITRACK_H


	)

27 
	~"Œack.h
"

29 
	~<veùÜ
>

32 
şass
 
	gMIDIEd™MuÉiT¿ck
;

45 şas 
	cMIDIMuÉiT¿ck
 {

46 
	mpublic
:

49 
MIDIMuÉiT¿ck
(
numb”_of_Œacks
 = 0,

50 
ş_p_b
 = 
DEFAULT_CLKS_PER_BEAT
);

53 
	mvœtu®
 ~
MIDIMuÉiT¿ck
();

59 
S‘ClksP”B—t
(
ş_p_b
);

61 
	$G‘ClksP”B—t
(ècÚ¡ {  
şks_³r_b—t
; }

63 
MIDIT¿ck
* 
	$G‘T¿ck
Ğ
Œk
 ) {  
Œacks
[Œk]; 
	}
}

64 cÚ¡ 
MIDIT¿ck
* 
	$G‘T¿ck
Ğ
Œk
 ) cÚ¡ {  
Œacks
[Œk]; 
	}
}

66 
	$G‘NumT¿cks
(ècÚ¡ {  
Œacks
.
	`size
(); 
	}
}

69 
	$G‘NumT¿cksW™hEv’ts
() const;

71 
	$G‘NumEv’ts
() const;

73 
boŞ
 
	$IsV®idT¿ckNumb”
(
n
ècÚ¡{  (0 <ğÀ&& (ê < 
Œacks
.
	`size
()); 
	}
}

75 
CË¬
();

77 
CË¬AndResize
(
n
);

80 
CË¬T¿cks
(
boŞ
 
mªš_’d
 = 
çl£
);

86 
AssignEv’tsToT¿cks
 ( cÚ¡ 
MIDIT¿ck
 *
¤c
 );

89 
	$AssignEv’tsToT¿cks
 (
Œack_num
 = 0)

90 {  
	`AssignEv’tsToT¿cks
(
	`G‘T¿ck
(
Œack_num
)); 
	}
}

95 
boŞ
 
In£¹T¿ck
(
Œk
 = -1);

99 
boŞ
 
D–‘eT¿ck
(
Œk
);

104 
boŞ
 
MoveT¿ck
(
äom
, 
to
);

109 
boŞ
 
In£¹Ev’t
(
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
, 
_šs_mode
 = 
INSMODE_DEFAULT
);

112 
boŞ
 
In£¹NÙe
(
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
,

113 
MIDIClockTime
 
Ën
, 
_šs_mode
 = 
INSMODE_DEFAULT
);

116 
boŞ
 
D–‘eEv’t
(
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
);

119 
boŞ
 
D–‘eNÙe
Ğ
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
 );

122 
Ed™Cİy
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
Œ_¡¬t
,

123 
Œ_’d
, 
MIDIEd™MuÉiT¿ck
* 
ed™
);

125 
Ed™Cut
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
MIDIEd™MuÉiT¿ck
* 
ed™
);

127 
Ed™CË¬
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
Œ_¡¬t
, 
Œ_’d
);

129 
Ed™In£¹
(
MIDIClockTime
 
¡¬t
, 
Œ_¡¬t
, 
times
,

130 
boŞ
 
sy£x
, 
MIDIEd™MuÉiT¿ck
* 
ed™
);

133 
Ed™R•Ïû
(
MIDIClockTime
 
¡¬t
, 
Œ_¡¬t
, 
times
,

134 
boŞ
 
sy£x
, 
MIDIEd™MuÉiT¿ck
* 
ed™
);

136 
	g´iv©e
:

138 
şks_³r_b—t
;

139 
	g¡d
::
veùÜ
<
MIDIT¿ck
*> 
Œacks
;

148 şas 
	cMIDIMuÉiT¿ckI‹¿tÜS‹
 {

149 
ä›nd
 
şass
 
	mMIDIMuÉiT¿ckI‹¿tÜ
;

151 
	mpublic
:

153 
MIDIMuÉiT¿ckI‹¿tÜS‹
(
n_Œacks
);

155 
MIDIMuÉiT¿ckI‹¿tÜS‹
(cÚ¡ MIDIMuÉiT¿ckI‹¿tÜS‹ &
m
);

157 
	mvœtu®
 ~
MIDIMuÉiT¿ckI‹¿tÜS‹
();

159 cÚ¡ 
	mMIDIMuÉiT¿ckI‹¿tÜS‹
& 
	mİ”©Ü
=(cÚ¡ 
MIDIMuÉiT¿ckI‹¿tÜS‹
 &
m
);

161 
	$G‘NumT¿cks
(ècÚ¡ {  
num_Œacks
; }

163 
	$G‘CurEv’tT¿ck
(ècÚ¡ {  
cur_ev’t_Œack
; 
	}
}

165 
MIDIClockTime
 
	$G‘CurTime
(ècÚ¡ {  
cur_time
; 
	}
}

167 
S‘NumT¿cks
(
n
);

170 
Re£t
();

173 
FšdT¿ckOfFœ¡Ev’t
();

175 
	g´iv©e
:

176 
num_Œacks
;

177 
MIDIClockTime
 
	gcur_time
;

178 
	gcur_ev’t_Œack
;

179 * 
	gÃxt_ev’t_numb”
;

180 
MIDIClockTime
* 
	gÃxt_ev’t_time
;

191 şas 
	cMIDIMuÉiT¿ckI‹¿tÜ
 {

192 
	mpublic
:

195 
MIDIMuÉiT¿ckI‹¿tÜ
Ğ
MIDIMuÉiT¿ck
 *
mÉ
 );

197 
	mvœtu®
 ~
MIDIMuÉiT¿ckI‹¿tÜ
();

199 
Re£t
();

205 
GoToTime
(
MIDIClockTime
 
time
);

207 
MIDIClockTime
 
	$G‘CurTime
(ècÚ¡ {  
¡©e
.
	`G‘CurTime
(); }

213 
boŞ
 
	$G‘CurEv’tTime
(
MIDIClockTime
 *
t
) const;

220 
boŞ
 
	`G‘CurEv’t
(*
Œack
, 
MIDITimedMes§ge
 **
msg
);

224 
boŞ
 
	`GoToNextEv’t
();

228 
boŞ
 
	`GoToNextEv’tOnT¿ck
(
Œack
);

232 
MIDIMuÉiT¿ckI‹¿tÜS‹
& 
	$G‘S‹
(è{  
¡©e
; 
	}
}

233 cÚ¡ 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
 &
	$G‘S‹
(ècÚ¡ {  
¡©e
; 
	}
}

234 
	$S‘S‹
(cÚ¡ 
MIDIMuÉiT¿ckI‹¿tÜS‹
& 
s
è{ 
¡©e
 = s; 
	}
}

236 
MIDIMuÉiT¿ck
* 
	$G‘MuÉiT¿ck
(è{  
muÉ™¿ck
; 
	}
}

237 cÚ¡ 
MIDIMuÉiT¿ck
* 
	$G‘MuÉiT¿ck
(ècÚ¡ {  
muÉ™¿ck
; 
	}
}

239 
	g´Ùeùed
:

240 
MIDIMuÉiT¿ck
* 
muÉ™¿ck
;

241 
MIDIMuÉiT¿ckI‹¿tÜS‹
 
	g¡©e
;

245 şas 
	cMIDIEd™MuÉiT¿ck
 : 
public
 
MIDIMuÉiT¿ck
 {

246 
public
:

247 
	$MIDIEd™MuÉiT¿ck
(
ş_p_b
 = 
DEFAULT_CLKS_PER_BEAT
,

248 
max_Œacks
 = 
DEFAULT_MAX_NUM_TRACKS
) :

249 
	`MIDIMuÉiT¿ck
(
ş_p_b
, 
max_Œacks
), 
	`¡¬t_Œack
(0), 
	$’d_Œack
(0) {}

250 
vœtu®
 ~
	$MIDIEd™MuÉiT¿ck
(è{
	}
}

252 
	$S‘S¹T¿ck
(
Œk
è{ 
¡¬t_Œack
 =rk; 
	}
}

253 
	$S‘EndT¿ck
(
Œk
è{ 
’d_Œack
 =rk; 
	}
}

254 
	$G‘S¹T¿ck
(ècÚ¡ {  
¡¬t_Œack
; 
	}
}

255 
	$G‘EndT¿ck
(ècÚ¡ {  
’d_Œack
; 
	}
}

258 
	$Ed™Cİy
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
Œ_¡¬t
,

259 
Œ_’d
, 
MIDIEd™MuÉiT¿ck
* 
ed™
è{
	}
}

260 
	$Ed™Cut
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
MIDIEd™MuÉiT¿ck
* 
ed™
è{
	}
}

261 
	$Ed™CË¬
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
Œ_¡¬t
, 
Œ_’d
è{
	}
}

262 
	$Ed™In£¹
(
MIDIClockTime
 
¡¬t
, 
Œ_¡¬t
, 
times
,

263 
boŞ
 
sy£x
, 
MIDIEd™MuÉiT¿ck
* 
ed™
è{
	}
}

264 
	$Ed™R•Ïû
(
MIDIClockTime
 
¡¬t
, 
Œ_¡¬t
, 
times
,

265 
boŞ
 
sy£x
, 
MIDIEd™MuÉiT¿ck
* 
ed™
è{
	}
}

271 
CİyAÎ
(
MIDIMuÉiT¿ck
* 
m
);

274 
	g´iv©e
:

276 
¡¬t_Œack
;

277 
	g’d_Œack
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\notifier.h

1 #iâdeà
_JDKMIDI_NOTIFIER_H


2 
	#_JDKMIDI_NOTIFIER_H


	)

5 
	~<io¡»am
>

6 
	~"´oûss.h
"

10 
şass
 
	gMIDISequ’ûr
;

25 şas 
	cMIDISequ’ûrGUIEv’t
 {

26 
	mpublic
:

28 
	$MIDISequ’ûrGUIEv’t
(è{ 
b™s
 = 0; }

30 
	$MIDISequ’ûrGUIEv’t
(
b™s_
è: 
	$b™s
(
b™s_
è{
	}
}

32 
	$MIDISequ’ûrGUIEv’t
ĞcÚ¡ 
MIDISequ’ûrGUIEv’t
 &
e
 ) : 
	$b™s
(
e
.
b™s
è{
	}
}

34 
	$MIDISequ’ûrGUIEv’t
Ğ
group
, 
subgroup
, 
™em
=0 ) {

35 
b™s
 = ((
group
&0xff)<<24è| ((
subgroup
&0xfff)<<12è| (
™em
&0xfff); 
	}
}

37 
İ”©Ü
 (ècÚ¡ {  
b™s
; 
	}
}

39 
	$S‘Ev’t
Ğ
group
, 
subgroup
 = 0, 
™em
 = 0 ) {

40 
b™s
 = ((
group
&0xff)<<24è| ((
subgroup
&0xfff)<<12è| (
™em
&0xfff); 
	}
}

42 
	$G‘Ev’tGroup
(ècÚ¡ {  ()((
b™s
>>24)&0xff); 
	}
}

45 
	$G‘Ev’tSubGroup
(ècÚ¡ {  ()((
b™s
>>12)&0xfff); 
	}
}

47 
	$G‘Ev’tI‹m
(ècÚ¡ {  ()((
b™s
>>0)&0xfff); 
	}
}

51 
	gGROUP_ALL
 = 0,

52 
	gGROUP_CONDUCTOR
,

53 
	gGROUP_TRANSPORT
,

54 
	gGROUP_TRACK


59 
	gGROUP_CONDUCTOR_ALL
 = 0,

60 
	gGROUP_CONDUCTOR_TEMPO
,

61 
	gGROUP_CONDUCTOR_TIMESIG
,

62 
	gGROUP_CONDUCTOR_KEYSIG
,

63 
	gGROUP_CONDUCTOR_MARKER


68 
	gGROUP_TRANSPORT_ALL
 = 0,

69 
	gGROUP_TRANSPORT_MODE
,

70 
	gGROUP_TRANSPORT_MEASURE
,

71 
	gGROUP_TRANSPORT_BEAT
,

72 
	gGROUP_TRANSPORT_ENDOFSONG


77 
	gGROUP_TRACK_ALL
 = 0,

78 
	gGROUP_TRACK_NAME
,

79 
	gGROUP_TRACK_PROGRAM
,

80 
	gGROUP_TRACK_NOTE
,

81 
	gGROUP_TRACK_VOLUME
,

82 
	gGROUP_TRACK_PAN
,

83 
	gGROUP_TRACK_CHR
,

84 
	gGROUP_TRACK_REV


88 cÚ¡ 
	ggroup_Çmes
[][10];

89 cÚ¡ 
	gcÚduùÜ_™ems_Çmes
[][10];

90 cÚ¡ 
	gŒª¥Üt_™ems_Çmes
[][10];

91 cÚ¡ 
	gŒack_™ems_Çmes
[][10];

93 
	g´iv©e
:

94 
b™s
;

107 şas 
	cMIDISequ’ûrGUINÙif›r
 {

108 
	mpublic
:

111 
	$MIDISequ’ûrGUINÙif›r
(cÚ¡ 
MIDISequ’ûr
* 
£q
 = 0) :

112 
	`£qu’ûr
(
£q
), 
	$’
(
Œue
) {}

114 
vœtu®
 ~
	$MIDISequ’ûrGUINÙif›r
(è{
	}
}

117 
vœtu®
 
	$S‘Sequ’ûr
(cÚ¡ 
MIDISequ’ûr
* 
£q
è{ 
£qu’ûr
 = seq; 
	}
}

119 
vœtu®
 
NÙify
(
MIDISequ’ûrGUIEv’t
 
e
) = 0;

121 
vœtu®
 
boŞ
 
	$G‘EÇbË
(ècÚ¡ {  
’
;
	}
};

123 
vœtu®
 
	$S‘EÇbË
(
boŞ
 
f
è{ 
’
 = f; 
	}
}

124 
	g´Ùeùed
:

125 cÚ¡ 
MIDISequ’ûr
* 
£qu’ûr
;

126 
boŞ
 
	g’
;

134 şas 
	cMIDISequ’ûrGUINÙif›rText
 : 
public
 
MIDISequ’ûrGUINÙif›r
 {

135 
public
:

136 
	$MIDISequ’ûrGUINÙif›rText
(cÚ¡ 
MIDISequ’ûr
* 
£q
 = 0, 
¡d
::
o¡»am
& 
o
 = std::
cout
) :

137 
	`MIDISequ’ûrGUINÙif›r
(
£q
), 
	$o¡
(
o
) {}

138 
vœtu®
 ~
	$MIDISequ’ûrGUINÙif›rText
(è{
	}
}

139 
vœtu®
 
NÙify
(
MIDISequ’ûrGUIEv’t
 
e
);

141 
	g´iv©e
:

142 
¡d
::
o¡»am
& 
o¡
;

173 #ifdeà
_WIN32


174 
	~"wšdows.h
"

175 
	~"mmsy¡em.h
"

178 şas 
	cMIDISequ’ûrGUINÙif›rWš32
 : 
public
 
MIDISequ’ûrGUINÙif›r
 {

179 
public
:

181 
MIDISequ’ûrGUINÙif›rWš32
 (
HWND
 
w
, 
DWORD
 
wmmsg
, 
WPARAM
 
w·¿m_v®ue_
 = 0);

184 
MIDISequ’ûrGUINÙif›rWš32
 (
HWND
 
w
);

186 
	mvœtu®
 ~
	$MIDISequ’ûrGUINÙif›rWš32
() {}

189 
DWORD
 
	$G‘MsgId
(ècÚ¡ {  
wšdow_msg
; 
	}
}

192 
vœtu®
 
NÙify
 (
MIDISequ’ûrGUIEv’t
 
e
);

194 
	g´iv©e
:

197 
UINT
 
	$G‘SaãSy¡emMsgId
(è{ 
UINT
 
ba£
 = 
WM_APP
;  ba£++; 
	}
}

199 
HWND
 
	gde¡_wšdow
;

200 
DWORD
 
	gwšdow_msg
;

201 
WPARAM
 
	gw·¿m_v®ue
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\process.h

31 #iâdeà
_JDKMIDI_PROCESS_H


32 
	#_JDKMIDI_PROCESS_H


	)

34 
	~"msg.h
"

35 
	~"sy£x.h
"

38 şas 
	cMIDIProûssÜ


40 
	mpublic
:

41 
MIDIProûssÜ
();

42 
	mvœtu®
 ~
MIDIProûssÜ
();

44 
vœtu®
 
boŞ
 
Proûss
Ğ
MIDITimedMes§ge
 *
msg
 ) = 0;

47 şas 
	cMIDIMuÉiProûssÜ
 : 
public
 
MIDIProûssÜ


49 
public
:

50 
MIDIMuÉiProûssÜ
Ğ
num_´oûssÜs
 );

51 
	mvœtu®
 ~
MIDIMuÉiProûssÜ
();

56 
	$S‘ProûssÜ
Ğ
pos™iÚ
, 
MIDIProûssÜ
 *
´oc
 )

58 
´oûssÜs
[
pos™iÚ
]=
´oc
;

61 
MIDIProûssÜ
 *
	$G‘ProûssÜ
Ğ
pos™iÚ
 )

63  
´oûssÜs
[
pos™iÚ
];

64 
	}
}

66 cÚ¡ 
MIDIProûssÜ
 *
	$G‘ProûssÜ
Ğ
pos™iÚ
 ) const

68  
´oûssÜs
[
pos™iÚ
];

69 
	}
}

72 
	$RemoveProûssÜ
 ( 
pos™iÚ
 )

74 
´oûssÜs
[
pos™iÚ
] = 0;

75 
	}
}

77 
vœtu®
 
boŞ
 
Proûss
Ğ
MIDITimedMes§ge
 *
msg
 );

79 
	g´iv©e
:

80 
MIDIProûssÜ
 **
´oûssÜs
;

81 
	gnum_´oûssÜs
;

84 şas 
	cMIDIProûssÜT¿n¥o£r
 : 
public
 
MIDIProûssÜ


86 
public
:

87 
MIDIProûssÜT¿n¥o£r
();

88 
	mvœtu®
 ~
MIDIProûssÜT¿n¥o£r
();

90 
	$S‘T¿n¥o£ChªÃl
Ğ
chª
, 
Œªs
 )

92 
Œªs_amouÁ
[
chª
] = 
Œªs
;

95 
	$G‘T¿n¥o£ChªÃl
Ğ
chª
 ) const

97  
Œªs_amouÁ
[
chª
];

98 
	}
}

100 
S‘AÎT¿n¥o£
Ğ
Œªs
 );

102 
vœtu®
 
boŞ
 
Proûss
Ğ
MIDITimedMes§ge
 *
msg
 );

103 
	g´iv©e
:

104 
Œªs_amouÁ
[16];

107 şas 
	cMIDIProûssÜRechªÃliz”
 : 
public
 
MIDIProûssÜ


109 
public
:

110 
MIDIProûssÜRechªÃliz”
();

111 
	mvœtu®
 ~
MIDIProûssÜRechªÃliz”
();

113 
	$S‘RechªM­
Ğ
¤c_chª
, 
de¡_chª
 )

115 
»chª_m­
[
¤c_chª
] = 
de¡_chª
;

118 
	$G‘RechªM­
Ğ
¤c_chª
 ) const

120  
»chª_m­
[
¤c_chª
];

121 
	}
}

123 
S‘AÎRechª
Ğ
de¡_chª
 );

125 
vœtu®
 
boŞ
 
Proûss
Ğ
MIDITimedMes§ge
 *
msg
 );

127 
	g´iv©e
:

129 
»chª_m­
[16];

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\queue.h

33 #iâdeà
_JDKMIDI_QUEUE_H


34 
	#_JDKMIDI_QUEUE_H


	)

36 
	~"msg.h
"

37 
	~"sy£x.h
"

43 şas 
	cMIDIQueue


45 
	mpublic
:

46 
MIDIQueue
Ğ
num_msgs
 );

47 
	mvœtu®
 ~
MIDIQueue
();

49 
CË¬
();

51 
boŞ
 
	$CªPut
() const

53  
Ãxt_out
 !ğ((
Ãxt_š
+1)%
bufsize
);

56 
boŞ
 
	$CªG‘
() const

58  
Ãxt_š
 !ğ
Ãxt_out
;

59 
	}
}

61 
boŞ
 
	$IsFuÎ
() const

63  !
	`CªPut
();

64 
	}
}

71 
	$Put
ĞcÚ¡ 
MIDITimedMes§ge
 &
msg
 )

73 
buf
[
Ãxt_š
] = 
msg
;

75 
Ãxt_š
 = (Ãxt_š+1)%
bufsize
;

76 
	}
}

78 
MIDITimedMes§ge
 
	$G‘
() const

80  
	`MIDITimedMes§ge
Ğ
buf
[
Ãxt_out
] );

81 
	}
}

83 
	$Next
()

85 
Ãxt_out
 = (Ãxt_out+1è% 
bufsize
;

86 
	}
}

88 cÚ¡ 
MIDITimedMes§ge
 *
	$P“k
() const

90  &
buf
[
Ãxt_out
];

91 
	}
}

93 
	g´Ùeùed
:

94 
MIDITimedMes§ge
 *
buf
;

95 
	gbufsize
;

96 vŞ©
	gÃxt_š
;

97 vŞ©
	gÃxt_out
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\sequencer.h

25 #iâdeà
_JDKMIDI_SEQUENCER_H


26 
	#_JDKMIDI_SEQUENCER_H


	)

28 
	~"Œack.h
"

29 
	~"muÉ™¿ck.h
"

31 
	~"m©rix.h
"

32 
	~"´oûss.h
"

33 
	~"nÙif›r.h
"

35 
	~<¡ršg
>

38 
şass
 
	gMIDISequ’ûr
;

49 şas 
	cMIDISequ’ûrT¿ckProûssÜ
 : 
public
 
MIDIProûssÜ
 {

50 
public
:

52 
MIDISequ’ûrT¿ckProûssÜ
();

54 
	mvœtu®
 ~
	$MIDISequ’ûrT¿ckProûssÜ
() {}

56 
vœtu®
 
	`Re£t
();

58 
vœtu®
 
boŞ
 
	`Proûss
 ( 
MIDITimedMes§ge
 *
msg
 );

60 
boŞ
 
mu‹
;

61 
boŞ
 
sŞo
;

62 
v–oc™y_sÿË
;

63 
»chªÃl
;

64 
Œª¥o£
;

65 
MIDIProûssÜ
 *
exŒa_´oc
;

66 
	}
};

77 şas 
	cMIDISequ’ûrT¿ckS‹
 {

78 
	mpublic
:

82 
MIDISequ’ûrT¿ckS‹
();

84 
	mvœtu®
 ~
	$MIDISequ’ûrT¿ckS‹
() {}

86 
vœtu®
 
	`Re£t
();

87 
´og¿m
;

88 
vŞume
;

89 
·n
;

90 
»v
;

91 
chr
;

92 
b’d”_v®ue
;

93 
¡d
::
¡ršg
 
Œack_Çme
;

94 
boŞ
 
nÙes_¬e_Ú
;

95 
MIDIM©rix
 
nÙe_m©rix
;

97 
boŞ
 
gÙ_good_Œack_Çme
;

98 
	}
};

114 şas 
	cMIDISequ’ûrS‹
 {

115 
	mpublic
:

117 
MIDISequ’ûrS‹
(
MIDIMuÉiT¿ck
 *
muÉ™¿ck_
,

118 
MIDISequ’ûrGUINÙif›r
 *
n
 = 0);

120 
MIDISequ’ûrS‹
(cÚ¡ MIDISequ’ûrS‹ &
s
);

122 ~
	$MIDISequ’ûrS‹
() {}

124 cÚ¡ 
MIDISequ’ûrS‹
& 
İ”©Ü
ğ(cÚ¡ MIDISequ’ûrS‹ &
s
);

127 
	$G‘NumT¿cks
(ècÚ¡ { 
muÉ™¿ck
->
	`G‘NumT¿cks
();
	}
}

131 
Re£t
();

135 
boŞ
 
Proûss
Ğ
MIDITimedMes§ge
* 
msg
 );

139 
	$NÙify
(
group
, 
™em
 = 0) const;

140 
	$NÙifyT¿ck
(
™em
) const;

142 
MIDISequ’ûrGUINÙif›r
 *
nÙif›r
;

143 
MIDIMuÉiT¿ck
* 
muÉ™¿ck
;

144 
MIDIMuÉiT¿ckI‹¿tÜ
 
™”©Ü
;

146 
MIDIClockTime
 
cur_şock
;

147 
cur_time_ms
;

148 
cur_b—t
;

149 
cur_m—su»
;

150 
MIDIClockTime
 
Ãxt_b—t_time
;

152 
‹mpobpm
;

153 
timesig_num”©Ü
;

154 
timesig_d’omš©Ü
;

155 
keysig_sh¬pæ©
;

156 
keysig_mode
;

157 
¡d
::
¡ršg
 
m¬k”_‹xt
;

158 
¡d
::
veùÜ
<
MIDISequ’ûrT¿ckS‹
>

159 
Œack_¡©es
;

161 
Ï¡_ev’t_Œack
;

162 
	}
};

177 şas 
	cMIDISequ’ûr
 {

178 
	mpublic
:

183 
MIDISequ’ûr
(
MIDIMuÉiT¿ck
* 
m
, 
MIDISequ’ûrGUINÙif›r
* 
n
 = 0);

185 
	mvœtu®
 ~
MIDISequ’ûr
();

190 
Re£t
();

192 
MIDIClockTime
 
	$G‘Cu¼’tMIDIClockTime
() const

193 {  
¡©e
.
cur_şock
; }

195 
	$G‘Cu¼’tTimeInMs
() const

196 {  
¡©e
.
cur_time_ms
; 
	}
}

198 
	$G‘Cu¼’tB—t
(ècÚ¡ {  
¡©e
.
cur_b—t
; 
	}
}

200 
	$G‘Cu¼’tM—su»
() const

201 {  
¡©e
.
cur_m—su»
; 
	}
}

203 
	$G‘Cu¼’tTempoSÿË
() const

204 {  (()
‹mpo_sÿË
è* 0.01; 
	}
}

207 
	$G‘Cu¼’tTempo
(ècÚ¡ {  
¡©e
.
‹mpobpm
; 
	}
}

211 
MIDISequ’ûrS‹
* 
	$G‘S‹
(è{  &
¡©e
; 
	}
}

212 cÚ¡ 
MIDISequ’ûrS‹
* 
	$G‘S‹
(ècÚ¡ {  &
¡©e
; 
	}
}

214 
MIDISequ’ûrT¿ckS‹
* 
	$G‘T¿ckS‹
(
Œk
è{  &
¡©e
.
Œack_¡©es
[Œk]; 
	}
}

215 cÚ¡ 
MIDISequ’ûrT¿ckS‹
* 
	$G‘T¿ckS‹
(
Œk
) const

216 {  &
¡©e
.
Œack_¡©es
[
Œk
]; 
	}
}

218 
MIDISequ’ûrT¿ckProûssÜ
* 
	$G‘T¿ckProûssÜ
(
Œk
)

219 {  
Œack_´oûssÜs
[
Œk
]; 
	}
}

220 cÚ¡ 
MIDISequ’ûrT¿ckProûssÜ
* 
	$G‘T¿ckProûssÜ
(
Œk
) const

221 {  
Œack_´oûssÜs
[
Œk
]; 
	}
}

223 
	$G‘NumT¿cks
(ècÚ¡ {  
¡©e
.
	`G‘NumT¿cks
(); 
	}
}

225 
boŞ
 
	$G‘SŞoMode
(ècÚ¡ {  
sŞo_mode
; 
	}
}

228 
	$S‘S‹
(
MIDISequ’ûrS‹
* 
s
)

229 { 
¡©e
 = *
s
; 
	}
}

230 
	$S‘Cu¼’tTempoSÿË
(
sÿË
)

231 { 
‹mpo_sÿË
 = ()(
sÿË
*100); 
	}
}

235 
S‘SŞoMode
(
boŞ
 
m
, 
Œk
 = -1);

243 
boŞ
 
In£¹T¿ck
(
Œk
 = -1);

247 
boŞ
 
D–‘eT¿ck
(
Œk
);

252 
boŞ
 
MoveT¿ck
(
äom
, 
to
);

255 
GoToZ”o
();

260 
boŞ
 
GoToTime
 (
MIDIClockTime
 
time_şk
);

262 
boŞ
 
GoToTimeMs
 (
time_ms
);

266 
boŞ
 
GoToM—su»
 (
m—su»
, 
b—t
 = 0);

271 
boŞ
 
G‘NextEv’tTime
 (
MIDIClockTime
 *
time_şk
);

273 
boŞ
 
G‘NextEv’tTimeMs
 (*
time_ms
);

282 
boŞ
 
G‘NextEv’t
 (*
Œk
, 
MIDITimedMes§ge
 *
msg
);

285 
MIDItoMs
(
MIDIClockTime
 
time_şk
);

290 
	$Upd©eStus
(è{ 
	`GoToTime
(
¡©e
.
cur_şock
); 
	}
}

292 
	g´Ùeùed
:

295 
SÿnEv’tsAtThisTime
();

297 
MIDITimedMes§ge
 
	gb—t_m¬k”_msg
;

298 
boŞ
 
	gsŞo_mode
;

299 
	g‹mpo_sÿË
;

300 
	g¡d
::
veùÜ
<
MIDISequ’ûrT¿ckProûssÜ
*>

301 
Œack_´oûssÜs
;

302 
MIDISequ’ûrS‹
 
	g¡©e
;

345 #iâdeà
JDKSMIDI_SEQUENCER_H


346 
	#JDKSMIDI_SEQUENCER_H


	)

354 
Çme¥aû
 
	gjdksmidi


	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\smpte.h

39 #iâdeà
_JDKMIDI_SMPTE_H


40 
	#_JDKMIDI_SMPTE_H


	)

47 
	eSMPTE_RATE


49 
	mSMPTE_RATE_24
 = 0,

50 
	mSMPTE_RATE_25
,

51 
	mSMPTE_RATE_2997
,

52 
	mSMPTE_RATE_2997DF
,

53 
	mSMPTE_RATE_30
,

54 
	mSMPTE_RATE_30DF


59 
	eSAMPLE_RATE


61 
	mSAMPLE_32000
 = 0,

62 
	mSAMPLE_44056
,

63 
	mSAMPLE_44100
,

64 
	mSAMPLE_47952
,

65 
	mSAMPLE_48000
,

66 
	mSAMPLE_48048


76 cÚ¡ 
sm±e_sm±e_¿‹s
[];

78 
šlše
 
	$G‘SMPTER©eF»qu’cy
 (
SMPTE_RATE
 
r
) {

79  
sm±e_sm±e_¿‹s
[ ( è
r
];

80 
	}
}

88 cÚ¡ 
sm±e_sm±e_¿‹s_lÚg
[];

90 
šlše
 
	$G‘SMPTER©eF»qu’cyLÚg
 (
SMPTE_RATE
 
r
) {

91  ( è
sm±e_sm±e_¿‹s_lÚg
[ ( è
r
];

92 
	}
}

99 cÚ¡ 
sm±e_§m¶e_¿‹s
[];

101 
šlše
 
	$G‘Sam¶eR©eF»qu’cy
 (
SAMPLE_RATE
 
r
) {

102  
sm±e_§m¶e_¿‹s
[ ( è
r
];

103 
	}
}

111 cÚ¡ 
sm±e_§m¶e_¿‹s_lÚg
[];

113 
šlše
 
	$G‘Sam¶eR©eF»qu’cyLÚg
 (
SAMPLE_RATE
 
r
) {

115  
sm±e_§m¶e_¿‹s_lÚg
[ ( è
r
];

116 
	}
}

127 şas 
	cSMPTE


129 
	mpublic
:

132 
SMPTE
 (
SMPTE_RATE
 
sm±e_¿‹
 = 
SMPTE_RATE_30
, 
SAMPLE_RATE
 
§m¶e_¿‹
 = 
SAMPLE_48000
);

135 
SMPTE
 (cÚ¡ SMPTE &
s
);

138 
	$S‘SMPTER©e
 (
SMPTE_RATE
 
r
)

139 { 
sm±e_¿‹
 = 
r
; 
§m¶e_numb”_dœty
 = 
Œue
; }

142 
SMPTE_RATE
 
	$G‘SMPTER©e
(ècÚ¡ {  
sm±e_¿‹
; 
	}
}

145 
	$S‘Sam¶eR©e
 (
SAMPLE_RATE
 
r
)

146 { 
§m¶e_¿‹
 = 
r
; 
§m¶e_numb”_dœty
 = 
Œue
; 
	}
}

149 
SAMPLE_RATE
 
	$G‘Sam¶eR©e
(ècÚ¡ {  
§m¶e_¿‹
; 
	}
}

155 
S‘Sam¶eNumb”
 (
ulÚg
 
n
);

156 
ulÚg
 
G‘Sam¶eNumb”
();

164 
S‘Time
 (
uch¬
 
h
, uch¬ 
m
, uch¬ 
s
, uch¬ 
f
 = 0, uch¬ 
sf
 = 0);

165 
	$S‘Hours
 (
uch¬
 
h
è{ 
hours
 = h; 
§m¶e_numb”_dœty
 = 
Œue
; 
	}
}

166 
	$S‘Mšu‹s
 (
uch¬
 
m
è{ 
mšu‹s
 = m; 
§m¶e_numb”_dœty
 = 
Œue
; 
	}
}

167 
	$S‘SecÚds
 (
uch¬
 
s
è{ 
£cÚds
 = s; 
§m¶e_numb”_dœty
 = 
Œue
; 
	}
}

168 
	$S‘F¿mes
 (
uch¬
 
f
è{ 
äames
 = f; 
§m¶e_numb”_dœty
 = 
Œue
; 
	}
}

169 
	$S‘SubF¿mes
 ( 
uch¬
 
sf
 ) { 
sub_äames
 = sf; 
§m¶e_numb”_dœty
 = 
Œue
; 
	}
}

171 
uch¬
 
	$G‘Hours
(ècÚ¡ {  
hours
; 
	}
}

172 
uch¬
 
	$G‘Mšu‹s
(ècÚ¡ {  
mšu‹s
; 
	}
}

173 
uch¬
 
	$G‘SecÚds
(ècÚ¡ {  
£cÚds
; 
	}
}

174 
uch¬
 
	$G‘F¿mes
(ècÚ¡ {  
äames
; 
	}
}

175 
uch¬
 
	$G‘SubF¿mes
(ècÚ¡ {  
sub_äames
; 
	}
}

182 
S‘MliSecÚds
 (
ulÚg
 
m£cs
);

188 
ulÚg
 
G‘MliSecÚds
 ();

194 
AddSam¶es
 (
n
);

195 
	$IncSam¶es
(è{ 
	`AddSam¶es
 (1); 
	}
}

196 
	$DecSam¶es
(è{ 
	`AddSam¶es
 (-1); 
	}
}

203 
AddHours
 (
h
);

204 
AddMšu‹s
 (
m
);

205 
AddSecÚds
 (
s
);

206 
AddF¿mes
 (
f
);

207 
AddSubF¿mes
 (
sf
);

208 
	$IncHours
(è{ 
	`AddHours
 (1); 
	}
}

209 
	$IncMšu‹s
(è{ 
	`AddMšu‹s
 (1); 
	}
}

210 
	$IncSecÚds
(è{ 
	`AddSecÚds
 (1); 
	}
}

211 
	$IncF¿mes
(è{ 
	`AddF¿mes
 (1); 
	}
}

212 
	$IncSubF¿mes
(è{ 
	`AddSubF¿mes
 (1); 
	}
}

213 
	$DecHours
(è{ 
	`AddHours
 (-1); 
	}
}

214 
	$DecMšu‹s
(è{ 
	`AddMšu‹s
 (-1); 
	}
}

215 
	$DecSecÚds
(è{ 
	`AddSecÚds
 (-1); 
	}
}

216 
	$DecF¿mes
(è{ 
	`AddF¿mes
 (-1); 
	}
}

217 
	$DecSubF¿mes
(è{ 
	`AddSubF¿mes
 (-1); 
	}
}

222 cÚ¡ 
	gSMPTE
& 
	gİ”©Ü
ğ(cÚ¡ 
SMPTE
 &
s
è{ 
Cİy
 (s);  *
	gthis
; }

223 
boŞ
 
	gİ”©Ü
=ğ(
SMPTE
 &
s
è{  
Com·»
 (s) == 0; }

224 
boŞ
 
	gİ”©Ü
!ğ(
SMPTE
 &
s
è{  
Com·»
 (s) != 0; }

225 
boŞ
 
	gİ”©Ü
< (
	gSMPTE
 &
	gs
è{  
Com·»
 (
s
) < 0; }

226 
boŞ
 
	gİ”©Ü
> (
	gSMPTE
 &
	gs
è{  
Com·»
 (
s
) > 0; }

227 
boŞ
 
	gİ”©Ü
<ğ(
SMPTE
 &
s
è{  
Com·»
 (s) <= 0; }

228 
boŞ
 
	gİ”©Ü
>ğ(
SMPTE
 &
s
è{  
Com·»
 (s) >= 0; }

229 cÚ¡ 
	gSMPTE
& 
	gİ”©Ü
+ğ(
SMPTE
 &
s
è{ 
Add
 (s);  *
	gthis
; }

230 cÚ¡ 
	gSMPTE
& 
	gİ”©Ü
-ğ(
SMPTE
 &
s
è{ 
SubŒaù
 (s);  *
	gthis
; }

233 
	g´Ùeùed
:

236 
Sam¶eToTime
();

239 
TimeToSam¶e
();

241 
Cİy
 (cÚ¡ 
SMPTE
 &
s
);

242 
Com·»
 (
SMPTE
 &
s
);

243 
Add
 (
SMPTE
 &
s
);

244 
SubŒaù
 (
SMPTE
 &
s
);

246 
	$G‘Sam¶eR©eLÚg
(ècÚ¡ {  
	`G‘Sam¶eR©eF»qu’cyLÚg
 (
§m¶e_¿‹
); 
	}
}

247 
	$G‘SMPTER©eLÚg
(ècÚ¡ {  
	`G‘SMPTER©eF»qu’cyLÚg
 (
sm±e_¿‹
); 
	}
}

249 
	g´iv©e
:

250 
SMPTE_RATE
 
sm±e_¿‹
;

251 
SAMPLE_RATE
 
	g§m¶e_¿‹
;

252 
ulÚg
 
	g§m¶e_numb”
;

254 
uch¬
 
	ghours
;

255 
uch¬
 
	gmšu‹s
;

256 
uch¬
 
	g£cÚds
;

257 
uch¬
 
	gäames
;

258 
uch¬
 
	gsub_äames
;

259 
uch¬
 
	g§m¶e_numb”_dœty
;

262 
ä›nd
 
SMPTE
 
	gİ”©Ü
 + ( SMPTE 
	ga
, SMPTE 
	gb
 );

263 
ä›nd
 
SMPTE
 
	gİ”©Ü
 - ( SMPTE 
	ga
, SMPTE 
	gb
 );

267 
šlše
 
SMPTE
 
	gİ”©Ü
 + ( SMPTE 
	ga
, SMPTE 
	gb
 ) {

268 
SMPTE
 
c
 ( 
a
 );

269 
	gc
 +ğ
b
;

270  
	gc
;

273 
šlše
 
SMPTE
 
	gİ”©Ü
 - ( SMPTE 
	ga
, SMPTE 
	gb
 ) {

274 
SMPTE
 
c
 ( 
a
 );

275 
	gc
 -ğ
b
;

276  
	gc
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\sysex.h

38 #iâdeà
JDKSMIDI_SYSEX_H


39 
	#JDKSMIDI_SYSEX_H


	)

41 
	~"midi.h
"

44 şas 
	cMIDISy¡emExşusive
 {

45 
	mpublic
:

46 
MIDISy¡emExşusive
(
size
=384 );

47 
MIDISy¡emExşusive
(cÚ¡ MIDISy¡emExşusiv&
e
);

48 
MIDISy¡emExşusive
(*
buf_
, 
max_Ën_
, 
cur_Ën_
, 
boŞ
 
d–‘abË_
);

49 
	mvœtu®
 ~
MIDISy¡emExşusive
();

51 
ä›nd
 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
MIDISy¡emExşusive
 &
e1
, cÚ¡ 
	mMIDISy¡emExşusive
 &
	me2
 );

53 
	$CË¬
(è{ 
cur_Ën
=0; 
chk_sum
=0; }

54 
	$CË¬Checksum
(è{ 
chk_sum
=0; 
	}
}

56 
	$PutSysBy‹
(
b
)

57 { ifĞ
cur_Ën
<
max_Ën
 ) 
buf
[cur_Ën++]=
b
; 
	}
}

58 
	$PutBy‹
(
b
è{ 
	`PutSysBy‹
(b); 
chk_sum
+=b; 
	}
}

59 
	$PutEXC
(è{ 
	`PutSysBy‹
Ğ
SYSEX_START
 ); 
	}
}

60 
	$PutEOX
(è{ 
	`PutSysBy‹
Ğ
SYSEX_END
 ); 
	}
}

63 
	$PutNibblizedBy‹
Ğ
b
 )

64 { 
	`PutBy‹
Ğ()(
b
&0xfè); PutBy‹Ğ()(b>>4è); 
	}
}

65 
	$PutNibblizedBy‹2
Ğ
b
 )

66 { 
	`PutBy‹
Ğ()(
b
>>4è); PutBy‹Ğ()(b&0xfè); 
	}
}

67 
	$PutChecksum
(è{ 
	`PutBy‹
Ğ()(
chk_sum
&0x7à)); 
	}
}

69 
	$G‘Checksum
(ècÚ¡ {  ()(
chk_sum
&0x7f); 
	}
}

70 
	$G‘L’gthSE
(ècÚ¡ {  
cur_Ën
; 
	}
}

71 
	$G‘L’gth
(ècÚ¡ {  
cur_Ën
; 
	}
}

72 
	$G‘D©a
Ğ
i
ècÚ¡ {  
buf
[i]; 
	}
}

73 
boŞ
 
	$IsFuÎ
(ècÚ¡ {  
cur_Ën
>=
max_Ën
; 
	}
}

74 * 
	$G‘Buf
(è{  
buf
; 
	}
}

75 cÚ¡ * 
	$G‘Buf
(ècÚ¡ {  
buf
; 
	}
}

76 
boŞ
 
	$IsGMRe£t
(ècÚ¡ {  
	`memcmp
(
buf
, 
GMRe£t_d©a
, 
cur_Ën
è=ğ0; 
	}
}

77 
boŞ
 
	$IsGSRe£t
(ècÚ¡ {  
	`memcmp
(
buf
, 
GSRe£t_d©a
, 
cur_Ën
è=ğ0; 
	}
}

78 
boŞ
 
	$IsXGRe£t
(ècÚ¡ {  
	`memcmp
(
buf
, 
XGRe£t_d©a
, 
cur_Ën
è=ğ0; 
	}
}

80 
	g´iv©e
:

81 * 
buf
;

82 
	gmax_Ën
;

83 
	gcur_Ën
;

84 
	gchk_sum
;

85 
boŞ
 
	gd–‘abË
;

87 cÚ¡ 
	gGMRe£t_d©a
[];

88 cÚ¡ 
	gGSRe£t_d©a
[];

89 cÚ¡ 
	gXGRe£t_d©a
[];

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\timer.h

1 #iâdeà
TIMER_H_INCLUDED


2 
	#TIMER_H_INCLUDED


	)

4 
	~<chrÚo
>

5 
	~<th»ad
>

6 
	~<©omic
>

8 
	~<io¡»am
>

10 
usšg
 
Çme¥aû
 
	g¡d
::
chrÚo
;

12 
	ttM£cs
;

13 (*
	tMIDITick
)(
	ttM£cs
, *);

16 şas 
	cMIDITim”
 {

17 
public
:

19 
¡d
::
	tchrÚo
::
	t¡—dy_şock
::
	ttime_pošt
 
	ttim•ošt
;

20 
¡d
::
	tchrÚo
::
	tmli£cÚds
 
	tdu¿tiÚ
;

22 
	`MIDITim”
(
»s
 = 
DEFAULT_RESOLUTION
);

24 
	$G‘ResŞutiÚ
(ècÚ¡ {  
»sŞutiÚ
; }

25 
	`S‘ResŞutiÚ
(
»s
);

27 
MIDITick
 
	$G‘MIDITick
(ècÚ¡ {  
tick
; 
	}
}

28 
S‘MIDITick
(
MIDITick
 
t
, * 

);

30 
boŞ
 
	$IsO³n
(ècÚ¡ {  
tim”_Ú
; 
	}
}

32 
boŞ
 
S¹
();

33 
Stİ
();

35 
tM£cs
 
	$G‘SysTimeMs
()

36 {  
du¿tiÚ_ÿ¡
<
mli£cÚds
>(
¡—dy_şock
::
	`now
(è- 
sys_şock_ba£
).
	`couÁ
(); 
	}
}

38 
	$Wa™
(
m£cs
)

39 { 
¡d
::
this_th»ad
::
	`¦“p_fÜ
(
	`mli£cÚds
(
m£cs
)); 
	}
}

42 
	g´Ùeùed
:

44 cÚ¡ 
DEFAULT_RESOLUTION
 = 10;

46 
Th»adProc
Ğ
MIDITim”
* 
tim”
 );

48 
	g»sŞutiÚ
;

49 
MIDITick
 
	gtick
;

50 * 
	gtick_·¿m
;

51 
	g¡d
::
th»ad
 
bg_th»ad
;

52 
	g¡d
::
©omic
<
boŞ
> 
tim”_Ú
;

53 
tim•ošt
 
	gsys_şock_ba£
;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\track.h

24 #iâdeà
MIDI_TRACK_H_INCLUDED


25 
	#MIDI_TRACK_H_INCLUDED


	)

28 
	~"midi.h
"

29 
	~"sy£x.h
"

30 
	~"msg.h
"

32 
	~<veùÜ
>

46 
	mINSMODE_DEFAULT
,

47 
	mINSMODE_INSERT
,

48 
	mINSMODE_REPLACE
,

49 
	mINSMODE_INSERT_OR_REPLACE
,

50 
	mINSMODE_INSERT_OR_REPLACE_BUT_NOTE


57 
	mCOMPMODE_EQUAL
,

58 
	mCOMPMODE_SAMEKIND
,

59 
	mCOMPMODE_TIME


68 şas 
	cMIDIT¿ck
 {

69 
	mpublic
:

72 
MIDIT¿ck
(
MIDIClockTime
 
’d_t
 = 0);

74 
MIDIT¿ck
(cÚ¡ MIDIT¿ck &
Œk
);

76 ~
MIDIT¿ck
();

78 
	mMIDIT¿ck
& 
	mİ”©Ü
=(cÚ¡ 
MIDIT¿ck
 &
Œk
);

82 
CË¬
(
boŞ
 
mªš_’d
 = 
çl£
);

85 
	$G‘NumEv’ts
(ècÚ¡ {  
ev’ts
.
	`size
(); }

87 
boŞ
 
	$IsT¿ckEm±y
(ècÚ¡ {  
ev’ts
.
	`size
(è=ğ1; 
	}
}

90 
MIDITimedMes§ge
* 
	$G‘Ev’tAdd»ss
(
ev_num
è{  &
ev’ts
[ev_num]; 
	}
}

91 cÚ¡ 
MIDITimedMes§ge
* 
	$G‘Ev’tAdd»ss
(
ev_num
ècÚ¡ {  &
ev’ts
[ev_num]; 
	}
}

94 
	gMIDITimedMes§ge
& 
	$G‘Ev’t
(
ev_num
è{  
ev’ts
[ev_num]; 
	}
}

95 cÚ¡ 
	gMIDITimedMes§ge
& 
	$G‘Ev’t
(
ev_num
ècÚ¡ {  
ev’ts
[ev_num]; 
	}
}

97 
MIDIClockTime
 
	$G‘EndTime
(ècÚ¡ {  
ev’ts
.
	`back
().
	`G‘Time
(); 
	}
}

100 
boŞ
 
S‘EndTime
(
MIDIClockTime
 
’d_t
);

102 
S‘ChªÃl
(
ch
);

104 
boŞ
 
	$IsV®idEv’tNum
(
ev_num
) const

105 {  (0 <ğ
ev_num
 && (ëv_num < 
ev’ts
.
	`size
()); 
	}
}

108 
MIDIClockTime
 
	$G‘NÙeL’gth
 (cÚ¡ 
MIDITimedMes§ge
& 
msg
) const;

115 
	`S‘In£¹Mode
(
mode
);

133 
boŞ
 
	`In£¹Ev’t
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
, 
mode
 = 
INSMODE_DEFAULT
 );

151 
boŞ
 
	`In£¹NÙe
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
, 
MIDIClockTime
 
Ën
,

152 
mode
 = 
INSMODE_DEFAULT
 );

157 
boŞ
 
	`D–‘eEv’t
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
 );

164 
boŞ
 
	`D–‘eNÙe
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
 );

169 
	`PushEv’t
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
);

171 
	`In£¹IÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
Ëngth
, cÚ¡ 
MIDIT¿ck
* 
¤c
 = 0);

173 
MIDIT¿ck
* 
	$MakeIÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
MIDIT¿ck
* 
š‹rv®
) const;

175 
	`D–‘eIÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
);

177 
	`CË¬IÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
);

179 
	`R•ÏûIÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
Ëngth
,

180 
boŞ
 
sy£x
, cÚ¡ 
MIDIT¿ck
* 
¤c
);

184 
	`Clo£O³nEv’ts
(
MIDIClockTime
 
t
);

196 
boŞ
 
	$FšdEv’tNumb”
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
, *
ev’t_num
,

197 
mode
 = 
COMPMODE_EQUAL
) const;

204 
boŞ
 
	$FšdEv’tNumb”
 (
MIDIClockTime
 
time
, *
ev’t_num
) const;

208 
´Ùeùed
 :

209 
¡d
::
veùÜ
<
MIDITimedMes§ge
>

210 
ev’ts
;

211 
šs_mode
;

212 
	}
};

219 şas 
	cMIDIT¿ckI‹¿tÜ
 {

220 
	mpublic
:

221 
MIDIT¿ckI‹¿tÜ
(
MIDIT¿ck
* 
Œk
);

223 
Re£t
();

224 
MIDIT¿ck
* 
	$G‘T¿ck
(è{  
Œack
; }

225 cÚ¡ 
MIDIT¿ck
* 
	$G‘T¿ck
(ècÚ¡ {  
Œack
; 
	}
}

226 
S‘T¿ck
(
MIDIT¿ck
* 
Œk
);

227 
MIDIClockTime
 
	$G‘CurTime
(ècÚ¡ {  
cur_time
; 
	}
}

229 
	$G‘Prog¿m
(ècÚ¡ {  
´og¿m
; 
	}
}

230 
	$G‘CÚŒŞ
(
uch¬
 
c
ècÚ¡ {  
cÚŒŞs
[c]; 
	}
}

231 
	$G‘B’d”
(ècÚ¡ {  
b’d”_v®ue
; 
	}
}

232 
	$G‘MIDIChªÃl
(ècÚ¡ {  
chªÃl
; 
	}
}

233 
	$NÙesOn
(ècÚ¡ {  
num_nÙes_Ú
; 
	}
}

234 
	$IsNÙeOn
(
uch¬
 
n
ècÚ¡ {  
nÙes_Ú
[n]; 
	}
}

235 
boŞ
 
	$IsPed®On
(ècÚ¡ {  
cÚŒŞs
[64] > 64; 
	}
}

236 
boŞ
 
FšdNÙeOff
(
uch¬
 
nÙe
, 
MIDITimedMes§ge
** 
msg
);

237 
boŞ
 
FšdPed®Off
(
MIDITimedMes§ge
** 
msg
);

238 
boŞ
 
G‘CurEv’t
(
MIDITimedMes§ge
** 
msg
, 
MIDIClockTime
 
’d
 = 
TIME_INFINITE
);

241 
MIDIClockTime
 
	$G‘CurEv’tTime
() const;

243 
boŞ
 
	`Ev’tIsNow
(cÚ¡ 
MIDITimedMes§ge
& 
msg
);

246 
boŞ
 
	`GoToNextEv’t
();

247 
boŞ
 
	`GoToTime
(
MIDIClockTime
 
time
);

250 
´iv©e
:

252 
	`FšdChªÃl
();

253 
boŞ
 
	`Proûss
(cÚ¡ 
MIDITimedMes§ge
 *
msg
);

254 
	`SÿnEv’tsAtThisTime
();

258 
MIDIT¿ck
* 
Œack
;

259 
chªÃl
;

260 
cur_ev_num
;

261 
MIDIClockTime
 
cur_time
;

263 
´og¿m
;

264 
cÚŒŞs
[128];

265 
b’d”_v®ue
;

266 
uch¬
 
num_nÙes_Ú
;

267 
nÙes_Ú
[128];

268 
	}
};

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\world.h

41 #iâdeà
_JDKMIDI_WORLD_H


42 
	#_JDKMIDI_WORLD_H


	)

44 
	~<¡dio.h
>

45 
	~<¡dlib.h
>

46 
	~<¡ršg.h
>

48 
	#ENTER
(
a
)

	)

49 
	#DBG
(
a
)

	)

50 
	#OSTYPE
Ğ
a
,
b
,
c
,
d
 ) (×)*0x1000000 + (b)*0x10000 + (c)*0x100 + (dè)

	)

52 
	tuch¬
;

53 
	tulÚg
;

54 
	tušt
;

55 
	tushÜt
;

57 cÚ¡ 
	gDEFAULT_CLKS_PER_BEAT
 = 120;

58 cÚ¡ 
	gDEFAULT_MAX_NUM_TRACKS
 = 64;

61 
	tMIDIClockTime
;

62 cÚ¡ 
MIDIClockTime
 
	gTIME_INFINITE
 = 0xffffffff;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\rtmidi-2.1.1\RtMidi.cpp

39 
	~"RtMidi.h
"

40 
	~<s¡»am
>

42 #ià
defšed
(
__MACOSX_CORE__
)

43 #ià
TARGET_OS_IPHONE


44 
	#AudioG‘Cu¼’tHo¡Time
 
CAHo¡TimeBa£
::
G‘Cu¼’tTime


	)

45 
	#AudioCÚv”tHo¡TimeToNªos
 
CAHo¡TimeBa£
::
CÚv”tToNªos


	)

53 
	gRtMidi
 :: 
	$RtMidi
()

54 : 
	$¹­i_
(0)

56 
	}
}

58 
RtMidi
 :: ~
	$RtMidi
()

60 iàĞ
¹­i_
 )

61 
d–‘e
 
¹­i_
;

62 
¹­i_
 = 0;

63 
	}
}

65 
	g¡d
::
¡ršg
 
RtMidi
 :: 
	$g‘V”siÚ
Ğè
	$throw
()

67  
¡d
::
	`¡ršg
Ğ
RTMIDI_VERSION
 );

68 
	}
}

70 
	gRtMidi
 :: 
g‘CompedApi
Ğ
¡d
::
veùÜ
<
RtMidi
::
Api
> &
­is
 ) 
	$throw
()

72 
­is
.
	`ş—r
();

76 #ià
	`defšed
(
__MACOSX_CORE__
)

77 
­is
.
	`push_back
Ğ
MACOSX_CORE
 );

79 #ià
	`defšed
(
__LINUX_ALSA__
)

80 
­is
.
	`push_back
Ğ
LINUX_ALSA
 );

82 #ià
	`defšed
(
__UNIX_JACK__
)

83 
­is
.
	`push_back
Ğ
UNIX_JACK
 );

85 #ià
	`defšed
(
__WINDOWS_MM__
)

86 
­is
.
	`push_back
Ğ
WINDOWS_MM
 );

88 #ià
	`defšed
(
__RTMIDI_DUMMY__
)

89 
­is
.
	`push_back
Ğ
RTMIDI_DUMMY
 );

91 
	}
}

97 
	gRtMidiIn
 :: 
	$İ’MidiApi
Ğ
RtMidi
::
Api
 
­i
, cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 )

99 iàĞ
¹­i_
 )

100 
d–‘e
 
¹­i_
;

101 
¹­i_
 = 0;

103 #ià
	`defšed
(
__UNIX_JACK__
)

104 iàĞ
­i
 =ğ
UNIX_JACK
 )

105 
¹­i_
 = 
Ãw
 
	`MidiInJack
Ğ
ş›ÁName
, 
queueSizeLim™
 );

107 #ià
	`defšed
(
__LINUX_ALSA__
)

108 iàĞ
­i
 =ğ
LINUX_ALSA
 )

109 
¹­i_
 = 
Ãw
 
	`MidiInAl§
Ğ
ş›ÁName
, 
queueSizeLim™
 );

111 #ià
	`defšed
(
__WINDOWS_MM__
)

112 iàĞ
­i
 =ğ
WINDOWS_MM
 )

113 
¹­i_
 = 
Ãw
 
	`MidiInWšMM
Ğ
ş›ÁName
, 
queueSizeLim™
 );

115 #ià
	`defšed
(
__MACOSX_CORE__
)

116 iàĞ
­i
 =ğ
MACOSX_CORE
 )

117 
¹­i_
 = 
Ãw
 
	`MidiInCÜe
Ğ
ş›ÁName
, 
queueSizeLim™
 );

119 #ià
	`defšed
(
__RTMIDI_DUMMY__
)

120 iàĞ
­i
 =ğ
RTMIDI_DUMMY
 )

121 
¹­i_
 = 
Ãw
 
	`MidiInDummy
Ğ
ş›ÁName
, 
queueSizeLim™
 );

123 
	}
}

125 
	gRtMidiIn
 :: 
	$RtMidiIn
Ğ
RtMidi
::
Api
 
­i
, cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 )

126 : 
	$RtMidi
()

128 iàĞ
­i
 !ğ
UNSPECIFIED
 ) {

130 
	`İ’MidiApi
Ğ
­i
, 
ş›ÁName
, 
queueSizeLim™
 );

131 iàĞ
¹­i_
 ) ;

135 
¡d
::
û¼
 << "\nRtMidiIn:‚Øcomped suµÜˆfÜ s³cif›d API‡rgum’t!\n\n" << std::
’dl
;

140 
¡d
::
veùÜ
< 
RtMidi
::
Api
 > 
­is
;

141 
	`g‘CompedApi
Ğ
­is
 );

142  
i
=0; i<
­is
.
	`size
(); i++ ) {

143 
	`İ’MidiApi
Ğ
­is
[
i
], 
ş›ÁName
, 
queueSizeLim™
 );

144 iàĞ
¹­i_
->
	`g‘PÜtCouÁ
() ) ;

147 iàĞ
¹­i_
 ) ;

153 
¡d
::
¡ršg
 
”rÜText
 = "RtMidiIn:‚o compiled API support found ... criticalƒrror!!";

154 
	`throw
Ğ
	`RtMidiE¼Ü
Ğ
”rÜText
, 
RtMidiE¼Ü
::
UNSPECIFIED
 ) );

155 
	}
}

157 
	gRtMidiIn
 :: ~
	$RtMidiIn
(è
	$throw
()

159 
	}
}

166 
RtMidiOut
 :: 
	$İ’MidiApi
Ğ
RtMidi
::
Api
 
­i
, cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 )

168 iàĞ
¹­i_
 )

169 
d–‘e
 
¹­i_
;

170 
¹­i_
 = 0;

172 #ià
	`defšed
(
__UNIX_JACK__
)

173 iàĞ
­i
 =ğ
UNIX_JACK
 )

174 
¹­i_
 = 
Ãw
 
	`MidiOutJack
Ğ
ş›ÁName
 );

176 #ià
	`defšed
(
__LINUX_ALSA__
)

177 iàĞ
­i
 =ğ
LINUX_ALSA
 )

178 
¹­i_
 = 
Ãw
 
	`MidiOutAl§
Ğ
ş›ÁName
 );

180 #ià
	`defšed
(
__WINDOWS_MM__
)

181 iàĞ
­i
 =ğ
WINDOWS_MM
 )

182 
¹­i_
 = 
Ãw
 
	`MidiOutWšMM
Ğ
ş›ÁName
 );

184 #ià
	`defšed
(
__MACOSX_CORE__
)

185 iàĞ
­i
 =ğ
MACOSX_CORE
 )

186 
¹­i_
 = 
Ãw
 
	`MidiOutCÜe
Ğ
ş›ÁName
 );

188 #ià
	`defšed
(
__RTMIDI_DUMMY__
)

189 iàĞ
­i
 =ğ
RTMIDI_DUMMY
 )

190 
¹­i_
 = 
Ãw
 
	`MidiOutDummy
Ğ
ş›ÁName
 );

192 
	}
}

194 
	gRtMidiOut
 :: 
	$RtMidiOut
Ğ
RtMidi
::
Api
 
­i
, cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 )

196 iàĞ
­i
 !ğ
UNSPECIFIED
 ) {

198 
	`İ’MidiApi
Ğ
­i
, 
ş›ÁName
 );

199 iàĞ
¹­i_
 ) ;

203 
¡d
::
û¼
 << "\nRtMidiOut:‚Øcomped suµÜˆfÜ s³cif›d API‡rgum’t!\n\n" << std::
’dl
;

208 
¡d
::
veùÜ
< 
RtMidi
::
Api
 > 
­is
;

209 
	`g‘CompedApi
Ğ
­is
 );

210  
i
=0; i<
­is
.
	`size
(); i++ ) {

211 
	`İ’MidiApi
Ğ
­is
[
i
], 
ş›ÁName
 );

212 iàĞ
¹­i_
->
	`g‘PÜtCouÁ
() ) ;

215 iàĞ
¹­i_
 ) ;

221 
¡d
::
¡ršg
 
”rÜText
 = "RtMidiOut:‚o compiled API support found ... criticalƒrror!!";

222 
	`throw
Ğ
	`RtMidiE¼Ü
Ğ
”rÜText
, 
RtMidiE¼Ü
::
UNSPECIFIED
 ) );

223 
	}
}

225 
	gRtMidiOut
 :: ~
	$RtMidiOut
(è
	$throw
()

227 
	}
}

233 
MidiApi
 :: 
	$MidiApi
( )

234 : 
	`­iD©a_
Ğ0 ), 
	`cÚÃùed_
Ğ
çl£
 ), 
	`”rÜC®lback_
(0), 
	$”rÜC®lbackU£rD©a_
(0)

236 
	}
}

238 
	gMidiApi
 :: ~
	$MidiApi
( )

240 
	}
}

242 
MidiApi
 :: 
	$£tE¼ÜC®lback
Ğ
RtMidiE¼ÜC®lback
 
”rÜC®lback
, *
u£rD©a
 = 0 )

244 
”rÜC®lback_
 = 
”rÜC®lback
;

245 
”rÜC®lbackU£rD©a_
 = 
u£rD©a
;

246 
	}
}

248 
	gMidiApi
 :: 
	$”rÜ
Ğ
RtMidiE¼Ü
::
Ty³
 
ty³
, 
¡d
::
¡ršg
 
”rÜSŒšg
 )

250 iàĞ
”rÜC®lback_
 ) {

252 iàĞ
fœ¡E¼ÜOccu¼ed_
 )

255 
fœ¡E¼ÜOccu¼ed_
 = 
Œue
;

256 cÚ¡ 
¡d
::
¡ršg
 
”rÜMes§ge
 = 
”rÜSŒšg
;

258 
	`”rÜC®lback_
Ğ
ty³
, 
”rÜMes§ge
, 
”rÜC®lbackU£rD©a_
);

259 
fœ¡E¼ÜOccu¼ed_
 = 
çl£
;

263 iàĞ
ty³
 =ğ
RtMidiE¼Ü
::
WARNING
 ) {

264 
¡d
::
û¼
 << '\n' << 
”rÜSŒšg
 << "\n\n";

266 iàĞ
ty³
 =ğ
RtMidiE¼Ü
::
DEBUG_WARNING
 ) {

267 #ià
	`defšed
(
__RTMIDI_DEBUG__
)

268 
¡d
::
û¼
 << '\n' << 
”rÜSŒšg
 << "\n\n";

272 
¡d
::
û¼
 << '\n' << 
”rÜSŒšg
 << "\n\n";

273 
throw
 
	`RtMidiE¼Ü
Ğ
”rÜSŒšg
, 
ty³
 );

275 
	}
}

281 
	gMidiInApi
 :: 
	$MidiInApi
Ğ
queueSizeLim™
 )

282 : 
	$MidiApi
()

285 
šputD©a_
.
queue
.
ršgSize
 = 
queueSizeLim™
;

286 iàĞ
šputD©a_
.
queue
.
ršgSize
 > 0 )

287 
šputD©a_
.
queue
.
ršg
 = 
Ãw
 
MidiMes§ge
[ iÅutD©a_.queue.
ršgSize
 ];

288 
	}
}

290 
	gMidiInApi
 :: ~
	$MidiInApi
( )

293 iàĞ
šputD©a_
.
queue
.
ršgSize
 > 0 ) 
d–‘e
 [] iÅutD©a_.queue.
ršg
;

294 
	}
}

296 
	gMidiInApi
 :: 
	$£tC®lback
Ğ
RtMidiIn
::
RtMidiC®lback
 
ÿÎback
, *
u£rD©a
 )

298 iàĞ
šputD©a_
.
usšgC®lback
 ) {

299 
”rÜSŒšg_
 = "MidiInApi::setCallback:‡ callback function is‡lready set!";

300 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

304 iàĞ!
ÿÎback
 ) {

305 
”rÜSŒšg_
 = "RtMidiIn::setCallback: callback function value is invalid!";

306 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

310 
šputD©a_
.
u£rC®lback
 = 
ÿÎback
;

311 
šputD©a_
.
u£rD©a
 = userData;

312 
šputD©a_
.
usšgC®lback
 = 
Œue
;

313 
	}
}

315 
	gMidiInApi
 :: 
	$ÿnûlC®lback
()

317 iàĞ!
šputD©a_
.
usšgC®lback
 ) {

318 
”rÜSŒšg_
 = "RtMidiIn::cancelCallback:‚o callback function was set!";

319 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

323 
šputD©a_
.
u£rC®lback
 = 0;

324 
šputD©a_
.
u£rD©a
 = 0;

325 
šputD©a_
.
usšgC®lback
 = 
çl£
;

326 
	}
}

328 
	gMidiInApi
 :: 
	$ignÜeTy³s
Ğ
boŞ
 
midiSy£x
, boŞ 
midiTime
, boŞ 
midiS’£
 )

330 
šputD©a_
.
ignÜeFÏgs
 = 0;

331 iàĞ
midiSy£x
 ) 
šputD©a_
.
ignÜeFÏgs
 = 0x01;

332 iàĞ
midiTime
 ) 
šputD©a_
.
ignÜeFÏgs
 |= 0x02;

333 iàĞ
midiS’£
 ) 
šputD©a_
.
ignÜeFÏgs
 |= 0x04;

334 
	}
}

336 
	gMidiInApi
 :: 
g‘Mes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 )

338 
mes§ge
->
ş—r
();

340 iàĞ
	gšputD©a_
.
	gusšgC®lback
 ) {

341 
	g”rÜSŒšg_
 = "RtMidiIn::getNextMessage:‡ user callback is currently set forhis…ort.";

342 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

346 iàĞ
	gšputD©a_
.
	gqueue
.
	gsize
 == 0 )  0.0;

349 
	g¡d
::
veùÜ
<> *
by‹s
 = &(
šputD©a_
.
queue
.
ršg
[šputD©a_.queue.
äÚt
].bytes);

350 
	gmes§ge
->
assign
Ğ
by‹s
->
begš
(), by‹s->
’d
() );

351 
	gd–Time
 = 
šputD©a_
.
queue
.
ršg
[šputD©a_.queue.
äÚt
].
timeSmp
;

352 
	gšputD©a_
.
	gqueue
.
	gsize
--;

353 
	gšputD©a_
.
	gqueue
.
	gäÚt
++;

354 iàĞ
	gšputD©a_
.
	gqueue
.
	gäÚt
 =ğ
šputD©a_
.
queue
.
ršgSize
 )

355 
šputD©a_
.
queue
.
äÚt
 = 0;

357  
	gd–Time
;

364 
	gMidiOutApi
 :: 
	$MidiOutApi
( )

365 : 
	$MidiApi
()

367 
	}
}

369 
MidiOutApi
 :: ~
	$MidiOutApi
( )

371 
	}
}

379 #ià
defšed
(
__MACOSX_CORE__
)

386 
	~<CÜeMIDI/CÜeMIDI.h
>

387 
	~<CÜeAudio/Ho¡Time.h
>

388 
	~<CÜeS”viûs/CÜeS”viûs.h
>

392 
	sCÜeMidiD©a
 {

393 
MIDICl›ÁRef
 
ş›Á
;

394 
MIDIPÜtRef
 
	mpÜt
;

395 
MIDIEndpoštRef
 
	m’dpošt
;

396 
MIDIEndpoštRef
 
	mde¡š©iÚId
;

397 
	mÏ¡Time
;

398 
MIDISy£xS’dReque¡
 
	msy£x»q
;

406 
	$midiIÅutC®lback
ĞcÚ¡ 
MIDIPack‘Li¡
 *
li¡
, *
´ocRef
, * )

408 
MidiInApi
::
RtMidiInD©a
 *
d©a
 = 
¡©ic_ÿ¡
<MidiInApi::RtMidiInD©¨*> (
´ocRef
);

409 
CÜeMidiD©a
 *
­iD©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
d©a
->apiData);

411 
¡©us
;

412 
nBy‹s
, 
iBy‹
, 
size
;

413 
time
;

415 
boŞ
& 
cÚtšueSy£x
 = 
d©a
->continueSysex;

416 
MidiInApi
::
MidiMes§ge
& 
mes§ge
 = 
d©a
->message;

418 cÚ¡ 
MIDIPack‘
 *
·ck‘
 = &
li¡
->packet[0];

419  
i
=0; i<
li¡
->
numPack‘s
; ++i ) {

430 
nBy‹s
 = 
·ck‘
->
Ëngth
;

431 iàĞ
nBy‹s
 == 0 ) ;

435 iàĞ
d©a
->
fœ¡Mes§ge
 ) {

436 
mes§ge
.
timeSmp
 = 0.0;

437 
d©a
->
fœ¡Mes§ge
 = 
çl£
;

440 
time
 = 
·ck‘
->
timeSmp
;

441 iàĞ
time
 == 0 ) {

442 
time
 = 
	`AudioG‘Cu¼’tHo¡Time
();

444 
time
 -ğ
­iD©a
->
Ï¡Time
;

445 
time
 = 
	`AudioCÚv”tHo¡TimeToNªos
(ime );

446 iàĞ!
cÚtšueSy£x
 )

447 
mes§ge
.
timeSmp
 = 
time
 * 0.000000001;

449 
­iD©a
->
Ï¡Time
 = 
·ck‘
->
timeSmp
;

450 iàĞ
­iD©a
->
Ï¡Time
 == 0 ) {

451 
­iD©a
->
Ï¡Time
 = 
	`AudioG‘Cu¼’tHo¡Time
();

455 
iBy‹
 = 0;

456 iàĞ
cÚtšueSy£x
 ) {

458 iàĞ!Ğ
d©a
->
ignÜeFÏgs
 & 0x01 ) ) {

460  
j
=0; j<
nBy‹s
; ++j )

461 
mes§ge
.
by‹s
.
	`push_back
Ğ
·ck‘
->
d©a
[
j
] );

463 
cÚtšueSy£x
 = 
·ck‘
->
d©a
[
nBy‹s
-1] != 0xF7;

465 iàĞ!Ğ
d©a
->
ignÜeFÏgs
 & 0x01 ) && !
cÚtšueSy£x
 ) {

467 iàĞ
d©a
->
usšgC®lback
 ) {

468 
RtMidiIn
::
RtMidiC®lback
 
ÿÎback
 = (RtMidiIn::RtMidiC®lbackè
d©a
->
u£rC®lback
;

469 
	`ÿÎback
Ğ
mes§ge
.
timeSmp
, &mes§ge.
by‹s
, 
d©a
->
u£rD©a
 );

473 iàĞ
d©a
->
queue
.
size
 < d©a->queue.
ršgSize
 ) {

474 
d©a
->
queue
.
ršg
[d©a->queue.
back
++] = 
mes§ge
;

475 iàĞ
d©a
->
queue
.
back
 =ğd©a->queue.
ršgSize
 )

476 
d©a
->
queue
.
back
 = 0;

477 
d©a
->
queue
.
size
++;

480 
¡d
::
û¼
 << "\nMidiInCore: message queue†imit„eached!!\n\n";

482 
mes§ge
.
by‹s
.
	`ş—r
();

486  
iBy‹
 < 
nBy‹s
 ) {

487 
size
 = 0;

489 
¡©us
 = 
·ck‘
->
d©a
[
iBy‹
];

490 iàĞ!(
¡©us
 & 0x80) ) ;

492 iàĞ
¡©us
 < 0xC0 ) 
size
 = 3;

493 iàĞ
¡©us
 < 0xE0 ) 
size
 = 2;

494 iàĞ
¡©us
 < 0xF0 ) 
size
 = 3;

495 iàĞ
¡©us
 == 0xF0 ) {

497 iàĞ
d©a
->
ignÜeFÏgs
 & 0x01 ) {

498 
size
 = 0;

499 
iBy‹
 = 
nBy‹s
;

501 
size
 = 
nBy‹s
 - 
iBy‹
;

502 
cÚtšueSy£x
 = 
·ck‘
->
d©a
[
nBy‹s
-1] != 0xF7;

504 iàĞ
¡©us
 == 0xF1 ) {

506 iàĞ
d©a
->
ignÜeFÏgs
 & 0x02 ) {

507 
size
 = 0;

508 
iBy‹
 += 2;

510 
size
 = 2;

512 iàĞ
¡©us
 =ğ0xF2 ) 
size
 = 3;

513 iàĞ
¡©us
 =ğ0xF3 ) 
size
 = 2;

514 iàĞ
¡©us
 =ğ0xF8 && ( 
d©a
->
ignÜeFÏgs
 & 0x02 ) ) {

516 
size
 = 0;

517 
iBy‹
 += 1;

519 iàĞ
¡©us
 =ğ0xFE && ( 
d©a
->
ignÜeFÏgs
 & 0x04 ) ) {

521 
size
 = 0;

522 
iBy‹
 += 1;

524 
size
 = 1;

527 iàĞ
size
 ) {

528 
mes§ge
.
by‹s
.
	`assign
Ğ&
·ck‘
->
d©a
[
iBy‹
], &·ck‘->d©a[iBy‹+
size
] );

529 iàĞ!
cÚtšueSy£x
 ) {

531 iàĞ
d©a
->
usšgC®lback
 ) {

532 
RtMidiIn
::
RtMidiC®lback
 
ÿÎback
 = (RtMidiIn::RtMidiC®lbackè
d©a
->
u£rC®lback
;

533 
	`ÿÎback
Ğ
mes§ge
.
timeSmp
, &mes§ge.
by‹s
, 
d©a
->
u£rD©a
 );

537 iàĞ
d©a
->
queue
.
size
 < d©a->queue.
ršgSize
 ) {

538 
d©a
->
queue
.
ršg
[d©a->queue.
back
++] = 
mes§ge
;

539 iàĞ
d©a
->
queue
.
back
 =ğd©a->queue.
ršgSize
 )

540 
d©a
->
queue
.
back
 = 0;

541 
d©a
->
queue
.
size
++;

544 
¡d
::
û¼
 << "\nMidiInCore: message queue†imit„eached!!\n\n";

546 
mes§ge
.
by‹s
.
	`ş—r
();

548 
iBy‹
 +ğ
size
;

552 
·ck‘
 = 
	`MIDIPack‘Next
(packet);

554 
	}
}

556 
	gMidiInCÜe
 :: 
	$MidiInCÜe
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 ) : 
	$MidiInApi
Ğ
queueSizeLim™
 )

558 
	`š™Ÿlize
Ğ
ş›ÁName
 );

559 
	}
}

561 
	gMidiInCÜe
 :: ~
	$MidiInCÜe
( )

564 
	`şo£PÜt
();

567 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

568 
	`MIDICl›ÁDi¥o£
Ğ
d©a
->
ş›Á
 );

569 iàĞ
d©a
->
’dpošt
 ) 
	`MIDIEndpoštDi¥o£
( data->endpoint );

570 
d–‘e
 
d©a
;

571 
	}
}

573 
	gMidiInCÜe
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 )

576 
MIDICl›ÁRef
 
ş›Á
;

577 
CFSŒšgRef
 
Çme
 = 
	`CFSŒšgC»©eW™hCSŒšg
Ğ
NULL
, 
ş›ÁName
.
	`c_¡r
(), 
kCFSŒšgEncodšgASCII
 );

578 
OSStus
 
»suÉ
 = 
	`MIDICl›ÁC»©e
(
Çme
, 
NULL
, NULL, &
ş›Á
 );

579 iàĞ
»suÉ
 !ğ
noE¼
 ) {

580 
”rÜSŒšg_
 = "MidiInCore::initialize:ƒrror creating OS-X MIDI client object.";

581 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

586 
CÜeMidiD©a
 *
d©a
 = (CÜeMidiD©¨*è
Ãw
 CoreMidiData;

587 
d©a
->
ş›Á
 = client;

588 
d©a
->
’dpošt
 = 0;

589 
­iD©a_
 = (*è
d©a
;

590 
šputD©a_
.
­iD©a
 = (*è
d©a
;

591 
	`CFR–—£
(
Çme
);

592 
	}
}

594 
	gMidiInCÜe
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

596 iàĞ
cÚÃùed_
 ) {

597 
”rÜSŒšg_
 = "MidiInCore::openPort:‡ valid connection‡lreadyƒxists!";

598 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

602 
	`CFRunLoİRunInMode
Ğ
kCFRunLoİDeçuÉMode
, 0, 
çl£
 );

603 
nSrc
 = 
	`MIDIG‘Numb”OfSourûs
();

604 ià(
nSrc
 < 1) {

605 
”rÜSŒšg_
 = "MidiInCore::openPort:‚o MIDI input sources found!";

606 
	`”rÜ
Ğ
RtMidiE¼Ü
::
NO_DEVICES_FOUND
, 
”rÜSŒšg_
 );

610 iàĞ
pÜtNumb”
 >ğ
nSrc
 ) {

611 
¡d
::
o¡ršg¡»am
 
o¡
;

612 
o¡
 << "MidiInCÜe::İ’PÜt:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

613 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

614 
	`”rÜ
Ğ
RtMidiE¼Ü
::
INVALID_PARAMETER
, 
”rÜSŒšg_
 );

618 
MIDIPÜtRef
 
pÜt
;

619 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

620 
OSStus
 
»suÉ
 = 
	`MIDIIÅutPÜtC»©e
Ğ
d©a
->
ş›Á
,

621 
	`CFSŒšgC»©eW™hCSŒšg
Ğ
NULL
, 
pÜtName
.
	`c_¡r
(), 
kCFSŒšgEncodšgASCII
 ),

622 
midiIÅutC®lback
, (*)&
šputD©a_
, &
pÜt
 );

623 iàĞ
»suÉ
 !ğ
noE¼
 ) {

624 
	`MIDICl›ÁDi¥o£
Ğ
d©a
->
ş›Á
 );

625 
”rÜSŒšg_
 = "MidiInCore::openPort:ƒrror creating OS-X MIDI input…ort.";

626 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

631 
MIDIEndpoštRef
 
’dpošt
 = 
	`MIDIG‘Sourû
Ğ
pÜtNumb”
 );

632 iàĞ
’dpošt
 == 0 ) {

633 
	`MIDIPÜtDi¥o£
Ğ
pÜt
 );

634 
	`MIDICl›ÁDi¥o£
Ğ
d©a
->
ş›Á
 );

635 
”rÜSŒšg_
 = "MidiInCore::openPort:ƒrror getting MIDI input source„eference.";

636 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

641 
»suÉ
 = 
	`MIDIPÜtCÚÃùSourû
Ğ
pÜt
, 
’dpošt
, 
NULL
 );

642 iàĞ
»suÉ
 !ğ
noE¼
 ) {

643 
	`MIDIPÜtDi¥o£
Ğ
pÜt
 );

644 
	`MIDICl›ÁDi¥o£
Ğ
d©a
->
ş›Á
 );

645 
”rÜSŒšg_
 = "MidiInCore::openPort:ƒrror connecting OS-X MIDI input…ort.";

646 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

651 
d©a
->
pÜt
 =…ort;

653 
cÚÃùed_
 = 
Œue
;

654 
	}
}

656 
	gMidiInCÜe
 :: 
	$İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

658 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

661 
MIDIEndpoštRef
 
’dpošt
;

662 
OSStus
 
»suÉ
 = 
	`MIDIDe¡š©iÚC»©e
Ğ
d©a
->
ş›Á
,

663 
	`CFSŒšgC»©eW™hCSŒšg
Ğ
NULL
, 
pÜtName
.
	`c_¡r
(), 
kCFSŒšgEncodšgASCII
 ),

664 
midiIÅutC®lback
, (*)&
šputD©a_
, &
’dpošt
 );

665 iàĞ
»suÉ
 !ğ
noE¼
 ) {

666 
”rÜSŒšg_
 = "MidiInCore::openVirtualPort:ƒrror creating virtual OS-X MIDI destination.";

667 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

672 
d©a
->
’dpošt
 =ƒndpoint;

673 
	}
}

675 
	gMidiInCÜe
 :: 
	$şo£PÜt
( )

677 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

679 iàĞ
d©a
->
’dpošt
 ) {

680 
	`MIDIEndpoštDi¥o£
Ğ
d©a
->
’dpošt
 );

683 iàĞ
d©a
->
pÜt
 ) {

684 
	`MIDIPÜtDi¥o£
Ğ
d©a
->
pÜt
 );

687 
cÚÃùed_
 = 
çl£
;

688 
	}
}

690 
	gMidiInCÜe
 :: 
	$g‘PÜtCouÁ
()

692 
	`CFRunLoİRunInMode
Ğ
kCFRunLoİDeçuÉMode
, 0, 
çl£
 );

693  
	`MIDIG‘Numb”OfSourûs
();

694 
	}
}

698 
CFSŒšgRef
 
	$EndpoštName
Ğ
MIDIEndpoštRef
 
’dpošt
, 
boŞ
 
isEx‹º®
 )

700 
CFMubËSŒšgRef
 
»suÉ
 = 
	`CFSŒšgC»©eMubË
Ğ
NULL
, 0 );

701 
CFSŒšgRef
 
¡r
;

704 
¡r
 = 
NULL
;

705 
	`MIDIObjeùG‘SŒšgPrİ”ty
Ğ
’dpošt
, 
kMIDIPrİ”tyName
, &
¡r
 );

706 iàĞ
¡r
 !ğ
NULL
 ) {

707 
	`CFSŒšgAµ’d
Ğ
»suÉ
, 
¡r
 );

708 
	`CFR–—£
Ğ
¡r
 );

711 
MIDIEÁ™yRef
 
’t™y
 = 0;

712 
	`MIDIEndpoštG‘EÁ™y
Ğ
’dpošt
, &
’t™y
 );

713 iàĞ
’t™y
 == 0 )

715  
»suÉ
;

717 iàĞ
	`CFSŒšgG‘L’gth
Ğ
»suÉ
 ) == 0 ) {

719 
¡r
 = 
NULL
;

720 
	`MIDIObjeùG‘SŒšgPrİ”ty
Ğ
’t™y
, 
kMIDIPrİ”tyName
, &
¡r
 );

721 iàĞ
¡r
 !ğ
NULL
 ) {

722 
	`CFSŒšgAµ’d
Ğ
»suÉ
, 
¡r
 );

723 
	`CFR–—£
Ğ
¡r
 );

727 
MIDIDeviûRef
 
deviû
 = 0;

728 
	`MIDIEÁ™yG‘Deviû
Ğ
’t™y
, &
deviû
 );

729 iàĞ
deviû
 == 0 )

730  
»suÉ
;

732 
¡r
 = 
NULL
;

733 
	`MIDIObjeùG‘SŒšgPrİ”ty
Ğ
deviû
, 
kMIDIPrİ”tyName
, &
¡r
 );

734 iàĞ
	`CFSŒšgG‘L’gth
Ğ
»suÉ
 ) == 0 ) {

735 
	`CFR–—£
Ğ
»suÉ
 );

736  
¡r
;

738 iàĞ
¡r
 !ğ
NULL
 ) {

741 iàĞ
isEx‹º®
 && 
	`MIDIDeviûG‘Numb”OfEÁ™›s
Ğ
deviû
 ) < 2 ) {

742 
	`CFR–—£
Ğ
»suÉ
 );

743  
¡r
;

745 iàĞ
	`CFSŒšgG‘L’gth
Ğ
¡r
 ) == 0 ) {

746 
	`CFR–—£
Ğ
¡r
 );

747  
»suÉ
;

752 iàĞ
	`CFSŒšgCom·»W™hO±iÚs
Ğ
»suÉ
,

753 
¡r
 ,

754 
	`CFRªgeMake
(0, 
	`CFSŒšgG‘L’gth
Ğ
¡r
 ) ), 0 ) !ğ
kCFCom·»Equ®To
 ) {

756 iàĞ
	`CFSŒšgG‘L’gth
Ğ
»suÉ
 ) > 0 )

757 
	`CFSŒšgIn£¹
Ğ
»suÉ
, 0, 
	`CFSTR
(" ") );

758 
	`CFSŒšgIn£¹
Ğ
»suÉ
, 0, 
¡r
 );

760 
	`CFR–—£
Ğ
¡r
 );

763  
»suÉ
;

764 
	}
}

768 
CFSŒšgRef
 
	$CÚÃùedEndpoštName
Ğ
MIDIEndpoštRef
 
’dpošt
 )

770 
CFMubËSŒšgRef
 
»suÉ
 = 
	`CFSŒšgC»©eMubË
Ğ
NULL
, 0 );

771 
CFSŒšgRef
 
¡r
;

772 
OSStus
 
”r
;

773 
i
;

776 
CFD©aRef
 
cÚÃùiÚs
 = 
NULL
;

777 
nCÚÃùed
 = 0;

778 
boŞ
 
ªySŒšgs
 = 
çl£
;

779 
”r
 = 
	`MIDIObjeùG‘D©aPrİ”ty
Ğ
’dpošt
, 
kMIDIPrİ”tyCÚÃùiÚUniqueID
, &
cÚÃùiÚs
 );

780 iàĞ
cÚÃùiÚs
 !ğ
NULL
 ) {

783 
nCÚÃùed
 = 
	`CFD©aG‘L’gth
Ğ
cÚÃùiÚs
 ) / (
MIDIUniqueID
);

784 iàĞ
nCÚÃùed
 ) {

785 cÚ¡ 
SIÁ32
 *
pid
 = (cÚ¡ SIÁ32 *)(
	`CFD©aG‘By‹PŒ
(
cÚÃùiÚs
));

786  
i
=0; i<
nCÚÃùed
; ++i, ++
pid
 ) {

787 
MIDIUniqueID
 
id
 = 
	`EndŸnS32_BtoN
Ğ*
pid
 );

788 
MIDIObjeùRef
 
cÚnObjeù
;

789 
MIDIObjeùTy³
 
cÚnObjeùTy³
;

790 
”r
 = 
	`MIDIObjeùFšdByUniqueID
Ğ
id
, &
cÚnObjeù
, &
cÚnObjeùTy³
 );

791 iàĞ
”r
 =ğ
noE¼
 ) {

792 iàĞ
cÚnObjeùTy³
 =ğ
kMIDIObjeùTy³_Ex‹º®Sourû
 ||

793 
cÚnObjeùTy³
 =ğ
kMIDIObjeùTy³_Ex‹º®De¡š©iÚ
 ) {

795 
¡r
 = 
	`EndpoštName
Ğ(
MIDIEndpoštRef
)(
cÚnObjeù
), 
Œue
 );

798 
¡r
 = 
NULL
;

799 
	`MIDIObjeùG‘SŒšgPrİ”ty
Ğ
cÚnObjeù
, 
kMIDIPrİ”tyName
, &
¡r
 );

801 iàĞ
¡r
 !ğ
NULL
 ) {

802 iàĞ
ªySŒšgs
 )

803 
	`CFSŒšgAµ’d
Ğ
»suÉ
, 
	`CFSTR
(", ") );

804 
ªySŒšgs
 = 
Œue
;

805 
	`CFSŒšgAµ’d
Ğ
»suÉ
, 
¡r
 );

806 
	`CFR–—£
Ğ
¡r
 );

811 
	`CFR–—£
Ğ
cÚÃùiÚs
 );

813 iàĞ
ªySŒšgs
 )

814  
»suÉ
;

816 
	`CFR–—£
Ğ
»suÉ
 );

819  
	`EndpoštName
Ğ
’dpošt
, 
çl£
 );

820 
	}
}

822 
	g¡d
::
¡ršg
 
MidiInCÜe
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

824 
CFSŒšgRef
 
ÇmeRef
;

825 
MIDIEndpoštRef
 
pÜtRef
;

826 
Çme
[128];

828 
¡d
::
¡ršg
 
¡ršgName
;

829 
	`CFRunLoİRunInMode
Ğ
kCFRunLoİDeçuÉMode
, 0, 
çl£
 );

830 iàĞ
pÜtNumb”
 >ğ
	`MIDIG‘Numb”OfSourûs
() ) {

831 
¡d
::
o¡ršg¡»am
 
o¡
;

832 
o¡
 << "MidiInCÜe::g‘PÜtName:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

833 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

834 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

835  
¡ršgName
;

838 
pÜtRef
 = 
	`MIDIG‘Sourû
Ğ
pÜtNumb”
 );

839 
ÇmeRef
 = 
	`CÚÃùedEndpoštName
(
pÜtRef
);

840 
	`CFSŒšgG‘CSŒšg
Ğ
ÇmeRef
, 
Çme
, Òame), 
	`CFSŒšgG‘Sy¡emEncodšg
());

841 
	`CFR–—£
Ğ
ÇmeRef
 );

843  
¡ršgName
 = 
Çme
;

844 
	}
}

851 
	gMidiOutCÜe
 :: 
	$MidiOutCÜe
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 ) : 
	$MidiOutApi
()

853 
	`š™Ÿlize
Ğ
ş›ÁName
 );

854 
	}
}

856 
	gMidiOutCÜe
 :: ~
	$MidiOutCÜe
( )

859 
	`şo£PÜt
();

862 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

863 
	`MIDICl›ÁDi¥o£
Ğ
d©a
->
ş›Á
 );

864 iàĞ
d©a
->
’dpošt
 ) 
	`MIDIEndpoštDi¥o£
( data->endpoint );

865 
d–‘e
 
d©a
;

866 
	}
}

868 
	gMidiOutCÜe
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 )

871 
MIDICl›ÁRef
 
ş›Á
;

872 
CFSŒšgRef
 
Çme
 = 
	`CFSŒšgC»©eW™hCSŒšg
Ğ
NULL
, 
ş›ÁName
.
	`c_¡r
(), 
kCFSŒšgEncodšgASCII
 );

873 
OSStus
 
»suÉ
 = 
	`MIDICl›ÁC»©e
(
Çme
, 
NULL
, NULL, &
ş›Á
 );

874 iàĞ
»suÉ
 !ğ
noE¼
 ) {

875 
”rÜSŒšg_
 = "MidiOutCore::initialize:ƒrror creating OS-X MIDI client object.";

876 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

881 
CÜeMidiD©a
 *
d©a
 = (CÜeMidiD©¨*è
Ãw
 CoreMidiData;

882 
d©a
->
ş›Á
 = client;

883 
d©a
->
’dpošt
 = 0;

884 
­iD©a_
 = (*è
d©a
;

885 
	`CFR–—£
Ğ
Çme
 );

886 
	}
}

888 
	gMidiOutCÜe
 :: 
	$g‘PÜtCouÁ
()

890 
	`CFRunLoİRunInMode
Ğ
kCFRunLoİDeçuÉMode
, 0, 
çl£
 );

891  
	`MIDIG‘Numb”OfDe¡š©iÚs
();

892 
	}
}

894 
	g¡d
::
¡ršg
 
MidiOutCÜe
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

896 
CFSŒšgRef
 
ÇmeRef
;

897 
MIDIEndpoštRef
 
pÜtRef
;

898 
Çme
[128];

900 
¡d
::
¡ršg
 
¡ršgName
;

901 
	`CFRunLoİRunInMode
Ğ
kCFRunLoİDeçuÉMode
, 0, 
çl£
 );

902 iàĞ
pÜtNumb”
 >ğ
	`MIDIG‘Numb”OfDe¡š©iÚs
() ) {

903 
¡d
::
o¡ršg¡»am
 
o¡
;

904 
o¡
 << "MidiOutCÜe::g‘PÜtName:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

905 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

906 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

907  
¡ršgName
;

910 
pÜtRef
 = 
	`MIDIG‘De¡š©iÚ
Ğ
pÜtNumb”
 );

911 
ÇmeRef
 = 
	`CÚÃùedEndpoštName
(
pÜtRef
);

912 
	`CFSŒšgG‘CSŒšg
Ğ
ÇmeRef
, 
Çme
, Òame), 
	`CFSŒšgG‘Sy¡emEncodšg
());

913 
	`CFR–—£
Ğ
ÇmeRef
 );

915  
¡ršgName
 = 
Çme
;

916 
	}
}

918 
	gMidiOutCÜe
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

920 iàĞ
cÚÃùed_
 ) {

921 
”rÜSŒšg_
 = "MidiOutCore::openPort:‡ valid connection‡lreadyƒxists!";

922 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

926 
	`CFRunLoİRunInMode
Ğ
kCFRunLoİDeçuÉMode
, 0, 
çl£
 );

927 
nDe¡
 = 
	`MIDIG‘Numb”OfDe¡š©iÚs
();

928 ià(
nDe¡
 < 1) {

929 
”rÜSŒšg_
 = "MidiOutCore::openPort:‚o MIDI output destinations found!";

930 
	`”rÜ
Ğ
RtMidiE¼Ü
::
NO_DEVICES_FOUND
, 
”rÜSŒšg_
 );

934 iàĞ
pÜtNumb”
 >ğ
nDe¡
 ) {

935 
¡d
::
o¡ršg¡»am
 
o¡
;

936 
o¡
 << "MidiOutCÜe::İ’PÜt:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

937 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

938 
	`”rÜ
Ğ
RtMidiE¼Ü
::
INVALID_PARAMETER
, 
”rÜSŒšg_
 );

942 
MIDIPÜtRef
 
pÜt
;

943 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

944 
OSStus
 
»suÉ
 = 
	`MIDIOuutPÜtC»©e
Ğ
d©a
->
ş›Á
,

945 
	`CFSŒšgC»©eW™hCSŒšg
Ğ
NULL
, 
pÜtName
.
	`c_¡r
(), 
kCFSŒšgEncodšgASCII
 ),

946 &
pÜt
 );

947 iàĞ
»suÉ
 !ğ
noE¼
 ) {

948 
	`MIDICl›ÁDi¥o£
Ğ
d©a
->
ş›Á
 );

949 
”rÜSŒšg_
 = "MidiOutCore::openPort:ƒrror creating OS-X MIDI output…ort.";

950 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

955 
MIDIEndpoštRef
 
de¡š©iÚ
 = 
	`MIDIG‘De¡š©iÚ
Ğ
pÜtNumb”
 );

956 iàĞ
de¡š©iÚ
 == 0 ) {

957 
	`MIDIPÜtDi¥o£
Ğ
pÜt
 );

958 
	`MIDICl›ÁDi¥o£
Ğ
d©a
->
ş›Á
 );

959 
”rÜSŒšg_
 = "MidiOutCore::openPort:ƒrror getting MIDI output destination„eference.";

960 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

965 
d©a
->
pÜt
 =…ort;

966 
d©a
->
de¡š©iÚId
 = 
de¡š©iÚ
;

967 
cÚÃùed_
 = 
Œue
;

968 
	}
}

970 
	gMidiOutCÜe
 :: 
	$şo£PÜt
( )

972 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

974 iàĞ
d©a
->
’dpošt
 ) {

975 
	`MIDIEndpoštDi¥o£
Ğ
d©a
->
’dpošt
 );

978 iàĞ
d©a
->
pÜt
 ) {

979 
	`MIDIPÜtDi¥o£
Ğ
d©a
->
pÜt
 );

982 
cÚÃùed_
 = 
çl£
;

983 
	}
}

985 
	gMidiOutCÜe
 :: 
	$İ’Vœtu®PÜt
Ğ
¡d
::
¡ršg
 
pÜtName
 )

987 
CÜeMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

989 iàĞ
d©a
->
’dpošt
 ) {

990 
”rÜSŒšg_
 = "MidiOutCore::openVirtualPort:‡ virtual output…ort‡lreadyƒxists!";

991 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

996 
MIDIEndpoštRef
 
’dpošt
;

997 
OSStus
 
»suÉ
 = 
	`MIDISourûC»©e
Ğ
d©a
->
ş›Á
,

998 
	`CFSŒšgC»©eW™hCSŒšg
Ğ
NULL
, 
pÜtName
.
	`c_¡r
(), 
kCFSŒšgEncodšgASCII
 ),

999 &
’dpošt
 );

1000 iàĞ
»suÉ
 !ğ
noE¼
 ) {

1001 
”rÜSŒšg_
 = "MidiOutCore::initialize:ƒrror creating OS-X virtual MIDI source.";

1002 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1007 
d©a
->
’dpošt
 =ƒndpoint;

1008 
	}
}

1010 
	gMidiOutCÜe
 :: 
£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 )

1014 
nBy‹s
 = 
mes§ge
->
size
();

1015 iàĞ
	gnBy‹s
 == 0 ) {

1016 
”rÜSŒšg_
 = "MidiOutCore::sendMessage:‚o data in message‡rgument!";

1017 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1021 
MIDITimeSmp
 
	gtimeSmp
 = 
AudioG‘Cu¼’tHo¡Time
();

1022 
CÜeMidiD©a
 *
	gd©a
 = 
¡©ic_ÿ¡
<CÜeMidiD©¨*> (
­iD©a_
);

1023 
OSStus
 
	g»suÉ
;

1025 iàĞ
	gmes§ge
->
©
(0è!ğ0xF0 && 
nBy‹s
 > 3 ) {

1026 
”rÜSŒšg_
 = "MidiOutCore::sendMessage: message format…roblem ...‚ot sysex but > 3 bytes?";

1027 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1031 
By‹
 
	gbufãr
[
nBy‹s
+((
MIDIPack‘Li¡
))];

1032 
By‹CouÁ
 
	gli¡Size
 = (
bufãr
);

1033 
MIDIPack‘Li¡
 *
	g·ck‘Li¡
 = (MIDIPack‘Li¡*)
bufãr
;

1034 
MIDIPack‘
 *
	g·ck‘
 = 
MIDIPack‘Li¡In™
Ğ
·ck‘Li¡
 );

1036 
By‹CouÁ
 
	g»maššgBy‹s
 = 
nBy‹s
;

1037 
	g»maššgBy‹s
 && 
	g·ck‘
) {

1038 
By‹CouÁ
 
	gby‹sFÜPack‘
 = 
»maššgBy‹s
 > 65535 ? 65535 :„emainingBytes;

1039 cÚ¡ 
By‹
* 
	gd©aS¹PŒ
 = (cÚ¡ By‹ *è&
mes§ge
->
©
Ğ
nBy‹s
 - 
»maššgBy‹s
 );

1040 
	g·ck‘
 = 
MIDIPack‘Li¡Add
Ğ
·ck‘Li¡
, 
li¡Size
, 
·ck‘
, 
timeSmp
, 
by‹sFÜPack‘
, 
d©aS¹PŒ
);

1041 
	g»maššgBy‹s
 -ğ
by‹sFÜPack‘
;

1044 iàĞ!
	g·ck‘
 ) {

1045 
	g”rÜSŒšg_
 = "MidiOutCore::sendMessage: could‚ot‡llocate…acket†ist";

1046 
”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1051 iàĞ
	gd©a
->
	g’dpošt
 ) {

1052 
	g»suÉ
 = 
MIDIReûived
Ğ
d©a
->
’dpošt
, 
·ck‘Li¡
 );

1053 iàĞ
	g»suÉ
 !ğ
noE¼
 ) {

1054 
”rÜSŒšg_
 = "MidiOutCore::sendMessage:ƒrror sending MIDIo virtual destinations.";

1055 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1060 iàĞ
	gcÚÃùed_
 ) {

1061 
	g»suÉ
 = 
MIDIS’d
Ğ
d©a
->
pÜt
, d©a->
de¡š©iÚId
, 
·ck‘Li¡
 );

1062 iàĞ
	g»suÉ
 !ğ
noE¼
 ) {

1063 
”rÜSŒšg_
 = "MidiOutCore::sendMessage:ƒrror sending MIDI messageo…ort.";

1064 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1079 #ià
defšed
(
__LINUX_ALSA__
)

1091 
	~<±h»ad.h
>

1092 
	~<sys/time.h
>

1095 
	~<®§/asoundlib.h
>

1099 
	sAl§MidiD©a
 {

1100 
¢d_£q_t
 *
	m£q
;

1101 
	mpÜtNum
;

1102 
	mvpÜt
;

1103 
¢d_£q_pÜt_subsüibe_t
 *
	msubsütiÚ
;

1104 
¢d_midi_ev’t_t
 *
	mcod”
;

1105 
	mbufãrSize
;

1106 *
	mbufãr
;

1107 
±h»ad_t
 
	mth»ad
;

1108 
±h»ad_t
 
	mdummy_th»ad_id
;

1109 
	mÏ¡Time
;

1110 
	mqueue_id
;

1111 
	mŒigg”_fds
[2];

1114 
	#PORT_TYPE
Ğ
pšfo
, 
b™s
 ) ((
	`¢d_£q_pÜt_šfo_g‘_ÿ·b™y
Õšfoè& (b™s)è=ğ(b™s))

	)

1121 *
	$®§MidiHªdËr
Ğ*
±r
 )

1123 
MidiInApi
::
RtMidiInD©a
 *
d©a
 = 
¡©ic_ÿ¡
<MidiInApi::RtMidiInD©¨*> (
±r
);

1124 
Al§MidiD©a
 *
­iD©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
d©a
->apiData);

1126 
nBy‹s
;

1127 
time
, 
Ï¡Time
;

1128 
boŞ
 
cÚtšueSy£x
 = 
çl£
;

1129 
boŞ
 
doDecode
 = 
çl£
;

1130 
MidiInApi
::
MidiMes§ge
 
mes§ge
;

1131 
pŞl_fd_couÁ
;

1132 
pŞlfd
 *
pŞl_fds
;

1134 
¢d_£q_ev’t_t
 *
ev
;

1135 
»suÉ
;

1136 
­iD©a
->
bufãrSize
 = 32;

1137 
»suÉ
 = 
	`¢d_midi_ev’t_Ãw
Ğ0, &
­iD©a
->
cod”
 );

1138 iàĞ
»suÉ
 < 0 ) {

1139 
d©a
->
doIÅut
 = 
çl£
;

1140 
¡d
::
û¼
 << "\nMidiInAlsa::alsaMidiHandler:ƒrror initializing MIDIƒvent…arser!\n\n";

1143 *
bufãr
 = (*è
	`m®loc
Ğ
­iD©a
->
bufãrSize
 );

1144 iàĞ
bufãr
 =ğ
NULL
 ) {

1145 
d©a
->
doIÅut
 = 
çl£
;

1146 
	`¢d_midi_ev’t_ä“
Ğ
­iD©a
->
cod”
 );

1147 
­iD©a
->
cod”
 = 0;

1148 
¡d
::
û¼
 << "\nMidiInAlsa::alsaMidiHandler:ƒrror initializing buffer memory!\n\n";

1151 
	`¢d_midi_ev’t_š™
Ğ
­iD©a
->
cod”
 );

1152 
	`¢d_midi_ev’t_no_¡©us
Ğ
­iD©a
->
cod”
, 1 );

1154 
pŞl_fd_couÁ
 = 
	`¢d_£q_pŞl_desütÜs_couÁ
Ğ
­iD©a
->
£q
, 
POLLIN
 ) + 1;

1155 
pŞl_fds
 = (
pŞlfd
*)
	`®loÿ
Ğ
pŞl_fd_couÁ
 * ( pollfd ));

1156 
	`¢d_£q_pŞl_desütÜs
Ğ
­iD©a
->
£q
, 
pŞl_fds
 + 1, 
pŞl_fd_couÁ
 - 1, 
POLLIN
 );

1157 
pŞl_fds
[0].
fd
 = 
­iD©a
->
Œigg”_fds
[0];

1158 
pŞl_fds
[0].
ev’ts
 = 
POLLIN
;

1160  
d©a
->
doIÅut
 ) {

1162 iàĞ
	`¢d_£q_ev’t_šput_³ndšg
Ğ
­iD©a
->
£q
, 1 ) == 0 ) {

1164 iàĞ
	`pŞl
Ğ
pŞl_fds
, 
pŞl_fd_couÁ
, -1) >= 0 ) {

1165 iàĞ
pŞl_fds
[0].
»v’ts
 & 
POLLIN
 ) {

1166 
boŞ
 
dummy
;

1167 
»s
 = 
	`»ad
Ğ
pŞl_fds
[0].
fd
, &
dummy
, (dummy) );

1168 (è
»s
;

1175 
»suÉ
 = 
	`¢d_£q_ev’t_šput
Ğ
­iD©a
->
£q
, &
ev
 );

1176 iàĞ
»suÉ
 =ğ-
ENOSPC
 ) {

1177 
¡d
::
û¼
 << "\nMidiInAlsa::alsaMidiHandler: MIDI input buffer overrun!\n\n";

1180 iàĞ
»suÉ
 <= 0 ) {

1181 
¡d
::
û¼
 << "\nMidiInAlsa::alsaMidiHandler: unknown MIDI inputƒrror!\n";

1182 
	`³¼Ü
("System„eports");

1188 iàĞ!
cÚtšueSy£x
 ) 
mes§ge
.
by‹s
.
	`ş—r
();

1190 
doDecode
 = 
çl£
;

1191  
ev
->
ty³
 ) {

1193 
SND_SEQ_EVENT_PORT_SUBSCRIBED
:

1194 #ià
	`defšed
(
__RTMIDI_DEBUG__
)

1195 
¡d
::
cout
 << "MidiInAlsa::alsaMidiHandler:…ort connection made!\n";

1199 
SND_SEQ_EVENT_PORT_UNSUBSCRIBED
:

1200 #ià
	`defšed
(
__RTMIDI_DEBUG__
)

1201 
¡d
::
û¼
 << "MidiInAlsa::alsaMidiHandler:…ort connection has closed!\n";

1202 
¡d
::
cout
 << "£nd” = " << (è
ev
->
d©a
.
cÚÃù
.
£nd”
.
ş›Á
 << ":"

1203 << (è
ev
->
d©a
.
cÚÃù
.
£nd”
.
pÜt


1204 << ", de¡ = " << (è
ev
->
d©a
.
cÚÃù
.
de¡
.
ş›Á
 << ":"

1205 << (è
ev
->
d©a
.
cÚÃù
.
de¡
.
pÜt


1206 << 
¡d
::
’dl
;

1210 
SND_SEQ_EVENT_QFRAME
:

1211 iàĞ!Ğ
d©a
->
ignÜeFÏgs
 & 0x02 ) ) 
doDecode
 = 
Œue
;

1214 
SND_SEQ_EVENT_TICK
:

1215 iàĞ!Ğ
d©a
->
ignÜeFÏgs
 & 0x02 ) ) 
doDecode
 = 
Œue
;

1218 
SND_SEQ_EVENT_CLOCK
:

1219 iàĞ!Ğ
d©a
->
ignÜeFÏgs
 & 0x02 ) ) 
doDecode
 = 
Œue
;

1222 
SND_SEQ_EVENT_SENSING
:

1223 iàĞ!Ğ
d©a
->
ignÜeFÏgs
 & 0x04 ) ) 
doDecode
 = 
Œue
;

1226 
SND_SEQ_EVENT_SYSEX
:

1227 iàĞ(
d©a
->
ignÜeFÏgs
 & 0x01) ) ;

1228 iàĞ
ev
->
d©a
.
ext
.
Ën
 > 
­iD©a
->
bufãrSize
 ) {

1229 
­iD©a
->
bufãrSize
 = 
ev
->
d©a
.
ext
.
Ën
;

1230 
	`ä“
Ğ
bufãr
 );

1231 
bufãr
 = (*è
	`m®loc
Ğ
­iD©a
->
bufãrSize
 );

1232 iàĞ
bufãr
 =ğ
NULL
 ) {

1233 
d©a
->
doIÅut
 = 
çl£
;

1234 
¡d
::
û¼
 << "\nMidiInAlsa::alsaMidiHandler:ƒrror„esizing buffer memory!\n\n";

1240 
doDecode
 = 
Œue
;

1243 iàĞ
doDecode
 ) {

1245 
nBy‹s
 = 
	`¢d_midi_ev’t_decode
Ğ
­iD©a
->
cod”
, 
bufãr
,‡piD©a->
bufãrSize
, 
ev
 );

1246 iàĞ
nBy‹s
 > 0 ) {

1252 iàĞ!
cÚtšueSy£x
 )

1253 
mes§ge
.
by‹s
.
	`assign
Ğ
bufãr
, &bufãr[
nBy‹s
] );

1255 
mes§ge
.
by‹s
.
	`š£¹
Ğmes§ge.by‹s.
	`’d
(), 
bufãr
, &bufãr[
nBy‹s
] );

1257 
cÚtšueSy£x
 = ( ( 
ev
->
ty³
 =ğ
SND_SEQ_EVENT_SYSEX
 ) && ( 
mes§ge
.
by‹s
.
	`back
() != 0xF7 ) );

1258 iàĞ!
cÚtšueSy£x
 ) {

1261 
mes§ge
.
timeSmp
 = 0.0;

1269 
time
 = ( 
ev
->time.time.
tv_£c
 * 1000000 ) + (ƒv->time.time.
tv_n£c
/1000 );

1270 
Ï¡Time
 = 
time
;

1271 
time
 -ğ
­iD©a
->
Ï¡Time
;

1272 
­iD©a
->
Ï¡Time
 =†astTime;

1273 iàĞ
d©a
->
fœ¡Mes§ge
 =ğ
Œue
 )

1274 
d©a
->
fœ¡Mes§ge
 = 
çl£
;

1276 
mes§ge
.
timeSmp
 = 
time
 * 0.000001;

1279 #ià
	`defšed
(
__RTMIDI_DEBUG__
)

1280 
¡d
::
û¼
 << "\nMidiInAlsa::alsaMidiHandler:ƒvent…arsingƒrror or‚ot‡ MIDIƒvent!\n\n";

1286 
	`¢d_£q_ä“_ev’t
Ğ
ev
 );

1287 iàĞ
mes§ge
.
by‹s
.
	`size
(è=ğ0 || 
cÚtšueSy£x
 ) ;

1289 iàĞ
d©a
->
usšgC®lback
 ) {

1290 
RtMidiIn
::
RtMidiC®lback
 
ÿÎback
 = (RtMidiIn::RtMidiC®lbackè
d©a
->
u£rC®lback
;

1291 
	`ÿÎback
Ğ
mes§ge
.
timeSmp
, &mes§ge.
by‹s
, 
d©a
->
u£rD©a
 );

1295 iàĞ
d©a
->
queue
.
size
 < d©a->queue.
ršgSize
 ) {

1296 
d©a
->
queue
.
ršg
[d©a->queue.
back
++] = 
mes§ge
;

1297 iàĞ
d©a
->
queue
.
back
 =ğd©a->queue.
ršgSize
 )

1298 
d©a
->
queue
.
back
 = 0;

1299 
d©a
->
queue
.
size
++;

1302 
¡d
::
û¼
 << "\nMidiInAlsa: message queue†imit„eached!!\n\n";

1306 iàĞ
bufãr
 ) 
	`ä“
( buffer );

1307 
	`¢d_midi_ev’t_ä“
Ğ
­iD©a
->
cod”
 );

1308 
­iD©a
->
cod”
 = 0;

1309 
­iD©a
->
th»ad
 =‡piD©a->
dummy_th»ad_id
;

1311 
	}
}

1313 
	gMidiInAl§
 :: 
	$MidiInAl§
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 ) : 
	$MidiInApi
Ğ
queueSizeLim™
 )

1315 
	`š™Ÿlize
Ğ
ş›ÁName
 );

1316 
	}
}

1318 
	gMidiInAl§
 :: ~
	$MidiInAl§
()

1321 
	`şo£PÜt
();

1324 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1325 iàĞ
šputD©a_
.
doIÅut
 ) {

1326 
šputD©a_
.
doIÅut
 = 
çl£
;

1327 
»s
 = 
	`wr™e
Ğ
d©a
->
Œigg”_fds
[1], &
šputD©a_
.
doIÅut
, (inputData_.doInput) );

1328 (è
»s
;

1329 iàĞ!
	`±h»ad_equ®
(
d©a
->
th»ad
, d©a->
dummy_th»ad_id
) )

1330 
	`±h»ad_još
Ğ
d©a
->
th»ad
, 
NULL
 );

1334 
	`şo£
 ( 
d©a
->
Œigg”_fds
[0] );

1335 
	`şo£
 ( 
d©a
->
Œigg”_fds
[1] );

1336 iàĞ
d©a
->
vpÜt
 >ğ0 ) 
	`¢d_£q_d–‘e_pÜt
Ğd©a->
£q
, data->vport );

1337 #iâdeà
AVOID_TIMESTAMPING


1338 
	`¢d_£q_ä“_queue
Ğ
d©a
->
£q
, d©a->
queue_id
 );

1340 
	`¢d_£q_şo£
Ğ
d©a
->
£q
 );

1341 
d–‘e
 
d©a
;

1342 
	}
}

1344 
	gMidiInAl§
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 )

1347 
¢d_£q_t
 *
£q
;

1348 
»suÉ
 = 
	`¢d_£q_İ’
(&
£q
, "deçuÉ", 
SND_SEQ_OPEN_DUPLEX
, 
SND_SEQ_NONBLOCK
);

1349 iàĞ
»suÉ
 < 0 ) {

1350 
”rÜSŒšg_
 = "MidiInAlsa::initialize:ƒrror creating ALSA sequencer client object.";

1351 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1356 
	`¢d_£q_£t_ş›Á_Çme
Ğ
£q
, 
ş›ÁName
.
	`c_¡r
() );

1359 
Al§MidiD©a
 *
d©a
 = (Al§MidiD©¨*è
Ãw
 AlsaMidiData;

1360 
d©a
->
£q
 = seq;

1361 
d©a
->
pÜtNum
 = -1;

1362 
d©a
->
vpÜt
 = -1;

1363 
d©a
->
subsütiÚ
 = 0;

1364 
d©a
->
dummy_th»ad_id
 = 
	`±h»ad_£lf
();

1365 
d©a
->
th»ad
 = d©a->
dummy_th»ad_id
;

1366 
d©a
->
Œigg”_fds
[0] = -1;

1367 
d©a
->
Œigg”_fds
[1] = -1;

1368 
­iD©a_
 = (*è
d©a
;

1369 
šputD©a_
.
­iD©a
 = (*è
d©a
;

1371 iàĞ
	`pe
(
d©a
->
Œigg”_fds
) == -1 ) {

1372 
”rÜSŒšg_
 = "MidiInAlsa::initialize:ƒrror creating…ipe objects.";

1373 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1378 #iâdeà
AVOID_TIMESTAMPING


1379 
d©a
->
queue_id
 = 
	`¢d_£q_®loc_Çmed_queue
(
£q
, "RtMidi Queue");

1381 
¢d_£q_queue_‹mpo_t
 *
q‹mpo
;

1382 
	`¢d_£q_queue_‹mpo_®loÿ
(&
q‹mpo
);

1383 
	`¢d_£q_queue_‹mpo_£t_‹mpo
(
q‹mpo
, 600000);

1384 
	`¢d_£q_queue_‹mpo_£t_µq
(
q‹mpo
, 240);

1385 
	`¢d_£q_£t_queue_‹mpo
(
d©a
->
£q
, d©a->
queue_id
, 
q‹mpo
);

1386 
	`¢d_£q_d¿š_ouut
(
d©a
->
£q
);

1388 
	}
}

1391 
	$pÜtInfo
Ğ
¢d_£q_t
 *
£q
, 
¢d_£q_pÜt_šfo_t
 *
pšfo
, 
ty³
, 
pÜtNumb”
 )

1393 
¢d_£q_ş›Á_šfo_t
 *
cšfo
;

1394 
ş›Á
;

1395 
couÁ
 = 0;

1396 
	`¢d_£q_ş›Á_šfo_®loÿ
Ğ&
cšfo
 );

1398 
	`¢d_£q_ş›Á_šfo_£t_ş›Á
Ğ
cšfo
, -1 );

1399  
	`¢d_£q_qu”y_Ãxt_ş›Á
Ğ
£q
, 
cšfo
 ) >= 0 ) {

1400 
ş›Á
 = 
	`¢d_£q_ş›Á_šfo_g‘_ş›Á
Ğ
cšfo
 );

1401 iàĞ
ş›Á
 == 0 ) ;

1403 
	`¢d_£q_pÜt_šfo_£t_ş›Á
Ğ
pšfo
, 
ş›Á
 );

1404 
	`¢d_£q_pÜt_šfo_£t_pÜt
Ğ
pšfo
, -1 );

1405  
	`¢d_£q_qu”y_Ãxt_pÜt
Ğ
£q
, 
pšfo
 ) >= 0 ) {

1406 
©yp
 = 
	`¢d_£q_pÜt_šfo_g‘_ty³
Ğ
pšfo
 );

1407 iàĞĞĞ
©yp
 & 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
 ) == 0 ) &&

1408 ĞĞ
©yp
 & 
SND_SEQ_PORT_TYPE_SYNTH
 ) == 0 ) ) ;

1409 
ÿps
 = 
	`¢d_£q_pÜt_šfo_g‘_ÿ·b™y
Ğ
pšfo
 );

1410 iàĞĞ
ÿps
 & 
ty³
 ) !=ype ) ;

1411 iàĞ
couÁ
 =ğ
pÜtNumb”
 )  1;

1412 ++
couÁ
;

1417 iàĞ
pÜtNumb”
 < 0 )  
couÁ
;

1419 
	}
}

1421 
	gMidiInAl§
 :: 
	$g‘PÜtCouÁ
()

1423 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

1424 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
pšfo
 );

1426 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1427  
	`pÜtInfo
Ğ
d©a
->
£q
, 
pšfo
, 
SND_SEQ_PORT_CAP_READ
|
SND_SEQ_PORT_CAP_SUBS_READ
, -1 );

1428 
	}
}

1430 
	g¡d
::
¡ršg
 
MidiInAl§
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

1432 
¢d_£q_ş›Á_šfo_t
 *
cšfo
;

1433 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

1434 
	`¢d_£q_ş›Á_šfo_®loÿ
Ğ&
cšfo
 );

1435 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
pšfo
 );

1437 
¡d
::
¡ršg
 
¡ršgName
;

1438 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1439 iàĞ
	`pÜtInfo
Ğ
d©a
->
£q
, 
pšfo
, 
SND_SEQ_PORT_CAP_READ
|
SND_SEQ_PORT_CAP_SUBS_READ
, (è
pÜtNumb”
 ) ) {

1440 
úum
 = 
	`¢d_£q_pÜt_šfo_g‘_ş›Á
Ğ
pšfo
 );

1441 
	`¢d_£q_g‘_ªy_ş›Á_šfo
Ğ
d©a
->
£q
, 
úum
, 
cšfo
 );

1442 
¡d
::
o¡ršg¡»am
 
os
;

1443 
os
 << 
	`¢d_£q_ş›Á_šfo_g‘_Çme
Ğ
cšfo
 );

1444 
os
 << " ";

1445 
os
 << 
	`¢d_£q_pÜt_šfo_g‘_ş›Á
Ğ
pšfo
 );

1446 
os
 << ":";

1447 
os
 << 
	`¢d_£q_pÜt_šfo_g‘_pÜt
Ğ
pšfo
 );

1448 
¡ršgName
 = 
os
.
	`¡r
();

1449  
¡ršgName
;

1453 
”rÜSŒšg_
 = "MidiInAlsa::getPortName:ƒrror†ooking for…ort‚ame!";

1454 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1455  
¡ršgName
;

1456 
	}
}

1458 
	gMidiInAl§
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

1460 iàĞ
cÚÃùed_
 ) {

1461 
”rÜSŒšg_
 = "MidiInAlsa::openPort:‡ valid connection‡lreadyƒxists!";

1462 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1466 
nSrc
 = 
this
->
	`g‘PÜtCouÁ
();

1467 iàĞ
nSrc
 < 1 ) {

1468 
”rÜSŒšg_
 = "MidiInAlsa::openPort:‚o MIDI input sources found!";

1469 
	`”rÜ
Ğ
RtMidiE¼Ü
::
NO_DEVICES_FOUND
, 
”rÜSŒšg_
 );

1473 
¢d_£q_pÜt_šfo_t
 *
¤c_pšfo
;

1474 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
¤c_pšfo
 );

1475 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1476 iàĞ
	`pÜtInfo
Ğ
d©a
->
£q
, 
¤c_pšfo
, 
SND_SEQ_PORT_CAP_READ
|
SND_SEQ_PORT_CAP_SUBS_READ
, (è
pÜtNumb”
 ) == 0 ) {

1477 
¡d
::
o¡ršg¡»am
 
o¡
;

1478 
o¡
 << "MidiInAl§::İ’PÜt:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

1479 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

1480 
	`”rÜ
Ğ
RtMidiE¼Ü
::
INVALID_PARAMETER
, 
”rÜSŒšg_
 );

1484 
¢d_£q_addr_t
 
£nd”
, 
»ûiv”
;

1485 
£nd”
.
ş›Á
 = 
	`¢d_£q_pÜt_šfo_g‘_ş›Á
Ğ
¤c_pšfo
 );

1486 
£nd”
.
pÜt
 = 
	`¢d_£q_pÜt_šfo_g‘_pÜt
Ğ
¤c_pšfo
 );

1487 
»ûiv”
.
ş›Á
 = 
	`¢d_£q_ş›Á_id
Ğ
d©a
->
£q
 );

1489 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

1490 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
pšfo
 );

1491 iàĞ
d©a
->
vpÜt
 < 0 ) {

1492 
	`¢d_£q_pÜt_šfo_£t_ş›Á
Ğ
pšfo
, 0 );

1493 
	`¢d_£q_pÜt_šfo_£t_pÜt
Ğ
pšfo
, 0 );

1494 
	`¢d_£q_pÜt_šfo_£t_ÿ·b™y
Ğ
pšfo
,

1495 
SND_SEQ_PORT_CAP_WRITE
 |

1496 
SND_SEQ_PORT_CAP_SUBS_WRITE
 );

1497 
	`¢d_£q_pÜt_šfo_£t_ty³
Ğ
pšfo
,

1498 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
 |

1499 
SND_SEQ_PORT_TYPE_APPLICATION
 );

1500 
	`¢d_£q_pÜt_šfo_£t_midi_chªÃls
(
pšfo
, 16);

1501 #iâdeà
AVOID_TIMESTAMPING


1502 
	`¢d_£q_pÜt_šfo_£t_time¡ampšg
(
pšfo
, 1);

1503 
	`¢d_£q_pÜt_šfo_£t_time¡amp_»®
(
pšfo
, 1);

1504 
	`¢d_£q_pÜt_šfo_£t_time¡amp_queue
(
pšfo
, 
d©a
->
queue_id
);

1506 
	`¢d_£q_pÜt_šfo_£t_Çme
(
pšfo
, 
pÜtName
.
	`c_¡r
() );

1507 
d©a
->
vpÜt
 = 
	`¢d_£q_ü—‹_pÜt
(d©a->
£q
, 
pšfo
);

1509 iàĞ
d©a
->
vpÜt
 < 0 ) {

1510 
”rÜSŒšg_
 = "MidiInAlsa::openPort: ALSAƒrror creating input…ort.";

1511 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1514 
d©a
->
vpÜt
 = 
	`¢d_£q_pÜt_šfo_g‘_pÜt
(
pšfo
);

1517 
»ûiv”
.
pÜt
 = 
d©a
->
vpÜt
;

1519 iàĞ!
d©a
->
subsütiÚ
 ) {

1521 ià(
	`¢d_£q_pÜt_subsüibe_m®loc
Ğ&
d©a
->
subsütiÚ
 ) < 0) {

1522 
”rÜSŒšg_
 = "MidiInAlsa::openPort: ALSAƒrror‡llocation…ort subscription.";

1523 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1526 
	`¢d_£q_pÜt_subsüibe_£t_£nd”
(
d©a
->
subsütiÚ
, &
£nd”
);

1527 
	`¢d_£q_pÜt_subsüibe_£t_de¡
(
d©a
->
subsütiÚ
, &
»ûiv”
);

1528 iàĞ
	`¢d_£q_subsüibe_pÜt
(
d©a
->
£q
, d©a->
subsütiÚ
) ) {

1529 
	`¢d_£q_pÜt_subsüibe_ä“
Ğ
d©a
->
subsütiÚ
 );

1530 
d©a
->
subsütiÚ
 = 0;

1531 
”rÜSŒšg_
 = "MidiInAlsa::openPort: ALSAƒrror making…ort connection.";

1532 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1537 iàĞ
šputD©a_
.
doIÅut
 =ğ
çl£
 ) {

1539 #iâdeà
AVOID_TIMESTAMPING


1540 
	`¢d_£q_¡¬t_queue
Ğ
d©a
->
£q
, d©a->
queue_id
, 
NULL
 );

1541 
	`¢d_£q_d¿š_ouut
Ğ
d©a
->
£q
 );

1544 
±h»ad_©Œ_t
 
©Œ
;

1545 
	`±h»ad_©Œ_š™
(&
©Œ
);

1546 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

1547 
	`±h»ad_©Œ_£tschedpŞicy
(&
©Œ
, 
SCHED_OTHER
);

1549 
šputD©a_
.
doIÅut
 = 
Œue
;

1550 
”r
 = 
	`±h»ad_ü—‹
(&
d©a
->
th»ad
, &
©Œ
, 
®§MidiHªdËr
, &
šputD©a_
);

1551 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

1552 iàĞ
”r
 ) {

1553 
	`¢d_£q_unsubsüibe_pÜt
Ğ
d©a
->
£q
, d©a->
subsütiÚ
 );

1554 
	`¢d_£q_pÜt_subsüibe_ä“
Ğ
d©a
->
subsütiÚ
 );

1555 
d©a
->
subsütiÚ
 = 0;

1556 
šputD©a_
.
doIÅut
 = 
çl£
;

1557 
”rÜSŒšg_
 = "MidiInAlsa::openPort:ƒrror starting MIDI inputhread!";

1558 
	`”rÜ
Ğ
RtMidiE¼Ü
::
THREAD_ERROR
, 
”rÜSŒšg_
 );

1563 
cÚÃùed_
 = 
Œue
;

1564 
	}
}

1566 
	gMidiInAl§
 :: 
	$İ’Vœtu®PÜt
Ğ
¡d
::
¡ršg
 
pÜtName
 )

1568 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1569 iàĞ
d©a
->
vpÜt
 < 0 ) {

1570 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

1571 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
pšfo
 );

1572 
	`¢d_£q_pÜt_šfo_£t_ÿ·b™y
Ğ
pšfo
,

1573 
SND_SEQ_PORT_CAP_WRITE
 |

1574 
SND_SEQ_PORT_CAP_SUBS_WRITE
 );

1575 
	`¢d_£q_pÜt_šfo_£t_ty³
Ğ
pšfo
,

1576 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
 |

1577 
SND_SEQ_PORT_TYPE_APPLICATION
 );

1578 
	`¢d_£q_pÜt_šfo_£t_midi_chªÃls
(
pšfo
, 16);

1579 #iâdeà
AVOID_TIMESTAMPING


1580 
	`¢d_£q_pÜt_šfo_£t_time¡ampšg
(
pšfo
, 1);

1581 
	`¢d_£q_pÜt_šfo_£t_time¡amp_»®
(
pšfo
, 1);

1582 
	`¢d_£q_pÜt_šfo_£t_time¡amp_queue
(
pšfo
, 
d©a
->
queue_id
);

1584 
	`¢d_£q_pÜt_šfo_£t_Çme
(
pšfo
, 
pÜtName
.
	`c_¡r
());

1585 
d©a
->
vpÜt
 = 
	`¢d_£q_ü—‹_pÜt
(d©a->
£q
, 
pšfo
);

1587 iàĞ
d©a
->
vpÜt
 < 0 ) {

1588 
”rÜSŒšg_
 = "MidiInAlsa::openVirtualPort: ALSAƒrror creating virtual…ort.";

1589 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1592 
d©a
->
vpÜt
 = 
	`¢d_£q_pÜt_šfo_g‘_pÜt
(
pšfo
);

1595 iàĞ
šputD©a_
.
doIÅut
 =ğ
çl£
 ) {

1597 iàĞ!
	`±h»ad_equ®
(
d©a
->
th»ad
, d©a->
dummy_th»ad_id
) )

1598 
	`±h»ad_još
Ğ
d©a
->
th»ad
, 
NULL
 );

1601 #iâdeà
AVOID_TIMESTAMPING


1602 
	`¢d_£q_¡¬t_queue
Ğ
d©a
->
£q
, d©a->
queue_id
, 
NULL
 );

1603 
	`¢d_£q_d¿š_ouut
Ğ
d©a
->
£q
 );

1606 
±h»ad_©Œ_t
 
©Œ
;

1607 
	`±h»ad_©Œ_š™
(&
©Œ
);

1608 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

1609 
	`±h»ad_©Œ_£tschedpŞicy
(&
©Œ
, 
SCHED_OTHER
);

1611 
šputD©a_
.
doIÅut
 = 
Œue
;

1612 
”r
 = 
	`±h»ad_ü—‹
(&
d©a
->
th»ad
, &
©Œ
, 
®§MidiHªdËr
, &
šputD©a_
);

1613 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

1614 iàĞ
”r
 ) {

1615 iàĞ
d©a
->
subsütiÚ
 ) {

1616 
	`¢d_£q_unsubsüibe_pÜt
Ğ
d©a
->
£q
, d©a->
subsütiÚ
 );

1617 
	`¢d_£q_pÜt_subsüibe_ä“
Ğ
d©a
->
subsütiÚ
 );

1618 
d©a
->
subsütiÚ
 = 0;

1620 
šputD©a_
.
doIÅut
 = 
çl£
;

1621 
”rÜSŒšg_
 = "MidiInAlsa::openPort:ƒrror starting MIDI inputhread!";

1622 
	`”rÜ
Ğ
RtMidiE¼Ü
::
THREAD_ERROR
, 
”rÜSŒšg_
 );

1626 
	}
}

1628 
	gMidiInAl§
 :: 
	$şo£PÜt
( )

1630 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1632 iàĞ
cÚÃùed_
 ) {

1633 iàĞ
d©a
->
subsütiÚ
 ) {

1634 
	`¢d_£q_unsubsüibe_pÜt
Ğ
d©a
->
£q
, d©a->
subsütiÚ
 );

1635 
	`¢d_£q_pÜt_subsüibe_ä“
Ğ
d©a
->
subsütiÚ
 );

1636 
d©a
->
subsütiÚ
 = 0;

1639 #iâdeà
AVOID_TIMESTAMPING


1640 
	`¢d_£q_¡İ_queue
Ğ
d©a
->
£q
, d©a->
queue_id
, 
NULL
 );

1641 
	`¢d_£q_d¿š_ouut
Ğ
d©a
->
£q
 );

1643 
cÚÃùed_
 = 
çl£
;

1647 iàĞ
šputD©a_
.
doIÅut
 ) {

1648 
šputD©a_
.
doIÅut
 = 
çl£
;

1649 
»s
 = 
	`wr™e
Ğ
d©a
->
Œigg”_fds
[1], &
šputD©a_
.
doIÅut
, (inputData_.doInput) );

1650 (è
»s
;

1651 iàĞ!
	`±h»ad_equ®
(
d©a
->
th»ad
, d©a->
dummy_th»ad_id
) )

1652 
	`±h»ad_još
Ğ
d©a
->
th»ad
, 
NULL
 );

1654 
	}
}

1661 
	gMidiOutAl§
 :: 
	$MidiOutAl§
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 ) : 
	$MidiOutApi
()

1663 
	`š™Ÿlize
Ğ
ş›ÁName
 );

1664 
	}
}

1666 
	gMidiOutAl§
 :: ~
	$MidiOutAl§
()

1669 
	`şo£PÜt
();

1672 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1673 iàĞ
d©a
->
vpÜt
 >ğ0 ) 
	`¢d_£q_d–‘e_pÜt
Ğd©a->
£q
, data->vport );

1674 iàĞ
d©a
->
cod”
 ) 
	`¢d_midi_ev’t_ä“
( data->coder );

1675 iàĞ
d©a
->
bufãr
 ) 
	`ä“
( data->buffer );

1676 
	`¢d_£q_şo£
Ğ
d©a
->
£q
 );

1677 
d–‘e
 
d©a
;

1678 
	}
}

1680 
	gMidiOutAl§
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 )

1683 
¢d_£q_t
 *
£q
;

1684 
»suÉ1
 = 
	`¢d_£q_İ’
Ğ&
£q
, "deçuÉ", 
SND_SEQ_OPEN_OUTPUT
, 
SND_SEQ_NONBLOCK
 );

1685 iàĞ
»suÉ1
 < 0 ) {

1686 
”rÜSŒšg_
 = "MidiOutAlsa::initialize:ƒrror creating ALSA sequencer client object.";

1687 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1692 
	`¢d_£q_£t_ş›Á_Çme
Ğ
£q
, 
ş›ÁName
.
	`c_¡r
() );

1695 
Al§MidiD©a
 *
d©a
 = (Al§MidiD©¨*è
Ãw
 AlsaMidiData;

1696 
d©a
->
£q
 = seq;

1697 
d©a
->
pÜtNum
 = -1;

1698 
d©a
->
vpÜt
 = -1;

1699 
d©a
->
bufãrSize
 = 32;

1700 
d©a
->
cod”
 = 0;

1701 
d©a
->
bufãr
 = 0;

1702 
»suÉ
 = 
	`¢d_midi_ev’t_Ãw
Ğ
d©a
->
bufãrSize
, &d©a->
cod”
 );

1703 iàĞ
»suÉ
 < 0 ) {

1704 
d–‘e
 
d©a
;

1705 
”rÜSŒšg_
 = "MidiOutAlsa::initialize:ƒrror initializing MIDIƒvent…arser!\n\n";

1706 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1709 
d©a
->
bufãr
 = (*è
	`m®loc
Ğd©a->
bufãrSize
 );

1710 iàĞ
d©a
->
bufãr
 =ğ
NULL
 ) {

1711 
d–‘e
 
d©a
;

1712 
”rÜSŒšg_
 = "MidiOutAlsa::initialize:ƒrror‡llocating buffer memory!\n\n";

1713 
	`”rÜ
Ğ
RtMidiE¼Ü
::
MEMORY_ERROR
, 
”rÜSŒšg_
 );

1716 
	`¢d_midi_ev’t_š™
Ğ
d©a
->
cod”
 );

1717 
­iD©a_
 = (*è
d©a
;

1718 
	}
}

1720 
	gMidiOutAl§
 :: 
	$g‘PÜtCouÁ
()

1722 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

1723 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
pšfo
 );

1725 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1726  
	`pÜtInfo
Ğ
d©a
->
£q
, 
pšfo
, 
SND_SEQ_PORT_CAP_WRITE
|
SND_SEQ_PORT_CAP_SUBS_WRITE
, -1 );

1727 
	}
}

1729 
	g¡d
::
¡ršg
 
MidiOutAl§
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

1731 
¢d_£q_ş›Á_šfo_t
 *
cšfo
;

1732 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

1733 
	`¢d_£q_ş›Á_šfo_®loÿ
Ğ&
cšfo
 );

1734 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
pšfo
 );

1736 
¡d
::
¡ršg
 
¡ršgName
;

1737 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1738 iàĞ
	`pÜtInfo
Ğ
d©a
->
£q
, 
pšfo
, 
SND_SEQ_PORT_CAP_WRITE
|
SND_SEQ_PORT_CAP_SUBS_WRITE
, (è
pÜtNumb”
 ) ) {

1739 
úum
 = 
	`¢d_£q_pÜt_šfo_g‘_ş›Á
(
pšfo
);

1740 
	`¢d_£q_g‘_ªy_ş›Á_šfo
Ğ
d©a
->
£q
, 
úum
, 
cšfo
 );

1741 
¡d
::
o¡ršg¡»am
 
os
;

1742 
os
 << 
	`¢d_£q_ş›Á_šfo_g‘_Çme
(
cšfo
);

1743 
os
 << " ";

1744 
os
 << 
	`¢d_£q_pÜt_šfo_g‘_ş›Á
Ğ
pšfo
 );

1745 
os
 << ":";

1746 
os
 << 
	`¢d_£q_pÜt_šfo_g‘_pÜt
(
pšfo
);

1747 
¡ršgName
 = 
os
.
	`¡r
();

1748  
¡ršgName
;

1752 
”rÜSŒšg_
 = "MidiOutAlsa::getPortName:ƒrror†ooking for…ort‚ame!";

1753 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1754  
¡ršgName
;

1755 
	}
}

1757 
	gMidiOutAl§
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

1759 iàĞ
cÚÃùed_
 ) {

1760 
”rÜSŒšg_
 = "MidiOutAlsa::openPort:‡ valid connection‡lreadyƒxists!";

1761 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1765 
nSrc
 = 
this
->
	`g‘PÜtCouÁ
();

1766 ià(
nSrc
 < 1) {

1767 
”rÜSŒšg_
 = "MidiOutAlsa::openPort:‚o MIDI output sources found!";

1768 
	`”rÜ
Ğ
RtMidiE¼Ü
::
NO_DEVICES_FOUND
, 
”rÜSŒšg_
 );

1772 
¢d_£q_pÜt_šfo_t
 *
pšfo
;

1773 
	`¢d_£q_pÜt_šfo_®loÿ
Ğ&
pšfo
 );

1774 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1775 iàĞ
	`pÜtInfo
Ğ
d©a
->
£q
, 
pšfo
, 
SND_SEQ_PORT_CAP_WRITE
|
SND_SEQ_PORT_CAP_SUBS_WRITE
, (è
pÜtNumb”
 ) == 0 ) {

1776 
¡d
::
o¡ršg¡»am
 
o¡
;

1777 
o¡
 << "MidiOutAl§::İ’PÜt:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

1778 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

1779 
	`”rÜ
Ğ
RtMidiE¼Ü
::
INVALID_PARAMETER
, 
”rÜSŒšg_
 );

1783 
¢d_£q_addr_t
 
£nd”
, 
»ûiv”
;

1784 
»ûiv”
.
ş›Á
 = 
	`¢d_£q_pÜt_šfo_g‘_ş›Á
Ğ
pšfo
 );

1785 
»ûiv”
.
pÜt
 = 
	`¢d_£q_pÜt_šfo_g‘_pÜt
Ğ
pšfo
 );

1786 
£nd”
.
ş›Á
 = 
	`¢d_£q_ş›Á_id
Ğ
d©a
->
£q
 );

1788 iàĞ
d©a
->
vpÜt
 < 0 ) {

1789 
d©a
->
vpÜt
 = 
	`¢d_£q_ü—‹_sim¶e_pÜt
Ğd©a->
£q
, 
pÜtName
.
	`c_¡r
(),

1790 
SND_SEQ_PORT_CAP_READ
|
SND_SEQ_PORT_CAP_SUBS_READ
,

1791 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
|
SND_SEQ_PORT_TYPE_APPLICATION
 );

1792 iàĞ
d©a
->
vpÜt
 < 0 ) {

1793 
”rÜSŒšg_
 = "MidiOutAlsa::openPort: ALSAƒrror creating output…ort.";

1794 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1799 
£nd”
.
pÜt
 = 
d©a
->
vpÜt
;

1802 ià(
	`¢d_£q_pÜt_subsüibe_m®loc
Ğ&
d©a
->
subsütiÚ
 ) < 0) {

1803 
	`¢d_£q_pÜt_subsüibe_ä“
Ğ
d©a
->
subsütiÚ
 );

1804 
”rÜSŒšg_
 = "MidiOutAlsa::openPort:ƒrror‡llocating…ort subscription.";

1805 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1808 
	`¢d_£q_pÜt_subsüibe_£t_£nd”
(
d©a
->
subsütiÚ
, &
£nd”
);

1809 
	`¢d_£q_pÜt_subsüibe_£t_de¡
(
d©a
->
subsütiÚ
, &
»ûiv”
);

1810 
	`¢d_£q_pÜt_subsüibe_£t_time_upd©e
(
d©a
->
subsütiÚ
, 1);

1811 
	`¢d_£q_pÜt_subsüibe_£t_time_»®
(
d©a
->
subsütiÚ
, 1);

1812 iàĞ
	`¢d_£q_subsüibe_pÜt
(
d©a
->
£q
, d©a->
subsütiÚ
) ) {

1813 
	`¢d_£q_pÜt_subsüibe_ä“
Ğ
d©a
->
subsütiÚ
 );

1814 
”rÜSŒšg_
 = "MidiOutAlsa::openPort: ALSAƒrror making…ort connection.";

1815 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1819 
cÚÃùed_
 = 
Œue
;

1820 
	}
}

1822 
	gMidiOutAl§
 :: 
	$şo£PÜt
( )

1824 iàĞ
cÚÃùed_
 ) {

1825 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1826 
	`¢d_£q_unsubsüibe_pÜt
Ğ
d©a
->
£q
, d©a->
subsütiÚ
 );

1827 
	`¢d_£q_pÜt_subsüibe_ä“
Ğ
d©a
->
subsütiÚ
 );

1828 
cÚÃùed_
 = 
çl£
;

1830 
	}
}

1832 
	gMidiOutAl§
 :: 
	$İ’Vœtu®PÜt
Ğ
¡d
::
¡ršg
 
pÜtName
 )

1834 
Al§MidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1835 iàĞ
d©a
->
vpÜt
 < 0 ) {

1836 
d©a
->
vpÜt
 = 
	`¢d_£q_ü—‹_sim¶e_pÜt
Ğd©a->
£q
, 
pÜtName
.
	`c_¡r
(),

1837 
SND_SEQ_PORT_CAP_READ
|
SND_SEQ_PORT_CAP_SUBS_READ
,

1838 
SND_SEQ_PORT_TYPE_MIDI_GENERIC
|
SND_SEQ_PORT_TYPE_APPLICATION
 );

1840 iàĞ
d©a
->
vpÜt
 < 0 ) {

1841 
”rÜSŒšg_
 = "MidiOutAlsa::openVirtualPort: ALSAƒrror creating virtual…ort.";

1842 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1845 
	}
}

1847 
	gMidiOutAl§
 :: 
£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 )

1849 
»suÉ
;

1850 
Al§MidiD©a
 *
	gd©a
 = 
¡©ic_ÿ¡
<Al§MidiD©¨*> (
­iD©a_
);

1851 
	gnBy‹s
 = 
mes§ge
->
size
();

1852 iàĞ
	gnBy‹s
 > 
	gd©a
->
	gbufãrSize
 ) {

1853 
	gd©a
->
	gbufãrSize
 = 
nBy‹s
;

1854 
	g»suÉ
 = 
¢d_midi_ev’t_»size_bufãr
 ( 
d©a
->
cod”
, 
nBy‹s
);

1855 iàĞ
	g»suÉ
 != 0 ) {

1856 
”rÜSŒšg_
 = "MidiOutAlsa::sendMessage: ALSAƒrror„esizing MIDIƒvent buffer.";

1857 
”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

1860 
ä“
 (
d©a
->
bufãr
);

1861 
	gd©a
->
	gbufãr
 = (*è
m®loc
Ğ
d©a
->
bufãrSize
 );

1862 iàĞ
	gd©a
->
	gbufãr
 =ğ
NULL
 ) {

1863 
”rÜSŒšg_
 = "MidiOutAlsa::initialize:ƒrror‡llocating buffer memory!\n\n";

1864 
”rÜ
Ğ
RtMidiE¼Ü
::
MEMORY_ERROR
, 
”rÜSŒšg_
 );

1869 
¢d_£q_ev’t_t
 
	gev
;

1870 
¢d_£q_ev_ş—r
(&
ev
);

1871 
¢d_£q_ev_£t_sourû
(&
ev
, 
d©a
->
vpÜt
);

1872 
¢d_£q_ev_£t_subs
(&
ev
);

1873 
¢d_£q_ev_£t_dœeù
(&
ev
);

1874  
	gi
=0; i<
	gnBy‹s
; ++˜è
	gd©a
->
	gbufãr
[
i
] = 
mes§ge
->
©
(i);

1875 
	g»suÉ
 = 
¢d_midi_ev’t_’code
Ğ
d©a
->
cod”
, d©a->
bufãr
, ()
nBy‹s
, &
ev
 );

1876 iàĞ
	g»suÉ
 < ()
	gnBy‹s
 ) {

1877 
	g”rÜSŒšg_
 = "MidiOutAlsa::sendMessage:ƒvent…arsingƒrror!";

1878 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1883 
	g»suÉ
 = 
¢d_£q_ev’t_ouut
(
d©a
->
£q
, &
ev
);

1884 iàĞ
	g»suÉ
 < 0 ) {

1885 
	g”rÜSŒšg_
 = "MidiOutAlsa::sendMessage:ƒrror sending MIDI messageo…ort.";

1886 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

1889 
¢d_£q_d¿š_ouut
(
d©a
->
£q
);

1904 #ià
defšed
(
__WINDOWS_MM__
)

1911 
	~<wšdows.h
>

1912 
	~<mmsy¡em.h
>

1914 
	#RT_SYSEX_BUFFER_SIZE
 1024

	)

1915 
	#RT_SYSEX_BUFFER_COUNT
 4

	)

1919 
	sWšMidiD©a
 {

1920 
HMIDIIN
 
	mšHªdË
;

1921 
HMIDIOUT
 
	moutHªdË
;

1922 
DWORD
 
	mÏ¡Time
;

1923 
	mMidiInApi
::
MidiMes§ge
 
mes§ge
;

1924 
LPMIDIHDR
 
	msy£xBufãr
[
RT_SYSEX_BUFFER_COUNT
];

1925 
CRITICAL_SECTION
 
	m_mu‹x
;

1933 
CALLBACK
 
	$midiIÅutC®lback
Ğ
HMIDIIN
 ,

1934 
UINT
 
šputStus
,

1935 
DWORD_PTR
 
š¡ªûPŒ
,

1936 
DWORD_PTR
 
midiMes§ge
,

1937 
DWORD
 
time¡amp
 )

1939 iàĞ
šputStus
 !ğ
MIM_DATA
 && iÅutStu !ğ
MIM_LONGDATA
 && iÅutStu !ğ
MIM_LONGERROR
 ) ;

1942 
MidiInApi
::
RtMidiInD©a
 *
d©a
 = (MidiInApi::RtMidiInD©¨*)
š¡ªûPŒ
;

1943 
WšMidiD©a
 *
­iD©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
d©a
->apiData);

1946 iàĞ
d©a
->
fœ¡Mes§ge
 =ğ
Œue
 ) {

1947 
­iD©a
->
mes§ge
.
timeSmp
 = 0.0;

1948 
d©a
->
fœ¡Mes§ge
 = 
çl£
;

1950 
­iD©a
->
mes§ge
.
timeSmp
 = (èĞ
time¡amp
 -‡piD©a->
Ï¡Time
 ) * 0.001;

1951 
­iD©a
->
Ï¡Time
 = 
time¡amp
;

1953 iàĞ
šputStus
 =ğ
MIM_DATA
 ) {

1956 
¡©us
 = (è(
midiMes§ge
 & 0x000000FF);

1957 iàĞ!(
¡©us
 & 0x80) ) ;

1960 
nBy‹s
 = 1;

1961 iàĞ
¡©us
 < 0xC0 ) 
nBy‹s
 = 3;

1962 iàĞ
¡©us
 < 0xE0 ) 
nBy‹s
 = 2;

1963 iàĞ
¡©us
 < 0xF0 ) 
nBy‹s
 = 3;

1964 iàĞ
¡©us
 == 0xF1 ) {

1965 iàĞ
d©a
->
ignÜeFÏgs
 & 0x02 ) ;

1966 
nBy‹s
 = 2;

1968 iàĞ
¡©us
 =ğ0xF2 ) 
nBy‹s
 = 3;

1969 iàĞ
¡©us
 =ğ0xF3 ) 
nBy‹s
 = 2;

1970 iàĞ
¡©us
 =ğ0xF8 && (
d©a
->
ignÜeFÏgs
 & 0x02) ) {

1974 iàĞ
¡©us
 =ğ0xFE && (
d©a
->
ignÜeFÏgs
 & 0x04) ) {

1980 *
±r
 = (*è&
midiMes§ge
;

1981  
i
=0; i<
nBy‹s
; ++˜è
­iD©a
->
mes§ge
.
by‹s
.
	`push_back
Ğ*
±r
++ );

1984 
MIDIHDR
 *
sy£x
 = ( MIDIHDR *è
midiMes§ge
;

1985 iàĞ!Ğ
d©a
->
ignÜeFÏgs
 & 0x01 ) && 
šputStus
 !ğ
MIM_LONGERROR
 ) {

1987  
i
=0; i<()
sy£x
->
dwBy‹sRecÜded
; ++i )

1988 
­iD©a
->
mes§ge
.
by‹s
.
	`push_back
Ğ
sy£x
->
ÍD©a
[
i
] );

1999 iàĞ
­iD©a
->
sy£xBufãr
[
sy£x
->
dwU£r
]->
dwBy‹sRecÜded
 > 0 ) {

2001 
	`EÁ”Cr™iÿlSeùiÚ
Ğ&(
­iD©a
->
_mu‹x
) );

2002 
MMRESULT
 
»suÉ
 = 
	`midiInAddBufãr
Ğ
­iD©a
->
šHªdË
,‡piD©a->
sy£xBufãr
[
sy£x
->
dwU£r
], (
MIDIHDR
) );

2003 
	`L—veCr™iÿlSeùiÚ
Ğ&(
­iD©a
->
_mu‹x
) );

2004 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 )

2005 
¡d
::
û¼
 << "\nRtMidiIn::midiInputCallback:ƒrror sending sysexo Midi device!!\n\n";

2007 iàĞ
d©a
->
ignÜeFÏgs
 & 0x01 ) ;

2012 iàĞ
d©a
->
usšgC®lback
 ) {

2013 
RtMidiIn
::
RtMidiC®lback
 
ÿÎback
 = (RtMidiIn::RtMidiC®lbackè
d©a
->
u£rC®lback
;

2014 
	`ÿÎback
Ğ
­iD©a
->
mes§ge
.
timeSmp
, &­iD©a->mes§ge.
by‹s
, 
d©a
->
u£rD©a
 );

2018 iàĞ
d©a
->
queue
.
size
 < d©a->queue.
ršgSize
 ) {

2019 
d©a
->
queue
.
ršg
[d©a->queue.
back
++] = 
­iD©a
->
mes§ge
;

2020 iàĞ
d©a
->
queue
.
back
 =ğd©a->queue.
ršgSize
 )

2021 
d©a
->
queue
.
back
 = 0;

2022 
d©a
->
queue
.
size
++;

2025 
¡d
::
û¼
 << "\nRtMidiIn: message queue†imit„eached!!\n\n";

2029 
­iD©a
->
mes§ge
.
by‹s
.
	`ş—r
();

2030 
	}
}

2032 
	gMidiInWšMM
 :: 
	$MidiInWšMM
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 ) : 
	$MidiInApi
Ğ
queueSizeLim™
 )

2034 
	`š™Ÿlize
Ğ
ş›ÁName
 );

2035 
	}
}

2037 
	gMidiInWšMM
 :: ~
	$MidiInWšMM
()

2040 
	`şo£PÜt
();

2042 
WšMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
­iD©a_
);

2043 
	`D–‘eCr™iÿlSeùiÚ
Ğ&(
d©a
->
_mu‹x
) );

2046 
d–‘e
 
d©a
;

2047 
	}
}

2049 
	gMidiInWšMM
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& )

2053 
nDeviûs
 = 
	`midiInG‘NumDevs
();

2054 iàĞ
nDeviûs
 == 0 ) {

2055 
”rÜSŒšg_
 = "MidiInWinMM::initialize:‚o MIDI input devices currently‡vailable.";

2056 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2060 
WšMidiD©a
 *
d©a
 = (WšMidiD©¨*è
Ãw
 WinMidiData;

2061 
­iD©a_
 = (*è
d©a
;

2062 
šputD©a_
.
­iD©a
 = (*è
d©a
;

2063 
d©a
->
mes§ge
.
by‹s
.
	`ş—r
();

2065 iàĞ!
	`In™ŸlizeCr™iÿlSeùiÚAndSpšCouÁ
(&(
d©a
->
_mu‹x
), 0x00000400) ) {

2066 
”rÜSŒšg_
 = "MidiInWinMM::initialize: InitializeCriticalSectionAndSpinCount failed.";

2067 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2069 
	}
}

2071 
	gMidiInWšMM
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 )

2073 iàĞ
cÚÃùed_
 ) {

2074 
”rÜSŒšg_
 = "MidiInWinMM::openPort:‡ valid connection‡lreadyƒxists!";

2075 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2079 
nDeviûs
 = 
	`midiInG‘NumDevs
();

2080 ià(
nDeviûs
 == 0) {

2081 
”rÜSŒšg_
 = "MidiInWinMM::openPort:‚o MIDI input sources found!";

2082 
	`”rÜ
Ğ
RtMidiE¼Ü
::
NO_DEVICES_FOUND
, 
”rÜSŒšg_
 );

2086 iàĞ
pÜtNumb”
 >ğ
nDeviûs
 ) {

2087 
¡d
::
o¡ršg¡»am
 
o¡
;

2088 
o¡
 << "MidiInWšMM::İ’PÜt:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

2089 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

2090 
	`”rÜ
Ğ
RtMidiE¼Ü
::
INVALID_PARAMETER
, 
”rÜSŒšg_
 );

2094 
WšMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
­iD©a_
);

2095 
MMRESULT
 
»suÉ
 = 
	`midiInO³n
Ğ&
d©a
->
šHªdË
,

2096 
pÜtNumb”
,

2097 (
DWORD_PTR
)&
midiIÅutC®lback
,

2098 (
DWORD_PTR
)&
šputD©a_
,

2099 
CALLBACK_FUNCTION
 );

2100 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2101 
”rÜSŒšg_
 = "MidiInWinMM::openPort:ƒrror creating Windows MM MIDI input…ort.";

2102 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2107  
i
=0; i<
RT_SYSEX_BUFFER_COUNT
; ++i ) {

2108 
d©a
->
sy£xBufãr
[
i
] = (
MIDIHDR
*è
Ãw
 [ (MIDIHDR) ];

2109 
d©a
->
sy£xBufãr
[
i
]->
ÍD©a
 = 
Ãw
 [ 
RT_SYSEX_BUFFER_SIZE
 ];

2110 
d©a
->
sy£xBufãr
[
i
]->
dwBufãrL’gth
 = 
RT_SYSEX_BUFFER_SIZE
;

2111 
d©a
->
sy£xBufãr
[
i
]->
dwU£r
 = i;

2112 
d©a
->
sy£xBufãr
[
i
]->
dwFÏgs
 = 0;

2114 
»suÉ
 = 
	`midiInP»·»H—d”
Ğ
d©a
->
šHªdË
, d©a->
sy£xBufãr
[
i
], (
MIDIHDR
) );

2115 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2116 
	`midiInClo£
Ğ
d©a
->
šHªdË
 );

2117 
”rÜSŒšg_
 = "MidiInWinMM::openPort:ƒrror starting Windows MM MIDI input…ort (PrepareHeader).";

2118 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2123 
»suÉ
 = 
	`midiInAddBufãr
Ğ
d©a
->
šHªdË
, d©a->
sy£xBufãr
[
i
], (
MIDIHDR
) );

2124 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2125 
	`midiInClo£
Ğ
d©a
->
šHªdË
 );

2126 
”rÜSŒšg_
 = "MidiInWinMM::openPort:ƒrror starting Windows MM MIDI input…ort (AddBuffer).";

2127 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2132 
»suÉ
 = 
	`midiInS¹
Ğ
d©a
->
šHªdË
 );

2133 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2134 
	`midiInClo£
Ğ
d©a
->
šHªdË
 );

2135 
”rÜSŒšg_
 = "MidiInWinMM::openPort:ƒrror starting Windows MM MIDI input…ort.";

2136 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2140 
cÚÃùed_
 = 
Œue
;

2141 
	}
}

2143 
	gMidiInWšMM
 :: 
	$İ’Vœtu®PÜt
Ğ
¡d
::
¡ršg
 )

2146 
”rÜSŒšg_
 = "MidiInWinMM::openVirtualPort: cannot be implemented in Windows MM MIDI API!";

2147 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2148 
	}
}

2150 
	gMidiInWšMM
 :: 
	$şo£PÜt
( )

2152 iàĞ
cÚÃùed_
 ) {

2153 
WšMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
­iD©a_
);

2154 
	`EÁ”Cr™iÿlSeùiÚ
Ğ&(
d©a
->
_mu‹x
) );

2155 
	`midiInRe£t
Ğ
d©a
->
šHªdË
 );

2156 
	`midiInStİ
Ğ
d©a
->
šHªdË
 );

2158  
i
=0; i<
RT_SYSEX_BUFFER_COUNT
; ++i ) {

2159 
»suÉ
 = 
	`midiInUÅ»·»H—d”
(
d©a
->
šHªdË
, d©a->
sy£xBufãr
[
i
], (
MIDIHDR
));

2160 
d–‘e
 [] 
d©a
->
sy£xBufãr
[
i
]->
ÍD©a
;

2161 
d–‘e
 [] 
d©a
->
sy£xBufãr
[
i
];

2162 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2163 
	`midiInClo£
Ğ
d©a
->
šHªdË
 );

2164 
”rÜSŒšg_
 = "MidiInWinMM::openPort:ƒrror closing Windows MM MIDI input…ort (midiInUnprepareHeader).";

2165 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2170 
	`midiInClo£
Ğ
d©a
->
šHªdË
 );

2171 
cÚÃùed_
 = 
çl£
;

2172 
	`L—veCr™iÿlSeùiÚ
Ğ&(
d©a
->
_mu‹x
) );

2174 
	}
}

2176 
	gMidiInWšMM
 :: 
	$g‘PÜtCouÁ
()

2178  
	`midiInG‘NumDevs
();

2179 
	}
}

2181 
	g¡d
::
¡ršg
 
MidiInWšMM
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

2183 
¡d
::
¡ršg
 
¡ršgName
;

2184 
nDeviûs
 = 
	`midiInG‘NumDevs
();

2185 iàĞ
pÜtNumb”
 >ğ
nDeviûs
 ) {

2186 
¡d
::
o¡ršg¡»am
 
o¡
;

2187 
o¡
 << "MidiInWšMM::g‘PÜtName:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

2188 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

2189 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2190  
¡ršgName
;

2193 
MIDIINCAPS
 
deviûC­s
;

2194 
	`midiInG‘DevC­s
Ğ
pÜtNumb”
, &
deviûC­s
, (
MIDIINCAPS
));

2196 #ià
	`defšed
Ğ
UNICODE
 ) || defšedĞ
_UNICODE
 )

2197 
Ëngth
 = 
	`WideCh¬ToMuÉiBy‹
(
CP_UTF8
, 0, 
deviûC­s
.
szPÇme
, -1, 
NULL
, 0, NULL, NULL) - 1;

2198 
¡ršgName
.
	`assign
Ğ
Ëngth
, 0 );

2199 
Ëngth
 = 
	`WideCh¬ToMuÉiBy‹
(
CP_UTF8
, 0, 
deviûC­s
.
szPÇme
, 
¡©ic_ÿ¡
<>(
	`wc¦’
(deviûC­s.szPÇme)), &
¡ršgName
[0],†’gth, 
NULL
, NULL);

2201 
¡ršgName
 = 
¡d
::
	`¡ršg
Ğ
deviûC­s
.
szPÇme
 );

2207 
¡d
::
o¡ršg¡»am
 
os
;

2208 
os
 << " ";

2209 
os
 << 
pÜtNumb”
;

2210 
¡ršgName
 +ğ
os
.
	`¡r
();

2212  
¡ršgName
;

2213 
	}
}

2220 
	gMidiOutWšMM
 :: 
	$MidiOutWšMM
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 ) : 
	$MidiOutApi
()

2222 
	`š™Ÿlize
Ğ
ş›ÁName
 );

2223 
	}
}

2225 
	gMidiOutWšMM
 :: ~
	$MidiOutWšMM
()

2228 
	`şo£PÜt
();

2231 
WšMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
­iD©a_
);

2232 
d–‘e
 
d©a
;

2233 
	}
}

2235 
	gMidiOutWšMM
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& )

2239 
nDeviûs
 = 
	`midiOutG‘NumDevs
();

2240 iàĞ
nDeviûs
 == 0 ) {

2241 
”rÜSŒšg_
 = "MidiOutWinMM::initialize:‚o MIDI output devices currently‡vailable.";

2242 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2246 
WšMidiD©a
 *
d©a
 = (WšMidiD©¨*è
Ãw
 WinMidiData;

2247 
­iD©a_
 = (*è
d©a
;

2248 
	}
}

2250 
	gMidiOutWšMM
 :: 
	$g‘PÜtCouÁ
()

2252  
	`midiOutG‘NumDevs
();

2253 
	}
}

2255 
	g¡d
::
¡ršg
 
MidiOutWšMM
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

2257 
¡d
::
¡ršg
 
¡ršgName
;

2258 
nDeviûs
 = 
	`midiOutG‘NumDevs
();

2259 iàĞ
pÜtNumb”
 >ğ
nDeviûs
 ) {

2260 
¡d
::
o¡ršg¡»am
 
o¡
;

2261 
o¡
 << "MidiOutWšMM::g‘PÜtName:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

2262 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

2263 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2264  
¡ršgName
;

2267 
MIDIOUTCAPS
 
deviûC­s
;

2268 
	`midiOutG‘DevC­s
Ğ
pÜtNumb”
, &
deviûC­s
, (
MIDIOUTCAPS
));

2270 #ià
	`defšed
Ğ
UNICODE
 ) || defšedĞ
_UNICODE
 )

2271 
Ëngth
 = 
	`WideCh¬ToMuÉiBy‹
(
CP_UTF8
, 0, 
deviûC­s
.
szPÇme
, -1, 
NULL
, 0, NULL, NULL) - 1;

2272 
¡ršgName
.
	`assign
Ğ
Ëngth
, 0 );

2273 
Ëngth
 = 
	`WideCh¬ToMuÉiBy‹
(
CP_UTF8
, 0, 
deviûC­s
.
szPÇme
, 
¡©ic_ÿ¡
<>(
	`wc¦’
(deviûC­s.szPÇme)), &
¡ršgName
[0],†’gth, 
NULL
, NULL);

2275 
¡ršgName
 = 
¡d
::
	`¡ršg
Ğ
deviûC­s
.
szPÇme
 );

2281 
¡d
::
o¡ršg¡»am
 
os
;

2282 
os
 << " ";

2283 
os
 << 
pÜtNumb”
;

2284 
¡ršgName
 +ğ
os
.
	`¡r
();

2286  
¡ršgName
;

2287 
	}
}

2289 
	gMidiOutWšMM
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 )

2291 iàĞ
cÚÃùed_
 ) {

2292 
”rÜSŒšg_
 = "MidiOutWinMM::openPort:‡ valid connection‡lreadyƒxists!";

2293 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2297 
nDeviûs
 = 
	`midiOutG‘NumDevs
();

2298 ià(
nDeviûs
 < 1) {

2299 
”rÜSŒšg_
 = "MidiOutWinMM::openPort:‚o MIDI output destinations found!";

2300 
	`”rÜ
Ğ
RtMidiE¼Ü
::
NO_DEVICES_FOUND
, 
”rÜSŒšg_
 );

2304 iàĞ
pÜtNumb”
 >ğ
nDeviûs
 ) {

2305 
¡d
::
o¡ršg¡»am
 
o¡
;

2306 
o¡
 << "MidiOutWšMM::İ’PÜt:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

2307 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

2308 
	`”rÜ
Ğ
RtMidiE¼Ü
::
INVALID_PARAMETER
, 
”rÜSŒšg_
 );

2312 
WšMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
­iD©a_
);

2313 
MMRESULT
 
»suÉ
 = 
	`midiOutO³n
Ğ&
d©a
->
outHªdË
,

2314 
pÜtNumb”
,

2315 (
DWORD
)
NULL
,

2316 (
DWORD
)
NULL
,

2317 
CALLBACK_NULL
 );

2318 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2319 
”rÜSŒšg_
 = "MidiOutWinMM::openPort:ƒrror creating Windows MM MIDI output…ort.";

2320 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2324 
cÚÃùed_
 = 
Œue
;

2325 
	}
}

2327 
	gMidiOutWšMM
 :: 
	$şo£PÜt
( )

2329 iàĞ
cÚÃùed_
 ) {

2330 
WšMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
­iD©a_
);

2331 
	`midiOutRe£t
Ğ
d©a
->
outHªdË
 );

2332 
	`midiOutClo£
Ğ
d©a
->
outHªdË
 );

2333 
cÚÃùed_
 = 
çl£
;

2335 
	}
}

2337 
	gMidiOutWšMM
 :: 
	$İ’Vœtu®PÜt
Ğ
¡d
::
¡ršg
 )

2340 
”rÜSŒšg_
 = "MidiOutWinMM::openVirtualPort: cannot be implemented in Windows MM MIDI API!";

2341 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2342 
	}
}

2344 
	gMidiOutWšMM
 :: 
£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 )

2346 iàĞ!
cÚÃùed_
 ) ;

2348 
	gnBy‹s
 = 
¡©ic_ÿ¡
<>(
mes§ge
->
size
());

2349 iàĞ
	gnBy‹s
 == 0 ) {

2350 
”rÜSŒšg_
 = "MidiOutWinMM::sendMessage: message‡rgument isƒmpty!";

2351 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2355 
MMRESULT
 
	g»suÉ
;

2356 
WšMidiD©a
 *
	gd©a
 = 
¡©ic_ÿ¡
<WšMidiD©¨*> (
­iD©a_
);

2357 iàĞ
	gmes§ge
->
©
(0) == 0xF0 ) {

2360 *
bufãr
 = (*è
m®loc
Ğ
nBy‹s
 );

2361 iàĞ
	gbufãr
 =ğ
NULL
 ) {

2362 
”rÜSŒšg_
 = "MidiOutWinMM::sendMessage:ƒrror‡llocating sysex message memory!";

2363 
”rÜ
Ğ
RtMidiE¼Ü
::
MEMORY_ERROR
, 
”rÜSŒšg_
 );

2368  
	gi
=0; i<
	gnBy‹s
; ++˜è
	gbufãr
[
i
] = 
mes§ge
->
©
(i);

2371 
MIDIHDR
 
	gsy£x
;

2372 
	gsy£x
.
	gÍD©a
 = (
LPSTR
è
bufãr
;

2373 
	gsy£x
.
	gdwBufãrL’gth
 = 
nBy‹s
;

2374 
	gsy£x
.
	gdwFÏgs
 = 0;

2375 
	g»suÉ
 = 
midiOutP»·»H—d”
Ğ
d©a
->
outHªdË
, &
sy£x
, (
MIDIHDR
) );

2376 iàĞ
	g»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2377 
ä“
Ğ
bufãr
 );

2378 
	g”rÜSŒšg_
 = "MidiOutWinMM::sendMessage:ƒrror…reparing sysex header.";

2379 
”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2384 
	g»suÉ
 = 
midiOutLÚgMsg
Ğ
d©a
->
outHªdË
, &
sy£x
, (
MIDIHDR
) );

2385 iàĞ
	g»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2386 
ä“
Ğ
bufãr
 );

2387 
	g”rÜSŒšg_
 = "MidiOutWinMM::sendMessage:ƒrror sending sysex message.";

2388 
”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2393  
	gMIDIERR_STILLPLAYING
 =ğ
midiOutUÅ»·»H—d”
Ğ
d©a
->
outHªdË
, &
sy£x
,  (
MIDIHDR
èèè
SË•
( 1 );

2394 
ä“
Ğ
bufãr
 );

2399 iàĞ
	gnBy‹s
 > 3 ) {

2400 
	g”rÜSŒšg_
 = "MidiOutWinMM::sendMessage: message size is greaterhan 3 bytes (and‚ot sysex)!";

2401 
”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2406 
DWORD
 
	g·ck‘
;

2407 *
	g±r
 = (*è&
·ck‘
;

2408  
	gi
=0; i<
	gnBy‹s
; ++i ) {

2409 *
	g±r
 = 
mes§ge
->
©
(
i
);

2410 ++
	g±r
;

2414 
	g»suÉ
 = 
midiOutShÜtMsg
Ğ
d©a
->
outHªdË
, 
·ck‘
 );

2415 iàĞ
	g»suÉ
 !ğ
MMSYSERR_NOERROR
 ) {

2416 
”rÜSŒšg_
 = "MidiOutWinMM::sendMessage:ƒrror sending MIDI message.";

2417 
”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2433 #ià
defšed
(
__UNIX_JACK__
)

2436 
	~<jack/jack.h
>

2437 
	~<jack/midÜt.h
>

2438 
	~<jack/ršgbufãr.h
>

2440 
	#JACK_RINGBUFFER_SIZE
 16384

2441 

	)

2442 
	sJackMidiD©a
 {

2443 
jack_ş›Á_t
 *
	mş›Á
;

2444 
jack_pÜt_t
 *
	mpÜt
;

2445 
jack_ršgbufãr_t
 *
	mbuffSize
;

2446 
jack_ršgbufãr_t
 *
	mbuffMes§ge
;

2447 
jack_time_t
 
	mÏ¡Time
;

2448 
	mMidiInApi
 :: 
RtMidiInD©a
 *
¹MidiIn
;

2456 
	$jackProûssIn
Ğ
jack_näames_t
 
näames
, *
¬g
 )

2458 
JackMidiD©a
 *
jD©a
 = (JackMidiD©¨*è
¬g
;

2459 
MidiInApi
 :: 
RtMidiInD©a
 *
¹D©a
 = 
jD©a
->
¹MidiIn
;

2460 
jack_midi_ev’t_t
 
ev’t
;

2461 
jack_time_t
 
time
;

2464 iàĞ
jD©a
->
pÜt
 =ğ
NULL
 )  0;

2465 *
buff
 = 
	`jack_pÜt_g‘_bufãr
Ğ
jD©a
->
pÜt
, 
näames
 );

2468 
evCouÁ
 = 
	`jack_midi_g‘_ev’t_couÁ
Ğ
buff
 );

2469 
j
 = 0; j < 
evCouÁ
; j++) {

2470 
MidiInApi
::
MidiMes§ge
 
mes§ge
;

2471 
mes§ge
.
by‹s
.
	`ş—r
();

2473 
	`jack_midi_ev’t_g‘
Ğ&
ev’t
, 
buff
, 
j
 );

2475  
i
 = 0; i < 
ev’t
.
size
; i++ )

2476 
mes§ge
.
by‹s
.
	`push_back
Ğ
ev’t
.
bufãr
[
i
] );

2479 
time
 = 
	`jack_g‘_time
();

2480 iàĞ
¹D©a
->
fœ¡Mes§ge
 =ğ
Œue
 )

2481 
¹D©a
->
fœ¡Mes§ge
 = 
çl£
;

2483 
mes§ge
.
timeSmp
 = ( 
time
 - 
jD©a
->
Ï¡Time
 ) * 0.000001;

2485 
jD©a
->
Ï¡Time
 = 
time
;

2487 iàĞ!
¹D©a
->
cÚtšueSy£x
 ) {

2488 iàĞ
¹D©a
->
usšgC®lback
 ) {

2489 
RtMidiIn
::
RtMidiC®lback
 
ÿÎback
 = (RtMidiIn::RtMidiC®lbackè
¹D©a
->
u£rC®lback
;

2490 
	`ÿÎback
Ğ
mes§ge
.
timeSmp
, &mes§ge.
by‹s
, 
¹D©a
->
u£rD©a
 );

2494 iàĞ
¹D©a
->
queue
.
size
 <„tD©a->queue.
ršgSize
 ) {

2495 
¹D©a
->
queue
.
ršg
[¹D©a->queue.
back
++] = 
mes§ge
;

2496 iàĞ
¹D©a
->
queue
.
back
 =ğ¹D©a->queue.
ršgSize
 )

2497 
¹D©a
->
queue
.
back
 = 0;

2498 
¹D©a
->
queue
.
size
++;

2501 
¡d
::
û¼
 << "\nMidiInJack: message queue†imit„eached!!\n\n";

2507 
	}
}

2509 
	gMidiInJack
 :: 
	$MidiInJack
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 ) : 
	$MidiInApi
Ğ
queueSizeLim™
 )

2511 
	`š™Ÿlize
Ğ
ş›ÁName
 );

2512 
	}
}

2514 
	gMidiInJack
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 )

2516 
JackMidiD©a
 *
d©a
 = 
Ãw
 JackMidiData;

2517 
­iD©a_
 = (*è
d©a
;

2519 
d©a
->
¹MidiIn
 = &
šputD©a_
;

2520 
d©a
->
pÜt
 = 
NULL
;

2521 
d©a
->
ş›Á
 = 
NULL
;

2522 
this
->
ş›ÁName
 = clientName;

2524 
	`cÚÃù
();

2525 
	}
}

2527 
	gMidiInJack
 :: 
	$cÚÃù
()

2529 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2530 iàĞ
d©a
->
ş›Á
 )

2534 ià(Ğ
d©a
->
ş›Á
 = 
	`jack_ş›Á_İ’
Ğ
ş›ÁName
.
	`c_¡r
(), 
JackNoS¹S”v”
, 
NULL
 )) == 0) {

2535 
”rÜSŒšg_
 = "MidiInJack::initialize: JACK server‚ot„unning?";

2536 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2540 
	`jack_£t_´oûss_ÿÎback
Ğ
d©a
->
ş›Á
, 
jackProûssIn
, data );

2541 
	`jack_aùiv©e
Ğ
d©a
->
ş›Á
 );

2542 
	}
}

2544 
	gMidiInJack
 :: ~
	$MidiInJack
()

2546 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2547 
	`şo£PÜt
();

2549 iàĞ
d©a
->
ş›Á
 )

2550 
	`jack_ş›Á_şo£
Ğ
d©a
->
ş›Á
 );

2551 
d–‘e
 
d©a
;

2552 
	}
}

2554 
	gMidiInJack
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

2556 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2558 
	`cÚÃù
();

2561 iàĞ
d©a
->
pÜt
 =ğ
NULL
)

2562 
d©a
->
pÜt
 = 
	`jack_pÜt_»gi¡”
Ğd©a->
ş›Á
, 
pÜtName
.
	`c_¡r
(),

2563 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsIÅut
, 0 );

2565 iàĞ
d©a
->
pÜt
 =ğ
NULL
) {

2566 
”rÜSŒšg_
 = "MidiInJack::openPort: JACKƒrror creating…ort";

2567 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2572 
¡d
::
¡ršg
 
Çme
 = 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

2573 
	`jack_cÚÃù
Ğ
d©a
->
ş›Á
, 
Çme
.
	`c_¡r
(), 
	`jack_pÜt_Çme
Ğd©a->
pÜt
 ) );

2574 
	}
}

2576 
	gMidiInJack
 :: 
	$İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

2578 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2580 
	`cÚÃù
();

2581 iàĞ
d©a
->
pÜt
 =ğ
NULL
 )

2582 
d©a
->
pÜt
 = 
	`jack_pÜt_»gi¡”
Ğd©a->
ş›Á
, 
pÜtName
.
	`c_¡r
(),

2583 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsIÅut
, 0 );

2585 iàĞ
d©a
->
pÜt
 =ğ
NULL
 ) {

2586 
”rÜSŒšg_
 = "MidiInJack::openVirtualPort: JACKƒrror creating virtual…ort";

2587 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2589 
	}
}

2591 
	gMidiInJack
 :: 
	$g‘PÜtCouÁ
()

2593 
couÁ
 = 0;

2594 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2595 
	`cÚÃù
();

2596 iàĞ!
d©a
->
ş›Á
 )

2600 cÚ¡ **
pÜts
 = 
	`jack_g‘_pÜts
Ğ
d©a
->
ş›Á
, 
NULL
, 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsOuut
 );

2602 iàĞ
pÜts
 =ğ
NULL
 )  0;

2603  
pÜts
[
couÁ
] !ğ
NULL
 )

2604 
couÁ
++;

2606 
	`ä“
Ğ
pÜts
 );

2608  
couÁ
;

2609 
	}
}

2611 
	g¡d
::
¡ršg
 
MidiInJack
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

2613 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2614 
¡d
::
¡ršg
 
	`»tSŒ
("");

2616 
	`cÚÃù
();

2619 cÚ¡ **
pÜts
 = 
	`jack_g‘_pÜts
Ğ
d©a
->
ş›Á
, 
NULL
,

2620 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsOuut
 );

2623 iàĞ
pÜts
 =ğ
NULL
 ) {

2624 
”rÜSŒšg_
 = "MidiInJack::getPortName:‚o…orts‡vailable!";

2625 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2626  
»tSŒ
;

2629 iàĞ
pÜts
[
pÜtNumb”
] =ğ
NULL
 ) {

2630 
¡d
::
o¡ršg¡»am
 
o¡
;

2631 
o¡
 << "MidiInJack::g‘PÜtName:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

2632 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

2633 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2635 
»tSŒ
.
	`assign
Ğ
pÜts
[
pÜtNumb”
] );

2637 
	`ä“
Ğ
pÜts
 );

2638  
»tSŒ
;

2639 
	}
}

2641 
	gMidiInJack
 :: 
	$şo£PÜt
()

2643 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2645 iàĞ
d©a
->
pÜt
 =ğ
NULL
 ) ;

2646 
	`jack_pÜt_uÄegi¡”
Ğ
d©a
->
ş›Á
, d©a->
pÜt
 );

2647 
d©a
->
pÜt
 = 
NULL
;

2648 
	}
}

2656 
	$jackProûssOut
Ğ
jack_näames_t
 
näames
, *
¬g
 )

2658 
JackMidiD©a
 *
d©a
 = (JackMidiD©¨*è
¬g
;

2659 
jack_midi_d©a_t
 *
midiD©a
;

2660 
¥aû
;

2663 iàĞ
d©a
->
pÜt
 =ğ
NULL
 )  0;

2665 *
buff
 = 
	`jack_pÜt_g‘_bufãr
Ğ
d©a
->
pÜt
, 
näames
 );

2666 
	`jack_midi_ş—r_bufãr
Ğ
buff
 );

2668  
	`jack_ršgbufãr_»ad_¥aû
Ğ
d©a
->
buffSize
 ) > 0 ) {

2669 
	`jack_ršgbufãr_»ad
Ğ
d©a
->
buffSize
, (*è&
¥aû
, (
size_t
) (space) );

2670 
midiD©a
 = 
	`jack_midi_ev’t_»£rve
Ğ
buff
, 0, 
¥aû
 );

2672 
	`jack_ršgbufãr_»ad
Ğ
d©a
->
buffMes§ge
, (*è
midiD©a
, (
size_t
è
¥aû
 );

2676 
	}
}

2678 
	gMidiOutJack
 :: 
	$MidiOutJack
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 ) : 
	$MidiOutApi
()

2680 
	`š™Ÿlize
Ğ
ş›ÁName
 );

2681 
	}
}

2683 
	gMidiOutJack
 :: 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 )

2685 
JackMidiD©a
 *
d©a
 = 
Ãw
 JackMidiData;

2686 
­iD©a_
 = (*è
d©a
;

2688 
d©a
->
pÜt
 = 
NULL
;

2689 
d©a
->
ş›Á
 = 
NULL
;

2690 
this
->
ş›ÁName
 = clientName;

2692 
	`cÚÃù
();

2693 
	}
}

2695 
	gMidiOutJack
 :: 
	$cÚÃù
()

2697 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2698 iàĞ
d©a
->
ş›Á
 )

2702 
d©a
->
buffSize
 = 
	`jack_ršgbufãr_ü—‹
Ğ
JACK_RINGBUFFER_SIZE
 );

2703 
d©a
->
buffMes§ge
 = 
	`jack_ršgbufãr_ü—‹
Ğ
JACK_RINGBUFFER_SIZE
 );

2706 ià(Ğ
d©a
->
ş›Á
 = 
	`jack_ş›Á_İ’
Ğ
ş›ÁName
.
	`c_¡r
(), 
JackNoS¹S”v”
, 
NULL
 )) == 0) {

2707 
”rÜSŒšg_
 = "MidiOutJack::initialize: JACK server‚ot„unning?";

2708 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2712 
	`jack_£t_´oûss_ÿÎback
Ğ
d©a
->
ş›Á
, 
jackProûssOut
, data );

2713 
	`jack_aùiv©e
Ğ
d©a
->
ş›Á
 );

2714 
	}
}

2716 
	gMidiOutJack
 :: ~
	$MidiOutJack
()

2718 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2719 
	`şo£PÜt
();

2722 
	`jack_ršgbufãr_ä“
Ğ
d©a
->
buffSize
 );

2723 
	`jack_ršgbufãr_ä“
Ğ
d©a
->
buffMes§ge
 );

2724 iàĞ
d©a
->
ş›Á
 ) {

2725 
	`jack_ş›Á_şo£
Ğ
d©a
->
ş›Á
 );

2728 
d–‘e
 
d©a
;

2729 
	}
}

2731 
	gMidiOutJack
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

2733 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2735 
	`cÚÃù
();

2738 iàĞ
d©a
->
pÜt
 =ğ
NULL
 )

2739 
d©a
->
pÜt
 = 
	`jack_pÜt_»gi¡”
Ğd©a->
ş›Á
, 
pÜtName
.
	`c_¡r
(),

2740 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsOuut
, 0 );

2742 iàĞ
d©a
->
pÜt
 =ğ
NULL
 ) {

2743 
”rÜSŒšg_
 = "MidiOutJack::openPort: JACKƒrror creating…ort";

2744 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2749 
¡d
::
¡ršg
 
Çme
 = 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

2750 
	`jack_cÚÃù
Ğ
d©a
->
ş›Á
, 
	`jack_pÜt_Çme
Ğd©a->
pÜt
 ), 
Çme
.
	`c_¡r
() );

2751 
	}
}

2753 
	gMidiOutJack
 :: 
	$İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 )

2755 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2757 
	`cÚÃù
();

2758 iàĞ
d©a
->
pÜt
 =ğ
NULL
 )

2759 
d©a
->
pÜt
 = 
	`jack_pÜt_»gi¡”
Ğd©a->
ş›Á
, 
pÜtName
.
	`c_¡r
(),

2760 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsOuut
, 0 );

2762 iàĞ
d©a
->
pÜt
 =ğ
NULL
 ) {

2763 
”rÜSŒšg_
 = "MidiOutJack::openVirtualPort: JACKƒrror creating virtual…ort";

2764 
	`”rÜ
Ğ
RtMidiE¼Ü
::
DRIVER_ERROR
, 
”rÜSŒšg_
 );

2766 
	}
}

2768 
	gMidiOutJack
 :: 
	$g‘PÜtCouÁ
()

2770 
couÁ
 = 0;

2771 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2772 
	`cÚÃù
();

2773 iàĞ!
d©a
->
ş›Á
 )

2777 cÚ¡ **
pÜts
 = 
	`jack_g‘_pÜts
Ğ
d©a
->
ş›Á
, 
NULL
,

2778 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsIÅut
 );

2780 iàĞ
pÜts
 =ğ
NULL
 )  0;

2781  
pÜts
[
couÁ
] !ğ
NULL
 )

2782 
couÁ
++;

2784 
	`ä“
Ğ
pÜts
 );

2786  
couÁ
;

2787 
	}
}

2789 
	g¡d
::
¡ršg
 
MidiOutJack
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 )

2791 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2792 
¡d
::
¡ršg
 
	`»tSŒ
("");

2794 
	`cÚÃù
();

2797 cÚ¡ **
pÜts
 = 
	`jack_g‘_pÜts
Ğ
d©a
->
ş›Á
, 
NULL
,

2798 
JACK_DEFAULT_MIDI_TYPE
, 
JackPÜtIsIÅut
 );

2801 iàĞ
pÜts
 =ğ
NULL
) {

2802 
”rÜSŒšg_
 = "MidiOutJack::getPortName:‚o…orts‡vailable!";

2803 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2804  
»tSŒ
;

2807 iàĞ
pÜts
[
pÜtNumb”
] =ğ
NULL
) {

2808 
¡d
::
o¡ršg¡»am
 
o¡
;

2809 
o¡
 << "MidiOutJack::g‘PÜtName:h'pÜtNumb”'‡rgum’ˆ(" << 
pÜtNumb”
 << ") is invalid.";

2810 
”rÜSŒšg_
 = 
o¡
.
	`¡r
();

2811 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
, 
”rÜSŒšg_
 );

2813 
»tSŒ
.
	`assign
Ğ
pÜts
[
pÜtNumb”
] );

2815 
	`ä“
Ğ
pÜts
 );

2816  
»tSŒ
;

2817 
	}
}

2819 
	gMidiOutJack
 :: 
	$şo£PÜt
()

2821 
JackMidiD©a
 *
d©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2823 iàĞ
d©a
->
pÜt
 =ğ
NULL
 ) ;

2824 
	`jack_pÜt_uÄegi¡”
Ğ
d©a
->
ş›Á
, d©a->
pÜt
 );

2825 
d©a
->
pÜt
 = 
NULL
;

2826 
	}
}

2828 
	gMidiOutJack
 :: 
£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 )

2830 
nBy‹s
 = 
mes§ge
->
size
();

2831 
JackMidiD©a
 *
	gd©a
 = 
¡©ic_ÿ¡
<JackMidiD©¨*> (
­iD©a_
);

2834 
jack_ršgbufãr_wr™e
Ğ
d©a
->
buffMes§ge
, ( cÚ¡ * ) &Ğ*
mes§ge
 )[0],

2835 
mes§ge
->
size
() );

2836 
jack_ršgbufãr_wr™e
Ğ
d©a
->
buffSize
, ( * ) &
nBy‹s
, (‚Bytes ) );

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\rtmidi-2.1.1\RtMidi.h

43 #iâdeà
RTMIDI_H


44 
	#RTMIDI_H


	)

46 
	#RTMIDI_VERSION
 "2.1.1"

	)

48 
	~<exû±iÚ
>

49 
	~<io¡»am
>

50 
	~<¡ršg
>

51 
	~<veùÜ
>

63 şas 
	cRtMidiE¼Ü
 : 
public
 
¡d
::
exû±iÚ


65 
public
:

67 
	eTy³
 {

68 
WARNING
,

69 
	mDEBUG_WARNING
,

70 
	mUNSPECIFIED
,

71 
	mNO_DEVICES_FOUND
,

72 
	mINVALID_DEVICE
,

73 
	mMEMORY_ERROR
,

74 
	mINVALID_PARAMETER
,

75 
	mINVALID_USE
,

76 
	mDRIVER_ERROR
,

77 
	mSYSTEM_ERROR
,

78 
	mTHREAD_ERROR


82 
	$RtMidiE¼Ü
ĞcÚ¡ 
¡d
::
¡ršg
& 
mes§ge
, 
Ty³
 
ty³
 = 
RtMidiE¼Ü
::
UNSPECIFIED
 ) 
	$throw
(è: 
	`mes§ge_
(
mes§ge
), 
	$ty³_
(
ty³
è{
	}
}

85 
	gvœtu®
 ~
	$RtMidiE¼Ü
Ğè
	$throw
(è{
	}
}

88 
vœtu®
 
	$´štMes§ge
ĞècÚ¡ 
	$throw
(è{ 
¡d
::
û¼
 << '\n' << 
mes§ge_
 << "\n\n"; 
	}
}

91 
vœtu®
 cÚ¡ 
	gTy³
& 
	$g‘Ty³
(ècÚ¡ 
	$throw
(è{  
ty³_
; 
	}
}

94 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
& 
	$g‘Mes§ge
(ècÚ¡ 
	$throw
(è{  
mes§ge_
; 
	}
}

97 
vœtu®
 cÚ¡ * 
	$wh©
ĞècÚ¡ 
	$throw
(è{  
mes§ge_
.
	`c_¡r
(); 
	}
}

99 
	g´Ùeùed
:

100 
¡d
::
¡ršg
 
mes§ge_
;

101 
Ty³
 
	gty³_
;

112 (*
	tRtMidiE¼ÜC®lback
)Ğ
	tRtMidiE¼Ü
::
	tTy³
 
	tty³
, cÚ¡ 
	t¡d
::
	t¡ršg
 &
	t”rÜText
, *
	tu£rD©a
 );

114 
şass
 
MidiApi
;

116 şas 
	cRtMidi


118 
public
:

121 
	eApi
 {

122 
UNSPECIFIED
,

123 
MACOSX_CORE
,

124 
LINUX_ALSA
,

125 
UNIX_JACK
,

126 
WINDOWS_MM
,

127 
RTMIDI_DUMMY


131 
¡d
::
¡ršg
 
	$g‘V”siÚ
Ğè
	`throw
();

139 
	`g‘CompedApi
Ğ
¡d
::
veùÜ
<
RtMidi
::
Api
> &
­is
 ) 
	`throw
();

142 
vœtu®
 
	`İ’PÜt
Ğ
pÜtNumb”
 = 0, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 = std::
	`¡ršg
( "RtMidi" ) ) = 0;

145 
vœtu®
 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 = std::
	`¡ršg
( "RtMidi" ) ) = 0;

148 
vœtu®
 
	`g‘PÜtCouÁ
() = 0;

151 
vœtu®
 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 = 0 ) = 0;

154 
vœtu®
 
	`şo£PÜt
( ) = 0;

157 
vœtu®
 
boŞ
 
	$isPÜtO³n
( ) const = 0;

164 
vœtu®
 
	`£tE¼ÜC®lback
Ğ
RtMidiE¼ÜC®lback
 
”rÜC®lback
 = 
NULL
, *
u£rD©a
 = 0 ) = 0;

166 
´Ùeùed
:

168 
	`RtMidi
();

169 
vœtu®
 ~
	`RtMidi
();

171 
MidiApi
 *
¹­i_
;

172 
	}
};

206 şas 
	cRtMidiIn
 : 
public
 
RtMidi


208 
public
:

211 (*
	tRtMidiC®lback
)Ğ
	ttimeSmp
, 
	t¡d
::
	tveùÜ
<> *
	tmes§ge
, *
	tu£rD©a
);

231 
	`RtMidiIn
Ğ
RtMidi
::
Api
 
­i
=
UNSPECIFIED
,

232 cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 = std::
	`¡ršg
( "RtMidi Input Client"),

233 
queueSizeLim™
 = 100 );

236 ~
	$RtMidiIn
 ( è
	`throw
();

239 
RtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè
	`throw
();

247 
	`İ’PÜt
Ğ
pÜtNumb”
 = 0, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 = std::
	`¡ršg
( "RtMidi Input" ) );

259 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 = std::
	`¡ršg
( "RtMidi Input" ) );

272 
	`£tC®lback
Ğ
RtMidiC®lback
 
ÿÎback
, *
u£rD©a
 = 0 );

279 
	`ÿnûlC®lback
();

282 
	`şo£PÜt
( );

285 
vœtu®
 
boŞ
 
	$isPÜtO³n
() const;

291 
	`g‘PÜtCouÁ
();

298 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 = 0 );

308 
	`ignÜeTy³s
Ğ
boŞ
 
midiSy£x
 = 
Œue
, boŞ 
midiTime
 =rue, boŞ 
midiS’£
 =rue );

318 
	`g‘Mes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 );

325 
vœtu®
 
	`£tE¼ÜC®lback
Ğ
RtMidiE¼ÜC®lback
 
”rÜC®lback
 = 
NULL
, *
u£rD©a
 = 0 );

327 
´Ùeùed
:

328 
	`İ’MidiApi
Ğ
RtMidi
::
Api
 
­i
, cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 );

348 şas 
	cRtMidiOut
 : 
public
 
RtMidi


350 
public
:

360 
	`RtMidiOut
Ğ
RtMidi
::
Api
 
­i
=
UNSPECIFIED
,

361 cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 = std::
	`¡ršg
( "RtMidi Output Client") );

364 ~
	$RtMidiOut
Ğè
	`throw
();

367 
RtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè
	`throw
();

376 
	`İ’PÜt
Ğ
pÜtNumb”
 = 0, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 = std::
	`¡ršg
( "RtMidi Output" ) );

379 
	`şo£PÜt
( );

382 
vœtu®
 
boŞ
 
	$isPÜtO³n
() const;

393 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 = std::
	`¡ršg
( "RtMidi Output" ) );

396 
	`g‘PÜtCouÁ
( );

402 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 = 0 );

409 
	`£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 );

416 
vœtu®
 
	`£tE¼ÜC®lback
Ğ
RtMidiE¼ÜC®lback
 
”rÜC®lback
 = 
NULL
, *
u£rD©a
 = 0 );

418 
´Ùeùed
:

419 
	`İ’MidiApi
Ğ
RtMidi
::
Api
 
­i
, cÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 );

436 şas 
	cMidiApi


438 
public
:

440 
	`MidiApi
();

441 
vœtu®
 ~
	`MidiApi
();

442 
vœtu®
 
RtMidi
::
Api
 
	`g‘Cu¼’tApi
( ) = 0;

443 
vœtu®
 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 ) = 0;

444 
vœtu®
 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 ) = 0;

445 
vœtu®
 
	`şo£PÜt
( ) = 0;

447 
vœtu®
 
	`g‘PÜtCouÁ
( ) = 0;

448 
vœtu®
 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 ) = 0;

450 
šlše
 
boŞ
 
	$isPÜtO³n
(ècÚ¡ {  
cÚÃùed_
; }

451 
	`£tE¼ÜC®lback
Ğ
RtMidiE¼ÜC®lback
 
”rÜC®lback
, *
u£rD©a
 );

454 
	`”rÜ
Ğ
RtMidiE¼Ü
::
Ty³
 
ty³
, 
¡d
::
¡ršg
 
”rÜSŒšg
 );

456 
´Ùeùed
:

457 
vœtu®
 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 ) = 0;

459 *
­iD©a_
;

460 
boŞ
 
cÚÃùed_
;

461 
¡d
::
¡ršg
 
”rÜSŒšg_
;

462 
RtMidiE¼ÜC®lback
 
”rÜC®lback_
;

463 
boŞ
 
fœ¡E¼ÜOccu¼ed_
;

464 *
”rÜC®lbackU£rD©a_
;

465 
	}
};

467 şas 
	cMidiInApi
 : 
public
 
MidiApi


469 
public
:

471 
MidiInApi
Ğ
queueSizeLim™
 );

472 
	mvœtu®
 ~
MidiInApi
( );

473 
£tC®lback
Ğ
RtMidiIn
::
RtMidiC®lback
 
ÿÎback
, *
u£rD©a
 );

474 
ÿnûlC®lback
( );

475 
vœtu®
 
ignÜeTy³s
Ğ
boŞ
 
midiSy£x
, boŞ 
midiTime
, boŞ 
midiS’£
 );

476 
g‘Mes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 );

480 
	sMidiMes§ge
 {

481 
	m¡d
::
veùÜ
<> 
by‹s
;

482 
	mtimeSmp
;

485 
MidiMes§ge
()

486 :
by‹s
(0), 
timeSmp
(0.0) {}

489 
	sMidiQueue
 {

490 
	gäÚt
;

491 
	gback
;

492 
	gsize
;

493 
	gršgSize
;

494 
MidiMes§ge
 *
	gršg
;

497 
MidiQueue
()

498 :
äÚt
(0), 
back
(0), 
size
(0), 
ršgSize
(0) {}

503 
	sRtMidiInD©a
 {

504 
MidiQueue
 
	gqueue
;

505 
MidiMes§ge
 
	gmes§ge
;

506 
	gignÜeFÏgs
;

507 
boŞ
 
	gdoIÅut
;

508 
boŞ
 
	gfœ¡Mes§ge
;

509 *
	g­iD©a
;

510 
boŞ
 
	gusšgC®lback
;

511 
	gRtMidiIn
::
RtMidiC®lback
 
u£rC®lback
;

512 *
	gu£rD©a
;

513 
boŞ
 
	gcÚtšueSy£x
;

516 
RtMidiInD©a
()

517 : 
ignÜeFÏgs
(7), 
doIÅut
(
çl£
), 
fœ¡Mes§ge
(
Œue
),

518 
­iD©a
(0), 
usšgC®lback
(
çl£
), 
u£rC®lback
(0), 
u£rD©a
(0),

519 
cÚtšueSy£x
(
çl£
) {}

522 
	g´Ùeùed
:

523 
RtMidiInD©a
 
šputD©a_
;

526 şas 
	cMidiOutApi
 : 
public
 
MidiApi


528 
public
:

530 
MidiOutApi
( );

531 
	mvœtu®
 ~
MidiOutApi
( );

532 
vœtu®
 
£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 ) = 0;

541 
šlše
 
	gRtMidi
::
Api
 
RtMidiIn
 :: 
	$g‘Cu¼’tApi
Ğè
	$throw
(è{  
¹­i_
->
	`g‘Cu¼’tApi
(); 
	}
}

542 
šlše
 
	gRtMidiIn
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 ) { 
¹­i_
->
	`İ’PÜt
ĞpÜtNumb”,…ÜtNam); 
	}
}

543 
šlše
 
	gRtMidiIn
 :: 
	$İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 ) { 
¹­i_
->
	`İ’Vœtu®PÜt
ĞpÜtNam); 
	}
}

544 
šlše
 
	gRtMidiIn
 :: 
	$şo£PÜt
Ğè{ 
¹­i_
->
	`şo£PÜt
(); 
	}
}

545 
šlše
 
boŞ
 
	gRtMidiIn
 :: 
	$isPÜtO³n
(ècÚ¡ {  
¹­i_
->
	`isPÜtO³n
(); 
	}
}

546 
šlše
 
	gRtMidiIn
 :: 
	$£tC®lback
Ğ
RtMidiC®lback
 
ÿÎback
, *
u£rD©a
 ) { ((
MidiInApi
 *)
¹­i_
)->
	`£tC®lback
ĞÿÎback, u£rD©¨); 
	}
}

547 
šlše
 
	gRtMidiIn
 :: 
	$ÿnûlC®lback
Ğè{ ((
MidiInApi
 *)
¹­i_
)->
	`ÿnûlC®lback
(); 
	}
}

548 
šlše
 
	gRtMidiIn
 :: 
	$g‘PÜtCouÁ
Ğè{  
¹­i_
->
	`g‘PÜtCouÁ
(); 
	}
}

549 
šlše
 
	g¡d
::
¡ršg
 
RtMidiIn
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 ) {  
¹­i_
->
	`g‘PÜtName
ĞpÜtNumb” ); 
	}
}

550 
šlše
 
	gRtMidiIn
 :: 
	$ignÜeTy³s
Ğ
boŞ
 
midiSy£x
, boŞ 
midiTime
, boŞ 
midiS’£
 ) { ((
MidiInApi
 *)
¹­i_
)->
	`ignÜeTy³s
ĞmidiSy£x, midiTime, midiS’£ ); 
	}
}

551 
šlše
 
	gRtMidiIn
 :: 
g‘Mes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 ) {  ((
MidiInApi
 *)
¹­i_
)->getMessage( message ); }

552 
šlše
 
	gRtMidiIn
 :: 
	$£tE¼ÜC®lback
Ğ
RtMidiE¼ÜC®lback
 
”rÜC®lback
, *
u£rD©a
 ) { 
¹­i_
->
	`£tE¼ÜC®lback
Ó¼ÜC®lback, u£rD©a); 
	}
}

554 
šlše
 
	gRtMidi
::
Api
 
RtMidiOut
 :: 
	$g‘Cu¼’tApi
Ğè
	$throw
(è{  
¹­i_
->
	`g‘Cu¼’tApi
(); 
	}
}

555 
šlše
 
	gRtMidiOut
 :: 
	$İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 ) { 
¹­i_
->
	`İ’PÜt
ĞpÜtNumb”,…ÜtNam); 
	}
}

556 
šlše
 
	gRtMidiOut
 :: 
	$İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 ) { 
¹­i_
->
	`İ’Vœtu®PÜt
ĞpÜtNam); 
	}
}

557 
šlše
 
	gRtMidiOut
 :: 
	$şo£PÜt
Ğè{ 
¹­i_
->
	`şo£PÜt
(); 
	}
}

558 
šlše
 
boŞ
 
	gRtMidiOut
 :: 
	$isPÜtO³n
(ècÚ¡ {  
¹­i_
->
	`isPÜtO³n
(); 
	}
}

559 
šlše
 
	gRtMidiOut
 :: 
	$g‘PÜtCouÁ
Ğè{  
¹­i_
->
	`g‘PÜtCouÁ
(); 
	}
}

560 
šlše
 
	g¡d
::
¡ršg
 
RtMidiOut
 :: 
	$g‘PÜtName
Ğ
pÜtNumb”
 ) {  
¹­i_
->
	`g‘PÜtName
ĞpÜtNumb” ); 
	}
}

561 
šlše
 
	gRtMidiOut
 :: 
£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 ) { ((
MidiOutApi
 *)
¹­i_
)->sendMessage( message ); }

562 
šlše
 
	gRtMidiOut
 :: 
	$£tE¼ÜC®lback
Ğ
RtMidiE¼ÜC®lback
 
”rÜC®lback
, *
u£rD©a
 ) { 
¹­i_
->
	`£tE¼ÜC®lback
Ó¼ÜC®lback, u£rD©a); 
	}
}

570 #ià!
defšed
(
__LINUX_ALSA__
è&& !defšed(
__UNIX_JACK__
è&& !defšed(
__MACOSX_CORE__
è&& !defšed(
__WINDOWS_MM__
)

571 
	#__RTMIDI_DUMMY__


	)

574 #ià
defšed
(
__MACOSX_CORE__
)

576 şas 
	cMidiInCÜe
: 
public
 
MidiInApi


578 
public
:

579 
MidiInCÜe
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 );

580 ~
MidiInCÜe
( );

581 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
MACOSX_CORE
; };

582 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

583 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

584 
	`şo£PÜt
( );

585 
	`g‘PÜtCouÁ
( );

586 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

588 
´Ùeùed
:

589 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

590 
	}
};

592 şas 
	cMidiOutCÜe
: 
public
 
MidiOutApi


594 
public
:

595 
MidiOutCÜe
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 );

596 ~
MidiOutCÜe
( );

597 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
MACOSX_CORE
; };

598 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

599 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

600 
	`şo£PÜt
( );

601 
	`g‘PÜtCouÁ
( );

602 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

603 
	`£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 );

605 
´Ùeùed
:

606 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

607 
	}
};

611 #ià
defšed
(
__UNIX_JACK__
)

613 şas 
	cMidiInJack
: 
public
 
MidiInApi


615 
public
:

616 
MidiInJack
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 );

617 ~
MidiInJack
( );

618 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
UNIX_JACK
; };

619 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

620 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

621 
	`şo£PÜt
( );

622 
	`g‘PÜtCouÁ
( );

623 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

625 
´Ùeùed
:

626 
¡d
::
¡ršg
 
ş›ÁName
;

628 
	`cÚÃù
( );

629 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

630 
	}
};

632 şas 
	cMidiOutJack
: 
public
 
MidiOutApi


634 
public
:

635 
MidiOutJack
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 );

636 ~
MidiOutJack
( );

637 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
UNIX_JACK
; };

638 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

639 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

640 
	`şo£PÜt
( );

641 
	`g‘PÜtCouÁ
( );

642 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

643 
	`£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 );

645 
´Ùeùed
:

646 
¡d
::
¡ršg
 
ş›ÁName
;

648 
	`cÚÃù
( );

649 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

650 
	}
};

654 #ià
defšed
(
__LINUX_ALSA__
)

656 şas 
	cMidiInAl§
: 
public
 
MidiInApi


658 
public
:

659 
MidiInAl§
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 );

660 ~
MidiInAl§
( );

661 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
LINUX_ALSA
; };

662 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

663 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

664 
	`şo£PÜt
( );

665 
	`g‘PÜtCouÁ
( );

666 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

668 
´Ùeùed
:

669 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

670 
	}
};

672 şas 
	cMidiOutAl§
: 
public
 
MidiOutApi


674 
public
:

675 
MidiOutAl§
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 );

676 ~
MidiOutAl§
( );

677 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
LINUX_ALSA
; };

678 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

679 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

680 
	`şo£PÜt
( );

681 
	`g‘PÜtCouÁ
( );

682 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

683 
	`£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 );

685 
´Ùeùed
:

686 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

687 
	}
};

691 #ià
defšed
(
__WINDOWS_MM__
)

693 şas 
	cMidiInWšMM
: 
public
 
MidiInApi


695 
public
:

696 
MidiInWšMM
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
, 
queueSizeLim™
 );

697 ~
MidiInWšMM
( );

698 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
WINDOWS_MM
; };

699 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

700 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

701 
	`şo£PÜt
( );

702 
	`g‘PÜtCouÁ
( );

703 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

705 
´Ùeùed
:

706 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

707 
	}
};

709 şas 
	cMidiOutWšMM
: 
public
 
MidiOutApi


711 
public
:

712 
MidiOutWšMM
ĞcÚ¡ 
¡d
::
¡ršg
 
ş›ÁName
 );

713 ~
MidiOutWšMM
( );

714 
	mRtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
WINDOWS_MM
; };

715 
	`İ’PÜt
Ğ
pÜtNumb”
, cÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

716 
	`İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 
pÜtName
 );

717 
	`şo£PÜt
( );

718 
	`g‘PÜtCouÁ
( );

719 
¡d
::
¡ršg
 
	`g‘PÜtName
Ğ
pÜtNumb”
 );

720 
	`£ndMes§ge
Ğ
¡d
::
veùÜ
<> *
mes§ge
 );

722 
´Ùeùed
:

723 
	`š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& 
ş›ÁName
 );

724 
	}
};

728 #ià
defšed
(
__RTMIDI_DUMMY__
)

730 şas 
	cMidiInDummy
: 
public
 
MidiInApi


732 
public
:

733 
	$MidiInDummy
ĞcÚ¡ 
¡d
::
¡ršg
 , 
queueSizeLim™
 ) : 
	$MidiInApi
Ğ
queueSizeLim™
 ) { 
”rÜSŒšg_
 = "MidiInDummy: Thi şas ´ovide nØfunùiÚ®™y."; 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
,ƒrrorString_ ); }

734 
RtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
RTMIDI_DUMMY
; 
	}
}

735 
	$İ’PÜt
Ğ, cÚ¡ 
¡d
::
¡ršg
 ) {
	}
}

736 
	$İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 ) {
	}
}

737 
	$şo£PÜt
Ğè{
	}
}

738 
	$g‘PÜtCouÁ
Ğè{  0; 
	}
}

739 
	g¡d
::
¡ršg
 
	$g‘PÜtName
Ğ
pÜtNumb”
 ) {  ""; 
	}
}

741 
	g´Ùeùed
:

742 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& ) {
	}
}

745 şas 
	cMidiOutDummy
: 
public
 
MidiOutApi


747 
public
:

748 
	$MidiOutDummy
ĞcÚ¡ 
¡d
::
¡ršg
 ) { 
”rÜSŒšg_
 = "MidiOutDummy: Thi şas ´ovide nØfunùiÚ®™y."; 
	`”rÜ
Ğ
RtMidiE¼Ü
::
WARNING
,ƒrrorString_ ); }

749 
RtMidi
::
Api
 
	$g‘Cu¼’tApi
Ğè{  
RtMidi
::
RTMIDI_DUMMY
; 
	}
}

750 
	$İ’PÜt
Ğ, cÚ¡ 
¡d
::
¡ršg
 ) {
	}
}

751 
	$İ’Vœtu®PÜt
ĞcÚ¡ 
¡d
::
¡ršg
 ) {
	}
}

752 
	$şo£PÜt
Ğè{
	}
}

753 
	$g‘PÜtCouÁ
Ğè{  0; 
	}
}

754 
	g¡d
::
¡ršg
 
	$g‘PÜtName
Ğè{  ""; 
	}
}

755 
£ndMes§ge
Ğ
¡d
::
veùÜ
<> * ) {}

757 
´Ùeùed
:

758 
	$š™Ÿlize
ĞcÚ¡ 
¡d
::
¡ršg
& ) {
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\advancedsequencer.cpp

1 
	~"../šşude/wÜld.h
"

2 
	~"../šşude/advªûd£qu’ûr.h
"

4 
	~"../šşude/f”—dmuÉ™¿ck.h
"

7 
	~<io¡»am
>

10 
	gAdvªûdSequ’ûr
::
	$AdvªûdSequ’ûr
(
MIDISequ’ûrGUINÙif›r
 *
n
) :

11 
	`nÙif›r
Ğ
n
 ),

12 
	`Œacks
 ( 
Ãw
 
	`MIDIMuÉiT¿ck
 ( 17 ) ),

13 
	`£q
 ( 
Ãw
 
	`MIDISequ’ûr
 ( 
Œacks
, 
nÙif›r
 ) ),

14 
	`mgr
 ( 
Ãw
 
	`MIDIMªag”
 ( 
nÙif›r
, 
£q
 ) ),

16 
	`thru_´oûssÜ
 ( 2 ),

17 
	`thru_Œª¥o£r
(),

18 
	`thru_»chªÃliz”
(),

20 
	`num_m—su»s
 ( 0 ),

21 
	`»³©_¡¬t_m—su»
 ( 0 ),

22 
	`»³©_’d_m—su»
 ( 0 ),

23 
	`»³©_¶ay_mode
 ( 
çl£
 ),

24 
	`fe_lßded
 ( 
çl£
 ),

26 
	`š_pÜt
 (),

27 
	`out_pÜt
 (),

29 
	$ùÜ_ty³
 ( 
CTOR_1
 )

39 
	`S‘ClksP”B—t
 ( 
DEFAULT_CLKS_PER_BEAT
 );

40 
mgr
->
	`S‘O³nPŞicy
(
MIDIMªag”
::
EXT_OPEN
);

41 
	}
}

44 
	gAdvªûdSequ’ûr
::
	$AdvªûdSequ’ûr
(
MIDIMuÉiT¿ck
* 
mÉ
, 
MIDISequ’ûrGUINÙif›r
 *
n
) :

45 
	`nÙif›r
Ğ
n
 ),

46 
	`Œacks
 ( 
mÉ
 ),

47 
	`£q
 ( 
Ãw
 
	`MIDISequ’ûr
 ( 
Œacks
, 
nÙif›r
 ) ),

48 
	`mgr
 ( 
Ãw
 
	`MIDIMªag”
 ( 
nÙif›r
, 
£q
 ) ),

50 
	`thru_´oûssÜ
 ( 2 ),

51 
	`thru_Œª¥o£r
(),

52 
	`thru_»chªÃliz”
(),

54 
	`num_m—su»s
 ( 0 ),

55 
	`»³©_¡¬t_m—su»
 ( 0 ),

56 
	`»³©_’d_m—su»
 ( 0 ),

57 
	`»³©_¶ay_mode
 ( 
çl£
 ),

58 
	`fe_lßded
 ( 
çl£
 ),

60 
	`š_pÜt
 (),

61 
	`out_pÜt
 (),

63 
	$ùÜ_ty³
 ( 
CTOR_2
 )

70 
mgr
->
	`S‘O³nPŞicy
(
MIDIMªag”
::
EXT_OPEN
);

71 
	}
}

74 
	gAdvªûdSequ’ûr
::
	$AdvªûdSequ’ûr
(
MIDIMªag”
 *
mg
) :

75 
	`nÙif›r
Ğ
mg
->
	`G‘Seq
()->
	`G‘S‹
()->
nÙif›r
 ),

76 
	`Œacks
 ( ( 
MIDIMuÉiT¿ck
 * ) ( 
mg
->
	`G‘Seq
()->
	`G‘S‹
()->
muÉ™¿ck
 ) ),

77 
	`£q
 ( 
mgr
->
	`G‘Seq
() ),

78 
	`mgr
 ( 
mg
 ),

80 
	`thru_´oûssÜ
 ( 2 ),

81 
	`thru_Œª¥o£r
(),

82 
	`thru_»chªÃliz”
(),

84 
	`num_m—su»s
 ( 0 ),

85 
	`»³©_¡¬t_m—su»
 ( 0 ),

86 
	`»³©_’d_m—su»
 ( 0 ),

87 
	`»³©_¶ay_mode
 ( 
çl£
 ),

88 
	`fe_lßded
 ( 
çl£
 ),

90 
	`š_pÜt
(),

91 
	`out_pÜt
(),

93 
	$ùÜ_ty³
 ( 
CTOR_3
 )

100 
mgr
->
	`S‘O³nPŞicy
(
MIDIMªag”
::
EXT_OPEN
);

101 
	}
}

104 
	gAdvªûdSequ’ûr
::~
	$AdvªûdSequ’ûr
()

106 
	`Stİ
();

108 iàĞ
ùÜ_ty³
 !ğ
CTOR_3
)

110 
d–‘e
 
mgr
;

111 
d–‘e
 
£q
;

113 iàĞ
ùÜ_ty³
 =ğ
CTOR_1
 )

115 
d–‘e
 
Œacks
;

117 
	}
}

120 
	gAdvªûdSequ’ûr
::
	$S‘OuutPÜt
Ğ
p
)

122 
	`Stİ
();

124 
out_pÜt
 = 
p
;

126 
	}
}

129 
	gAdvªûdSequ’ûr
::
	$S‘IÅutPÜt
Ğ
p
)

131 
	`Stİ
();

133 
š_pÜt
 = 
p
;

135 
	}
}

138 
	gAdvªûdSequ’ûr
::
	$S‘MIDIThruChªÃl
 ( 
chª
 )

140 
thru_»chªÃliz”
.
	`S‘AÎRechª
 ( 
chª
 );

141 
mgr
->
	`AÎNÙesOff
();

142 
	}
}

145 
	gAdvªûdSequ’ûr
::
	$S‘MIDIThruT¿n¥o£
 ( 
v®
 )

147 
thru_Œª¥o£r
.
	`S‘AÎT¿n¥o£
 ( 
v®
 );

148 
mgr
->
	`AÎNÙesOff
();

149 
	}
}

152 
boŞ
 
	gAdvªûdSequ’ûr
::
	$Lßd
 ( cÚ¡ *
âame
 )

154 
»®Çme
[1024];

155 
	`¡rıy
 ( 
»®Çme
, 
âame
 );

156 
ÜigÇm–’
 = ( è
	`¡¾’
 ( 
âame
 );

159 iàĞ
ÜigÇm–’
 > 0 )

161 iàĞ
»®Çme
[
ÜigÇm–’
-1] == '+' )

163 
»®Çme
[
ÜigÇm–’
-1] = 0;

168 
	`Stİ
();

169 
mgr
->
	`AÎNÙesOff
();

170 
Œacks
->
	`CË¬
();

172 ià(
	`LßdMIDIFe
(
»®Çme
, 
Œacks
)) {

173 
fe_lßded
 = 
Œue
;

174 
	`Re£t
();

175 
	`ExŒaùW¬pPos™iÚs
();

178 
fe_lßded
 = 
çl£
;

180  
fe_lßded
;

181 
	}
}

184 
	gAdvªûdSequ’ûr
::
	$UnLßd
()

186 
Œacks
->
	`CË¬
();

187 
	`Re£t
();

188 
w¬p_pos™iÚs
.
	`ş—r
();

189 
num_m—su»s
 = 0;

190 
fe_lßded
 = 
çl£
;

191 
	`S‘ClksP”B—t
(
DEFAULT_CLKS_PER_BEAT
);

192 
	}
}

195 
	gAdvªûdSequ’ûr
::
	$Re£t
()

197 
	`Stİ
();

198 
MIDITim”
::
	`Wa™
(500);

201 
mgr
->
	`Re£t
();

202 
£q
->
	`Re£t
();

203 
£q
->
	`GoToZ”o
();

204 
	`S‘TempoSÿË
 (1.00);

205 
	`S‘R•—tPÏy
(
çl£
, 0, 0);

206 
	}
}

209 
	gAdvªûdSequ’ûr
::
	$GoToZ”o
() {

210 iàĞ!
fe_lßded
 )

215 
	`Stİ
();

216 
£q
->
	`GoToZ”o
();

217 
	}
}

220 
	gAdvªûdSequ’ûr
::
	$GoToTime
 (
MIDIClockTime
 
t
) {

221 iàĞ!
fe_lßded
 )

230 
w¬p_to_™em
 = 0;

231  ; 
w¬p_to_™em
 < 
w¬p_pos™iÚs
.
	`size
(); warp_to_item++ )

233 iàĞ
w¬p_pos™iÚs
[
w¬p_to_™em
].
cur_şock
 > 
t
 )

238 iàĞ
w¬p_to_™em
 =ğ
w¬p_pos™iÚs
.
	`size
() && warp_to_item != 0 )

240 
w¬p_to_™em
--;

243 ià(
mgr
->
	`IsSeqPÏy
())

245 
	`Stİ
();

246 
£q
->
	`S‘S‹
 (&
w¬p_pos™iÚs
[
w¬p_to_™em
]);

247 
£q
->
	`GoToTime
 (
t
);

248 
	`PÏy
();

252 
£q
->
	`S‘S‹
 (&
w¬p_pos™iÚs
[
w¬p_to_™em
]);

253 
£q
->
	`GoToTime
 (
t
);

254 
i
 = 0; i < 
£q
->
	`G‘NumT¿cks
(); ++i)

256 
£q
->
	`G‘T¿ckS‹
 ( 
i
 )->
nÙe_m©rix
.
	`CË¬
();

259 
	}
}

262 
	gAdvªûdSequ’ûr
::
	$GoToM—su»
 ( 
m—su»
, 
b—t
 )

264 iàĞ!
fe_lßded
 )

272 
w¬p_to_™em
 = 
m—su»
 / 
MEASURES_PER_WARP
;

274 iàĞ
w¬p_to_™em
 >ğ
w¬p_pos™iÚs
.
	`size
() )

275 
w¬p_to_™em
 = 
w¬p_pos™iÚs
.
	`size
() - 1;

277 iàĞ
mgr
->
	`IsSeqPÏy
() )

279 
	`Stİ
();

280 
£q
->
	`S‘S‹
 ( &
w¬p_pos™iÚs
[
w¬p_to_™em
] );

281 
£q
->
	`GoToM—su»
 ( 
m—su»
, 
b—t
 );

282 
	`PÏy
();

287 
£q
->
	`S‘S‹
 ( &
w¬p_pos™iÚs
[
w¬p_to_™em
] );

288 
£q
->
	`GoToM—su»
 ( 
m—su»
, 
b—t
 );

289  
i
 = 0; i < 
£q
->
	`G‘NumT¿cks
(); ++i )

291 
£q
->
	`G‘T¿ckS‹
 ( 
i
 )->
nÙe_m©rix
.
	`CË¬
();

294 
	}
}

297 
	gAdvªûdSequ’ûr
::
	$PÏy
 ()

299 iàĞ!
fe_lßded
 )

304 
	`Stİ
();

305 iàĞ
»³©_¶ay_mode
 )

307 
	`GoToM—su»
 ( 
»³©_¡¬t_m—su»
 );

310 
	`C©chEv’tsBefÜe
();

315 
mgr
->
	`SeqPÏy
();

316 
	}
}

319 
	gAdvªûdSequ’ûr
::
	$Stİ
()

321 iàĞ!
fe_lßded
 )

326 iàĞ!
mgr
->
	`IsSeqStİ
() )

328 
mgr
->
	`SeqStİ
();

329 
mgr
->
	`AÎNÙesOff
();

330 
mgr
->
	`Re£t
();

331 
	`GoToM—su»
(
£q
->
	`G‘S‹
()->
cur_m—su»
, seq->G‘S‹()->
cur_b—t
);

334 
	}
}

338 
	gAdvªûdSequ’ûr
::
	$OuutMes§ge
(
MIDITimedMes§ge
& 
msg
) {

339 
boŞ
 
was_İ’
 = 
Œue
;

340 
MIDIOutDriv”
* 
driv”
 = 
mgr
->
	`G‘OutDriv”
(0);

341 ià(!
driv”
->
	`IsPÜtO³n
()) {

342 
was_İ’
 = 
çl£
;

343 
driv”
->
	`O³nPÜt
();

345 
driv”
->
	`OuutMes§ge
(
msg
);

346 ià(!
was_İ’
)

347 
mgr
->
	`G‘OutDriv”
(0)->
	`Clo£PÜt
();

348 
	}
}

351 
	gAdvªûdSequ’ûr
::
	$S‘R•—tPÏy
 ( 
boŞ
 
’abË
, 
¡¬t_m—su»
, 
’d_m—su»
 )

353 iàĞ!
fe_lßded
 )

358 iàĞ
¡¬t_m—su»
 < 
’d_m—su»
 && start_measure >= 0 )

360 
»³©_¶ay_mode
 = 
’abË
;

361 
»³©_¡¬t_m—su»
 = 
¡¬t_m—su»
;

362 
»³©_’d_m—su»
 = 
’d_m—su»
;

367 
»³©_¶ay_mode
 = 
çl£
;

370 
mgr
->
	`S‘R•—tPÏy
 (

371 
»³©_¶ay_mode
,

372 
»³©_¡¬t_m—su»
,

373 
»³©_’d_m—su»


376 ià(
	`IsPÏy
())

378 
	`PÏy
();

380 
	}
}

389 
	gAdvªûdSequ’ûr
::
	$SŞoT¿ck
 (
Œk
) {

390 ià(!
fe_lßded
)

393 ià(
	`IsPÏy
())

396 
	`C©chEv’tsBefÜe
(
Œk
);

397 
£q
->
	`S‘SŞoMode
 (
Œue
, 
Œk
);

398 
i
 = 0; i < 
£q
->
	`G‘NumT¿cks
(); ++i) {

399 ià(
i
 =ğ()
Œk
) ;

400 
mgr
->
	`G‘OutDriv”
(0)->
	`AÎNÙesOff
(
	`FšdFœ¡ChªÃlOnT¿ck
(
i
));

401 
£q
->
	`G‘T¿ckS‹
 (
i
)->
nÙe_m©rix
.
	`CË¬
();

403 
	}
}

406 
	gAdvªûdSequ’ûr
::
	$UnSŞoT¿ck
() {

407 ià(!
fe_lßded
)

409 ià(
	`IsPÏy
())

411 
	`C©chEv’tsBefÜe
();

412 
£q
->
	`S‘SŞoMode
 (
çl£
);

413 
	}
}

416 
	gAdvªûdSequ’ûr
::
	$S‘T¿ckMu‹
 (
Œk
, 
boŞ
 
f
) {

417 ià(!
fe_lßded
)

419 
£q
->
	`G‘T¿ckProûssÜ
 (
Œk
)->
mu‹
 = 
f
;

420 ià(
	`IsPÏy
()) {

421 ià(
f
)

422 
mgr
->
	`G‘OutDriv”
(0)->
	`AÎNÙesOff
Ğ
	`FšdFœ¡ChªÃlOnT¿ck
(
Œk
) );

425 
	`C©chEv’tsBefÜe
(
Œk
);

427 
	}
}

430 
	gAdvªûdSequ’ûr
::
	$Unmu‹AÎT¿cks
() {

431 ià(!
fe_lßded
)

433 
i
 = 0; i < 
£q
->
	`G‘NumT¿cks
(); ++i) {

434 ià(
£q
->
	`G‘T¿ckProûssÜ
(
i
)->
mu‹
) {

435 
£q
->
	`G‘T¿ckS‹
 ( 
i
 )->
nÙe_m©rix
.
	`CË¬
();

436 
£q
->
	`G‘T¿ckProûssÜ
 (
i
)->
mu‹
 = 
çl£
;

439 
mgr
->
	`AÎNÙesOff
();

440 ià(
	`IsPÏy
())

442 
	`C©chEv’tsBefÜe
();

443 
	}
}

446 
MIDIClockTime
 
	gAdvªûdSequ’ûr
::
	$G‘Cu¼’tMIDIClockTime
() const {

447 
MIDIClockTime
 
time
 = 
£q
->
	`G‘Cu¼’tMIDIClockTime
();

448 ià(
mgr
->
	`IsSeqPÏy
()) {

449 
ms_off£t
 = 
mgr
->
	`G‘Cu¼’tTimeInMs
(è- 
£q
->GetCurrentTimeInMs();

450 
ms_³r_şock
 = 60000.0 / (
£q
->
	`G‘S‹
()->
‹mpobpm
 *

451 
£q
->
	`G‘Cu¼’tTempoSÿË
(è* 
Œacks
->
	`G‘ClksP”B—t
());

452 
time
 +ğ(
MIDIClockTime
)(
ms_off£t
 / 
ms_³r_şock
);

454  
time
;

455 
	}
}

458 
	gAdvªûdSequ’ûr
::
	$G‘Cu¼’tTimeInMs
() const {

460 ià(
mgr
->
	`IsSeqPÏy
())

461  
mgr
->
	`G‘Cu¼’tTimeInMs
();

463  
£q
->
	`G‘Cu¼’tTimeInMs
();

464 
	}
}

467 
boŞ
 
	gAdvªûdSequ’ûr
::
	$S‘ClksP”B—t
 (
ıb
) {

468 ià(
fe_lßded
)

470  
çl£
;

471 
Œacks
->
	`S‘ClksP”B—t
(
ıb
);

472 
£q
->
	`G‘S‹
()->
	`Re£t
();

473  
Œue
;

474 
	}
}

477 
	gAdvªûdSequ’ûr
::
	$G‘M—su»
() const {

478 ià(!
fe_lßded
)

480  
£q
->
	`G‘Cu¼’tM—su»
();

481 
	}
}

484 
	gAdvªûdSequ’ûr
::
	$G‘B—t
() const {

485 ià(!
fe_lßded
)

487  
£q
->
	`G‘Cu¼’tB—t
();

488 
	}
}

491 
	gAdvªûdSequ’ûr
::
	$G‘TimeSigNum”©Ü
() const {

492 ià(!
fe_lßded
)

494  
£q
->
	`G‘S‹
 ()->
timesig_num”©Ü
;

495 
	}
}

498 
	gAdvªûdSequ’ûr
::
	$G‘TimeSigD’omš©Ü
() const {

499 ià(!
fe_lßded
)

501  
£q
->
	`G‘S‹
 ()->
timesig_d’omš©Ü
;

502 
	}
}

505 
	gAdvªûdSequ’ûr
::
	$G‘KeySigSh¬pFÏt
() const {

506 ià(!
fe_lßded
)

508  
£q
->
	`G‘S‹
 ()->
keysig_sh¬pæ©
;

509 
	}
}

512 
	gAdvªûdSequ’ûr
::
	$G‘KeySigMode
() const {

513 ià(!
fe_lßded
)

515  
£q
->
	`G‘S‹
 ()->
keysig_mode
;

516 
	}
}

519 
	gAdvªûdSequ’ûr
::
	$G‘T¿ckNÙeCouÁ
 (
Œk
) const {

520 ià(!
fe_lßded
 || 
mgr
->
	`IsSeqStİ
())

523  
£q
->
	`G‘T¿ckS‹
 ( 
Œk
 )->
nÙe_m©rix
.
	`G‘TÙ®CouÁ
();

524 
	}
}

527 
	g¡d
::
¡ršg
 
AdvªûdSequ’ûr
::
	$G‘T¿ckName
 (
Œk
) const {

528 ià(!
fe_lßded
)

530  
£q
->
	`G‘T¿ckS‹
 (
Œk
)->
Œack_Çme
;

531 
	}
}

534 
	gAdvªûdSequ’ûr
::
	$G‘T¿ckVŞume
 (
Œk
) const {

535 ià(!
fe_lßded
)

537  
£q
->
	`G‘T¿ckS‹
 (
Œk
)->
vŞume
;

538 
	}
}

541 
	gAdvªûdSequ’ûr
::
	$G‘T¿ckProg¿m
 (
Œk
) const {

542 ià(!
fe_lßded
)

544  
£q
->
	`G‘T¿ckS‹
 ( 
Œk
 )->
´og¿m
;

545 
	}
}

548 
	gAdvªûdSequ’ûr
::
	$S‘T¿ckV–oc™ySÿË
 (
Œk
, 
sÿË
) {

549 ià(!
fe_lßded
)

551 
sÿË
 *= 100;

552 
£q
->
	`G‘T¿ckProûssÜ
 (
Œk
)->
v–oc™y_sÿË
 = (è
sÿË
;

553 
	}
}

556 
	gAdvªûdSequ’ûr
::
	$G‘T¿ckV–oc™ySÿË
 (
Œk
) const {

557 ià(!
fe_lßded
)

559  
£q
->
	`G‘T¿ckProûssÜ
 (
Œk
)->
v–oc™y_sÿË
 * 0.01;

560 
	}
}

563 
	gAdvªûdSequ’ûr
::
	$S‘T¿ckRechªÃlize
 (
Œk
, 
chª
) {

564 ià(!
fe_lßded
)

566 
£q
->
	`G‘T¿ckProûssÜ
 (
Œk
)->
»chªÃl
 = 
chª
;

567 
mgr
->
	`AÎNÙesOff
();

568 
£q
->
	`G‘T¿ckS‹
 (
Œk
)->
nÙe_m©rix
.
	`CË¬
();

569 
	}
}

572 
	gAdvªûdSequ’ûr
::
	$G‘T¿ckRechªÃlize
 (
Œk
) const {

573 ià(!
fe_lßded
)

575  
£q
->
	`G‘T¿ckProûssÜ
 (
Œk
)->
»chªÃl
;

576 
	}
}

579 
	gAdvªûdSequ’ûr
::
	$S‘T¿ckT¿n¥o£
 (
Œk
, 
Œªs
) {

580 ià(!
fe_lßded
)

582 
boŞ
 
was_¶ayšg
 = 
mgr
->
	`IsSeqPÏy
();

583 ià(
was_¶ayšg
)

584 
mgr
->
	`SeqStİ
();

586 ià(
Œk
 == -1)

587 
i
 = 0; i < 
£q
->
	`G‘NumT¿cks
(); ++i )

588 
£q
->
	`G‘T¿ckProûssÜ
 ( 
Œk
 )->
Œª¥o£
 = 
Œªs
;

590 
£q
->
	`G‘T¿ckProûssÜ
 ( 
Œk
 )->
Œª¥o£
 = 
Œªs
;

592 ià(
was_¶ayšg
) {

593 
mgr
->
	`AÎNÙesOff
();

594 
£q
->
	`G‘T¿ckS‹
 (
Œk
)->
nÙe_m©rix
.
	`CË¬
();

595 
mgr
->
	`SeqPÏy
();

597 
	}
}

600 
	gAdvªûdSequ’ûr
::
	$G‘T¿ckT¿n¥o£
 (
Œk
) const {

601 ià(!
fe_lßded
)

603  
£q
->
	`G‘T¿ckProûssÜ
 (
Œk
)->
Œª¥o£
;

604 
	}
}

607 
	g¡d
::
¡ršg
 
AdvªûdSequ’ûr
::
	$G‘Cu¼’tM¬k”
() const {

608 ià(!
fe_lßded
)

610  
£q
->
	`G‘S‹
()->
m¬k”_‹xt
;

611 
	}
}

613 
	gAdvªûdSequ’ûr
::
	$S‘Chªged
() {

615 
boŞ
 
was_¶ayšg
 = 
çl£
;

616 ià(
	`IsPÏy
()) {

617 
was_¶ayšg
 = 
Œue
;

618 
	`Stİ
();

620 
fe_lßded
 = 
Œue
;

621 
	`ExŒaùW¬pPos™iÚs
();

622 ià(
was_¶ayšg
)

623 
	`PÏy
();

624 
	}
}

633 
	gAdvªûdSequ’ûr
::
	$FšdFœ¡ChªÃlOnT¿ck
 ( 
Œk
 )

635 
fœ¡_chªÃl
 = -1;

636 iàĞ!
fe_lßded
 || 
Œk
 >ğ
	`G‘NumT¿cks
() )

638  
fœ¡_chªÃl
;

641 
MIDIT¿ck
 *
t
 = 
Œacks
->
	`G‘T¿ck
 ( 
Œk
 );

643 iàĞ
t
 )

648 
i
 = 0; i < 
t
->
	`G‘NumEv’ts
(); ++i)

650 
MIDITimedMes§ge
 *
msg
 = 
t
->
	`G‘Ev’tAdd»ss
 ( 
i
 );

652 iàĞ
msg
 )

654 iàĞ
msg
->
	`IsChªÃlMsg
() )

656 
fœ¡_chªÃl
 = 
msg
->
	`G‘ChªÃl
();

662  
fœ¡_chªÃl
;

663 
	}
}

707 
	gAdvªûdSequ’ûr
::
	$ExŒaùW¬pPos™iÚs
()

709 iàĞ!
fe_lßded
 )

711 
w¬p_pos™iÚs
.
	`ş—r
();

715 
	`Stİ
();

718 
MIDIClockTime
 
cur_time
 = 
£q
->
	`G‘Cu¼’tMIDIClockTime
();

721 
boŞ
 
nÙif›r_mode
 = 
çl£
;

723 iàĞ
nÙif›r
 )

725 
nÙif›r_mode
 = 
nÙif›r
->
	`G‘EÇbË
();

726 
nÙif›r
->
	`S‘EÇbË
 ( 
çl£
 );

729 
num_w¬p_pos™iÚs
 = 0;

730  
£q
->
	`GoToM—su»
 ( 
num_w¬p_pos™iÚs
 * 
MEASURES_PER_WARP
 ) )

734 iàĞ
num_w¬p_pos™iÚs
 < 
w¬p_pos™iÚs
.
	`size
() )

736 
w¬p_pos™iÚs
[
num_w¬p_pos™iÚs
] = *
£q
->
	`G‘S‹
();

740 
w¬p_pos™iÚs
.
	`push_back
Ğ
	`MIDISequ’ûrS‹
Ğ*
£q
->
	`G‘S‹
() ) );

742 
num_w¬p_pos™iÚs
++;

744  
w¬p_pos™iÚs
.
	`size
(è> 
num_w¬p_pos™iÚs
 )

747 
w¬p_pos™iÚs
.
	`pİ_back
();

751 
num_m—su»s
 = (
num_w¬p_pos™iÚs
 - 1è* 
MEASURES_PER_WARP
;

752 
£q
->
	`GoToM—su»
Ğ
num_m—su»s
 + 1 ))

754 
num_m—su»s
++;

757 
£q
->
	`GoToTime
Ğ
cur_time
 );

760 iàĞ
nÙif›r
 )

762 
nÙif›r
->
	`S‘EÇbË
 ( 
nÙif›r_mode
 );

764 
nÙif›r
->
	`NÙify
 ( 
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
 );

766 
	}
}

769 
	gAdvªûdSequ’ûr
::
	$C©chEv’tsBefÜe
()

771 
MIDITimedMes§ge
 
msg
;

772 
MIDITimedMes§ge
 *
msgp
;

773 
MIDIMuÉiT¿ckI‹¿tÜ
 
	`™”
Ğ
£q
->
	`G‘S‹
()->
muÉ™¿ck
 );

774 
Œk
;

775 
ev’ts_£Á
 = 0;

777 ià(
	`G‘Cu¼’tMIDIClockTime
() == 0)

779 
¡d
::
cout
 << "C©chƒv’t befÜ¡¬‹d ..." << std::
’dl
;

781 
™”
.
	`GoToTime
( 0 );

782 ià(!
mgr
->
	`G‘OutDriv”
(0)->
	`IsPÜtO³n
())

783 
mgr
->
	`G‘OutDriv”
(0)->
	`O³nPÜt
();

784  
™”
.
	`G‘CurEv’t
Ğ&
Œk
, &
msgp
 ) && msgp->
	`G‘Time
(è< 
£q
->
	`G‘Cu¼’tMIDIClockTime
() )

786 
msg
 = *
msgp
;

787 ià(
msg
.
	`IsCÚŒŞChªge
() &&

788 ! (
msg
.
	`IsVŞumeChªge
(è|| msg.
	`IsPªChªge
()) &&

789 !
	`G‘T¿ckMu‹
(
Œk
))

792 
	`OuutMes§ge
(
msg
);

793 
ev’ts_£Á
++;

796 iàĞ
msg
.
	`IsSysEx
() )

798 
	`OuutMes§ge
(
msg
);

799 
MIDITim”
::
	`Wa™
( 10 );

800 
ev’ts_£Á
++;

803 ià(!
msg
.
	`IsChªÃlMsg
(è&& !msg.
	`IsM‘aEv’t
())

806 
	`OuutMes§ge
Ğ
msg
 );

807 
ev’ts_£Á
++;

809 
™”
.
	`GoToNextEv’t
();

812 
i
 = 1; i < 
	`G‘NumT¿cks
(); i++) {

813 ià(!
	`G‘T¿ckMu‹
(
i
)) {

814 
chªÃl
 = 
	`FšdFœ¡ChªÃlOnT¿ck
(
i
);

815 ià(
chªÃl
 == -1)

817 cÚ¡ 
MIDISequ’ûrT¿ckS‹
* 
¡©e
 = 
£q
->
	`G‘T¿ckS‹
(
i
);

818 
msg
.
	`S‘Prog¿mChªge
(
chªÃl
, 
¡©e
->
´og¿m
);

819 
	`OuutMes§ge
(
msg
);

820 
msg
.
	`S‘VŞumeChªge
(
chªÃl
, 
¡©e
->
vŞume
);

821 
	`OuutMes§ge
(
msg
);

822 
msg
.
	`S‘PªChªge
(
chªÃl
, 
¡©e
->
·n
);

823 
	`OuutMes§ge
(
msg
);

824 
msg
.
	`S‘P™chB’d
(
chªÃl
, 
¡©e
->
b’d”_v®ue
);

825 
	`OuutMes§ge
(
msg
);

826 
ev’ts_£Á
 += 4;

831 
¡d
::
cout
 << "C©chEv’tsBefÜfšished:ƒv’t £Á: " << 
ev’ts_£Á
 << std::
’dl
;

834 
	}
}

837 
	gAdvªûdSequ’ûr
::
	$C©chEv’tsBefÜe
(
Œk
) {

838 
MIDITimedMes§ge
 
msg
;

839 
MIDIT¿ck
* 
t
 = 
Œacks
->
	`G‘T¿ck
(
Œk
);

841 
i
 = 0; i < 
t
->
	`G‘NumEv’ts
(); ++i )

843 
msg
 = 
t
->
	`G‘Ev’t
Ğ
i
 );

844 iàĞ
msg
.
	`G‘Time
(è>ğ
£q
->
	`G‘Cu¼’tMIDIClockTime
() )

849 ià(
msg
.
	`IsChªÃlMsg
())

851 iàĞ
msg
.
	`IsCÚŒŞChªge
(è|| msg.
	`IsProg¿mChªge
(è|| msg.
	`IsP™chB’d
() )

853 
	`OuutMes§ge
(
msg
);

857 iàĞ
msg
.
	`IsM‘aEv’t
() )

859 iàĞ
msg
.
	`IsTempo
() )

861 
	`OuutMes§ge
(
msg
);

865 iàĞ
msg
.
	`IsSysEx
() )

867 
	`OuutMes§ge
(
msg
);

868 
MIDITim”
::
	`Wa™
( 10 );

873 
	`OuutMes§ge
Ğ
msg
 );

876 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\driver.cpp

26 
	~"../šşude/wÜld.h
"

27 
	~"../šşude/driv”.h
"

28 
	~"../šşude/tim”.h
"

32 
	gMIDIOutDriv”
::
	$MIDIOutDriv”
(
id
è: 
	`´oûssÜ
(0), 
	`pÜt_id
(id), 
	$busy
(0) {

33 
pÜt
 = 
Ãw
 
RtMidiOut
;

34 
	}
}

37 
	gMIDIOutDriv”
::~
	$MIDIOutDriv”
() {

38 
pÜt
->
	`şo£PÜt
();

39 
d–‘e
 
pÜt
;

40 
	}
}

43 
	gMIDIOutDriv”
::
	$O³nPÜt
() {

44 ià(!
pÜt
->
	`isPÜtO³n
()) {

45 
pÜt
->
	`İ’PÜt
(
pÜt_id
);

46 #ià
DRIVER_USES_MIDIMATRIX


47 
out_m©rix
.
	`CË¬
();

49 
¡d
::
cout
 << "PÜˆ" << 
pÜt
->
	`g‘PÜtName
(è<< " o³n" << std::
’dl
;

51 
	}
}

54 
	gMIDIOutDriv”
::
	$Clo£PÜt
() {

55 ià(
pÜt
->
	`isPÜtO³n
()) {

56 
pÜt
->
	`şo£PÜt
();

57 
¡d
::
cout
 << "PÜˆ" << 
pÜt
->
	`g‘PÜtName
(è<< " clo£d" << std::
’dl
;

59 
	}
}

62 
	gMIDIOutDriv”
::
	$AÎNÙesOff
Ğ
chª
 ) {

63 
MIDIMes§ge
 
msg
;

65 
busy
++;

68 #ià
DRIVER_USES_MIDIMATRIX


69 if(
out_m©rix
.
	`G‘ChªÃlCouÁ
(
chª
) > 0) {

70 
nÙe
 = 0;‚ote < 128; ++note) {

71 
out_m©rix
.
	`G‘NÙeCouÁ
(
chª
,
nÙe
) > 0) {

72 
msg
.
	`S‘NÙeOff
(()
chª
, ()
nÙe
, 0);

73 
	`H¬dw¬eMsgOut
(
msg
);

77 
msg
.
	`S‘CÚŒŞChªge
(
chª
,
C_DAMPER
,0 );

78 
	`H¬dw¬eMsgOut
(
msg
);

81 
msg
.
	`S‘AÎNÙesOff
Ğ()
chª
 );

82 
	`H¬dw¬eMsgOut
(
msg
);

85 
busy
--;

86 
	}
}

89 
	gMIDIOutDriv”
::
	$AÎNÙesOff
() {

90 
busy
++;

93 
i
 = 0; i < 16; ++i)

94 
	`AÎNÙesOff
(
i
);

97 
busy
--;

98 
	}
}

101 
	gMIDIOutDriv”
::
	$OuutMes§ge
(cÚ¡ 
MIDITimedMes§ge
& 
msg
) {

102 
MIDITimedMes§ge
 
	`msg_cİy
(
msg
);

104 ià(
´oûssÜ
)

105 
´oûssÜ
->
	`Proûss
(&
msg_cİy
);

107 
i
 = 0;

108  ; 
i
 < 
DRIVER_MAX_RETRIES
; i++) {

109 ià(!
busy
) {

110 
	`H¬dw¬eMsgOut
(
msg_cİy
);

113 
¡d
::
û¼
 << "busy driv” ... " << std::
’dl
;

114 
MIDITim”
::
	`Wa™
(1);

116 ià(
i
 == 100)

117 
¡d
::
û¼
 << "MIDIOutDriv”::OuutMes§ge(èçed!" << std::
’dl
;

118 
	}
}

121 
	gMIDIOutDriv”
::
	$H¬dw¬eMsgOut
(cÚ¡ 
MIDIMes§ge
 &
msg
) {

122 ià(!
pÜt
->
	`isPÜtO³n
())

125 
busy
++;

126 
msg_by‹s
.
	`ş—r
();

127 ià(
msg
.
	`IsChªÃlMsg
()) {

128 #ià
DRIVER_USES_MIDIMATRIX


129 
out_m©rix
.
	`Proûss
 (
msg
);

131 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘Stus
());

132 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘By‹1
());

133 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘By‹2
());

137 ià(
msg
.
	`IsSysEx
()) {

138 
i
 = 0; i < 
msg
.
	`G‘SysEx
()->
	`G‘L’gth
(); i++)

139 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘SysEx
()->
	`G‘D©a
(
i
));

141 
MIDITim”
::
	`Wa™
(
DRIVER_WAIT_AFTER_SYSEX
);

144 
¡d
::
¡ršg
 
s
 = 
msg
.
	`MsgToText
();

145 
msg
.
	`G‘Stus
()) {

146 
MTC
:

147 
SONG_SELECT
:

148 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘Stus
());

149 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘By‹1
());

150 
¡d
::
cout
 << "Driv” s’ˆmes§g... " << 
s
;

152 
SONG_POSITION
:

153 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘Stus
());

154 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘By‹1
());

155 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘By‹2
());

156 
¡d
::
cout
 << "Driv” s’ˆmes§g... " << 
s
;

158 
TUNE_REQUEST
:

159 
RT_TIMING_CLOCK
:

160 
RT_START
:

161 
RT_CONTINUE
:

162 
RT_STOP
:

163 
RT_ACTIVE_SENSE
:

164 
msg_by‹s
.
	`push_back
(
msg
.
	`G‘Stus
());

165 
¡d
::
cout
 << "Driv” s’ˆmes§g... " << 
s
;

167 
¡d
::
cout
 << "Driv” sk³d mes§g... " << 
s
;

172 ià(
msg_by‹s
.
	`size
() > 0)

173 
pÜt
->
	`£ndMes§ge
(&
msg_by‹s
);

175 
busy
--;

176 
	}
}

182 
	gMIDIInDriv”
::
	$MIDIInDriv”
(
id
è: 
	`´oûssÜ
(0), 
	$pÜt_id
(
id
) {

183 
pÜt
 = 
Ãw
 
RtMidiIn
;

184 
	}
}

187 
	gMIDIInDriv”
::~
	$MIDIInDriv”
() {

188 
pÜt
->
	`şo£PÜt
();

189 
d–‘e
 
pÜt
;

190 
	}
}

193 
	gMIDIInDriv”
::
	$O³nPÜt
() {

194 ià(!
pÜt
->
	`isPÜtO³n
()) {

195 
pÜt
->
	`İ’PÜt
(
pÜt_id
);

196 
¡d
::
cout
 << "PÜˆ" << 
pÜt
->
	`g‘PÜtName
(è<< " o³n" << std::
’dl
;

198 
	}
}

201 
	gMIDIInDriv”
::
	$Clo£PÜt
() {

202 ià(
pÜt
->
	`isPÜtO³n
()) {

203 
pÜt
->
	`şo£PÜt
();

204 
¡d
::
cout
 << "PÜˆ" << 
pÜt
->
	`g‘PÜtName
(è<< " clo£d" << std::
’dl
;

206 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\dump_tracks.cpp

26 
	~"../šşude/midi.h
"

27 
	~"../šşude/Œack.h
"

28 
	~"../šşude/muÉ™¿ck.h
"

30 
	~<io¡»am
>

33 
	$DumpMIDITimedMes§ge
 (
MIDITimedMes§ge
* cÚ¡ 
msg
) {

34 ià(
msg
)

35 
¡d
::
cout
 << 
msg
->
	`MsgToText
(è<< std::
’dl
;

36 
	}
}

39 
	$DumpMIDIT¿ck
 (
MIDIT¿ck
* cÚ¡ 
t
) {

40 
MIDITimedMes§ge
 *
msg
;

42 
¡d
::
cout
 << "T¿ck dump" << std::
’dl
;

43 
i
 = 0; i < 
t
->
	`G‘NumEv’ts
(); ++i)

44 
	`DumpMIDITimedMes§ge
 (
t
->
	`G‘Ev’tAdd»ss
 (
i
));

45 
	}
}

48 
	$DumpAÎT¿cks
 (
MIDIMuÉiT¿ck
* cÚ¡ 
mÉ
) {

49 
¡d
::
cout
 << "DUMP OF MIDI MULTITRACK\n";

50 
¡d
::
cout
 << "Clock ³¸b—t: " << 
mÉ
->
	`G‘ClksP”B—t
(è<< "\n" << std::
’dl
;

52 
i
 = 0; i < 
mÉ
->
	`G‘NumT¿cks
(); ++i) {

53 
¡d
::
cout
 << "Dum°oàŒack" << 
i
 << std::
’dl
;

54 
j
 = 0; j < 
mÉ
->
	`G‘T¿ck
(
i
)->
	`G‘NumEv’ts
(); j++)

55 
	`DumpMIDITimedMes§ge
(
mÉ
->
	`G‘T¿ck
 (
i
)->
	`G‘Ev’tAdd»ss
(
j
));

56 
¡d
::
cout
 << std::
’dl
;

58 
	}
}

61 
	$DumpMIDIMuÉiT¿ck
 (
MIDIMuÉiT¿ck
* cÚ¡ 
mÉ
) {

62 
MIDIMuÉiT¿ckI‹¿tÜ
 
	`i
 (
mÉ
);

63 
MIDITimedMes§ge
 *
msg
;

64 
s
[10];

65 
Œk_num
;

67 
¡d
::
cout
 << "DUMP OF MIDI MULTITRACK\n";

68 
¡d
::
cout
 << "Clock ³¸b—t: " << 
mÉ
->
	`G‘ClksP”B—t
(è<< "\n" << std::
’dl
;

70 
i
.
	`GoToTime
 (0);

72 ià(
i
.
	`G‘CurEv’t
 (&
Œk_num
, &
msg
)) {

73 
	`¥rštf
 (
s
, "#%2d - ", 
Œk_num
);

74 
¡d
::
cout
 << 
s
;

75 
	`DumpMIDITimedMes§ge
 (
msg
);

77 } 
i
.
	`GoToNextEv’t
());

78 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\fileread.cpp

43 
	~"../šşude/wÜld.h
"

44 
	~"../šşude/f”—d.h
"

46 
	~<io¡»am
>

53 
	#MIDIFRD_ALLOW_STATUS_ACROSS_META_EVENT
 0

54 

	)

56 
	gMIDIFeR—dSŒ—m
::
	$MIDIFeR—dSŒ—m
(cÚ¡ *
âame
è: 
	$d–
(
Œue
) {

57 
šfs
 = 
Ãw
 
¡d
::
	`if¡»am
(
âame
, std::
ios
::
š
 | std::ios::
bš¬y
);

58 ià(
šfs
->
	`ç
()) {

59 
d–‘e
 
šfs
;

60 
šfs
 = 0;

62 
	}
}

65 
	gMIDIFeR—dSŒ—m
::
	$MIDIFeR—dSŒ—m
(
¡d
::
i¡»am
* 
ifs
è: 
	`šfs
(ifs), 
	$d–
(
çl£
è{
	}
}

68 
	gMIDIFeR—dSŒ—m
::~
	$MIDIFeR—dSŒ—m
() {

69 ià(
šfs
 && 
d–
) {

70 
d–‘e
 
šfs
;

72 
	}
}

75 
	gMIDIFeR—dSŒ—m
::
	$Rewšd
() {

76 
šfs
->
	`£ekg
(0, infs->
beg
);

77 
	}
}

80 
	gMIDIFeR—dSŒ—m
::
	$R—dCh¬
() {

81 
r
 = -1;

83 if(
šfs
 && infs->
	`good
())

84 
r
 = 
šfs
->
	`g‘
();

85  
r
;

86 
	}
}

89 
boŞ
 
	gMIDIFeR—dSŒ—m
::
	$IsV®id
() {

90  
šfs
 != 0;

91 
	}
}

96 
	gMIDIFeEv’tHªdËr
::
	$ChªMes§ge
(cÚ¡ 
MIDITimedMes§ge
 &
msg
) {

97 
msg
.
	`G‘Stus
() & 0xf0) {

98 
NOTE_OFF
:

99 
	`mf_nÙe_off
(
msg
);

101 
NOTE_ON
:

102 if(
msg
.
	`G‘V–oc™y
() == 0)

103 
	`mf_nÙe_off
(
msg
);

105 
	`mf_nÙe_Ú
(
msg
);

107 
POLY_PRESSURE
:

108 
	`mf_pŞy_aá”
(
msg
);

110 
CONTROL_CHANGE
:

111 if(
msg
.
	`G‘By‹2
(è> 
C_ALL_NOTES_OFF
)

112 
	`mf_sy¡em_mode
(
msg
);

114 
	`mf_cÚŒŞ
(
msg
);

116 
PROGRAM_CHANGE
:

117 
	`mf_´og¿m
(
msg
);

119 
CHANNEL_PRESSURE
:

120 
	`mf_chª_aá”
(
msg
);

122 
PITCH_BEND
:

123 
	`mf_b’d”
(
msg
);

126 
	}
}

129 
	gMIDIFeEv’tHªdËr
::
	$M‘aEv’t
(
MIDIClockTime
 
time
, 
ty³
, 
Ëng
, * 
m
) {

130 
ty³
) {

131 
META_SEQUENCE_NUMBER
:

132 
	`mf_m‘a16
(
time
, 
ty³
, 
m
[0], m[1]);

134 
META_GENERIC_TEXT
:

135 
META_COPYRIGHT
:

136 
META_TRACK_NAME
:

137 
META_INSTRUMENT_NAME
:

138 
META_LYRIC_TEXT
:

139 
META_MARKER_TEXT
:

140 
META_CUE_TEXT
:

141 
META_PROGRAM_NAME
:

142 
META_DEVICE_NAME
:

143 
META_GENERIC_TEXT_A
:

144 
META_GENERIC_TEXT_B
:

145 
META_GENERIC_TEXT_C
:

146 
META_GENERIC_TEXT_D
:

147 
META_GENERIC_TEXT_E
:

148 
META_GENERIC_TEXT_F
:

152 
m
[
Ëng
] = 0;

153 
	`mf_‹xt
(
time
,
ty³
, 
Ëng
, 
m
);

155 
META_CHANNEL_PREFIX
:

156 
META_OUTPUT_CABLE
:

158 
	`mf_m‘a16
(
time
, 
ty³
, 
m
[1], 0);

160 
META_END_OF_TRACK
:

161 
	`mf_eÙ
(
time
);

163 
META_TEMPO
:

164 
	`mf_‹mpo
(
time
, 
m
[0], m[1], m[2]);

166 
META_SMPTE
:

167 
	`mf_sm±e
(
time
, 
m
[0], m[1], m[2], m[3], m[4]);

169 
META_TIMESIG
:

170 
	`mf_timesig
(
time
, 
m
[0], m[1], m[2], m[3]);

172 
META_KEYSIG
: {

173 
c
 = 
m
[0];

174 
	`mf_keysig
(
time
, 
c
,
m
[1]);

177 
META_SEQUENCER_SPECIFIC
:

178 
	`mf_sq¥ecific
(
time
, 
Ëng
, 
m
);

181 
	`mf_m‘amisc
(
time
, 
ty³
, 
Ëng
, 
m
);

184 
	}
}

192 
	gMIDIFeR—d”
::
	$MIDIFeR—d”
(
MIDIFeR—dSŒ—m
 *
šput_¡»am_
, 
MIDIFeEv’tHªdËr
 *
ev’t_hªdËr_
,

193 
max_msg_Ën_
) :

194 
	`no_m”ge
(0), 
	`cur_time
(0), 
	`sk_š™
(1), 
	`to_be_»ad
(0),

195 
	`cur_Œack
(0), 
	`abÜt_·r£
(0), 
	`max_msg_Ën
(
max_msg_Ën_
), 
	`msg_šdex
(0),

196 
	`šput_¡»am
(
šput_¡»am_
), 
	$ev’t_hªdËr
(
ev’t_hªdËr_
) {

197 
the_msg
 = 
Ãw
 [
max_msg_Ën
];

198 
	}
}

201 
	gMIDIFeR—d”
::~
	$MIDIFeR—d”
() {

202 
d–‘e
[] 
the_msg
;

203 
	}
}

206 
	gMIDIFeR—d”
::
	$mf_”rÜ
(cÚ¡ *
e
) {

207 
ev’t_hªdËr
->
	`mf_”rÜ
(
e
);

208 
abÜt_·r£
 = 
Œue
;

209 
	}
}

212 
boŞ
 
	gMIDIFeR—d”
::
	$P¬£
() {

213 
n
;

215 
n
 = 
	`R—dH—d”
();

216 if(
n
 <= 0) {

217 
	`mf_”rÜ
( "No Tracks" );

218  
çl£
;

220 
cur_Œack
 = 0; cur_Œack < 
n
; cur_track++) {

221 
	`R—dT¿ck
();

222 ifĞ
abÜt_·r£
 )

223  
çl£
;

225  
Œue
;

226 
	}
}

229 
	gMIDIFeR—d”
::
	$R—dMT
(
ty³
, 
sk
) {

230 
»ad
 = 0;

231 
c
;

233 
»ad
 = 
	`OSTYPE
(
	`EG‘C
(), EGetC(), EGetC(), EGetC());

234 if(
ty³
 !ğ
»ad
) {

235 if(
sk
) {

237 
»ad
 <<= 8;

238 
c
 = 
	`EG‘C
();

239 
»ad
 |ğ
c
;

240 if(
»ad
 =ğ
ty³
)

241  
Œue
;

242 if(
abÜt_·r£
)

243  
çl£
;

244 } 
c
!=-1);

246 
	`mf_”rÜ
( "Error†ooking for chunkype" );

247  
çl£
;

250  
Œue
;

251 
	}
}

254 
	gMIDIFeR—d”
::
	$R—dH—d”
() {

255 
the_fÜm©
;

256 
Árks
;

257 
divisiÚ
;

259 if(
	`R—dMT
(
_MThd
, 
sk_š™
) == 0xffff)

262 if(
abÜt_·r£
)

265 
to_be_»ad
 = 
	`R—d32B™
();

266 
the_fÜm©
 = 
	`R—d16B™
();

267 
Árks
 = 
	`R—d16B™
();

268 
divisiÚ
 = 
	`R—d16B™
();

270 if(
abÜt_·r£
)

273 
h—d”
.
fÜm©
 = 
the_fÜm©
;

274 
h—d”
.
Árks
 =‚trks;

275 
h—d”
.
divisiÚ
 = division;

277 
ev’t_hªdËr
->
	`mf_h—d”
(
the_fÜm©
, 
Árks
, 
divisiÚ
);

279 
¡d
::
cout
 << "MIDI Fe: fÜm© " << 
the_fÜm©
 <<"¿ck " << 
Árks


280 << " divisiÚ " << 
divisiÚ
 << 
¡d
::
’dl
;

282 
to_be_»ad
 > 0)

283 
	`EG‘C
();

285  
Árks
;

286 
	}
}

292 
	gMIDIFeR—d”
::
	$R—dT¿ck
() {

299 
chªty³
[] =

305 
lookfÜ
, 
Êg
;

306 
c
, 
c1
, 
ty³
;

307 
sy£xcÚtšue
 = 0;

308 
ruÂšg
 = 0;

309 
¡©us
 = 0;

310 
Ãeded
;

312 if(
	`R—dMT
(
_MTrk
, 0) == 0xffff)

315 
to_be_»ad
 = 
	`R—d32B™
();

316 
cur_time
 = 0;

318 
ev’t_hªdËr
->
	`mf_¡¬‰¿ck
(
cur_Œack
);

320 
to_be_»ad
 > 0 && !
abÜt_·r£
) {

321 
d–t
 = 
	`R—dV¬ŸbËNum
();

323 
ev’t_hªdËr
->
	`Upd©eTime
(
d–t
);

324 
cur_time
 +ğ
d–t
;

325 
c
 = 
	`EG‘C
();

327 if(
c
 == -1)

329 if(
sy£xcÚtšue
 && 
c
 != 0xf7)

330 
	`mf_”rÜ
( "Error‡fterƒxpected continuation of SysEx" );

331 if((
c
 & 0x80) == 0) {

332 if(
¡©us
 == 0)

333 
	`mf_”rÜ
( "Unexpected Running Status" );

334 
ruÂšg
=1;

335 
Ãeded
 = 
chªty³
[(
¡©us
 >> 4) & 0xf];

340 #ià
MIDIFRD_ALLOW_STATUS_ACROSS_META_EVENT


341 if(
c
 != 0xff) {

342 
¡©us
 = 
c
;

343 
ruÂšg
 = 0;

344 
Ãeded
 = 0;

348 
¡©us
 = 
c
;

349 
ruÂšg
 = 0;

350 
Ãeded
 = 
chªty³
[(
¡©us
 >> 4) & 0xf];

354 if(
Ãeded
) {

355 if(
ruÂšg
)

356 
c1
 = 
c
;

358 
c1
 = 
	`EG‘C
();

359 
	`FÜmChªMes§ge
(()
¡©us
, ()
c1
, ()((
Ãeded
 > 1è? 
	`EG‘C
() : 0 ));

363 
c
) {

365 
ty³
 = 
	`EG‘C
();

366 
Êg
 = 
	`R—dV¬ŸbËNum
();

367 
lookfÜ
 = 
to_be_»ad
 - 
Êg
;

368 
	`MsgIn™
();

369 
to_be_»ad
 > 
lookfÜ
)

370 
	`MsgAdd
Ğ
	`EG‘C
() );

371 
ev’t_hªdËr
->
	`M‘aEv’t
(
cur_time
, 
ty³
, 
msg_šdex
, 
the_msg
);

375 
Êg
 = 
	`R—dV¬ŸbËNum
();

376 
lookfÜ
 = 
to_be_»ad
 - 
Êg
;

377 
	`MsgIn™
();

378 
	`MsgAdd
(0xf0);

379  
to_be_»ad
>
lookfÜ
 )

380 
	`MsgAdd
(
c
 = 
	`EG‘C
());

381 if(
c
 =ğ0xf7 || 
no_m”ge
 == 0) {

384 
MIDISy¡emExşusive
 
	`ex
(
the_msg
, 
msg_šdex
, msg_šdex, 
çl£
);

387 
ev’t_hªdËr
->
	`mf_sy£x
Ğ
cur_time
, 
ex
 );

390 
sy£xcÚtšue
 = 1;

394 
Êg
 = 
	`R—dV¬ŸbËNum
();

395 
lookfÜ
 = 
to_be_»ad
 - 
Êg
;

396 if(!
sy£xcÚtšue
)

397 
	`MsgIn™
();

398 
to_be_»ad
 > 
lookfÜ
)

399 
	`MsgAdd
(
c
 = 
	`EG‘C
());

400 if(!
sy£xcÚtšue
)

401 
ev’t_hªdËr
->
	`mf_¬b™¿ry
(
cur_time
, 
msg_šdex
, 
the_msg
);

402 if(
c
 == 0xf7) {

405 
MIDISy¡emExşusive
 
	`ex
(
the_msg
, 
msg_šdex
, msg_šdex, 
çl£
 );

406 
ev’t_hªdËr
->
	`mf_sy£x
(
cur_time
, 
ex
);

407 
sy£xcÚtšue
 = 0;

411 
	`BadBy‹
(
c
);

415 
ev’t_hªdËr
->
	`mf_’dŒack
(
cur_Œack
);

417 
	}
}

420 
	gMIDIFeR—d”
::
	$R—dV¬ŸbËNum
() {

421 
v®ue
;

422 
c
;

424 
c
 = 
	`EG‘C
();

425 if(
c
 == -1) {

428 
v®ue
 = 
c
;

429 if(
c
 & 0x80) {

430 
v®ue
 &= 0x7f;

432 
c
 = 
	`EG‘C
();

433 
v®ue
 = (v®u<< 7è+ (
c
 & 0x7f);

434 } 
c
 & 0x80);

436  
v®ue
;

437 
	}
}

440 
	gMIDIFeR—d”
::
	$R—d32B™
() {

441 
c1
, 
c2
, 
c3
, 
c4
;

443 
c1
 = 
	`EG‘C
();

444 
c2
 = 
	`EG‘C
();

445 
c3
 = 
	`EG‘C
();

446 
c4
 = 
	`EG‘C
();

447  ( ()
c1
 << 24è+ (()
c2
 << 16)

448 + (()
c3
 << 8è+ (()
c4
 << 0 );

449 
	}
}

452 
	gMIDIFeR—d”
::
	$R—d16B™
() {

453 
c1
, 
c2
;

455 
c1
 = 
	`EG‘C
();

456 
c2
 = 
	`EG‘C
();

457  ((()
c1
 << 8è+ (()
c2
 << 0));

458 
	}
}

461 
	gMIDIFeR—d”
::
	$EG‘C
() {

462 
c
;

464 
c
 = 
šput_¡»am
->
	`R—dCh¬
();

466 if(
c
 < 0) {

467 
	`mf_”rÜ
( "Unexpected Stream Error" );

468 
abÜt_·r£
 = 
Œue
;

471 --
to_be_»ad
;

473  ()
c
;

474 
	}
}

477 
	gMIDIFeR—d”
::
	$MsgAdd
(
a
) {

478 if(
msg_šdex
<
max_msg_Ën
)

479 
the_msg
[
msg_šdex
++] = ()
a
;

480 
	}
}

483 
	gMIDIFeR—d”
::
	$MsgIn™
() {

484 
msg_šdex
 = 0;

485 
	}
}

488 
	gMIDIFeR—d”
::
	$BadBy‹
(
c
) {

489 
	`mf_”rÜ
( "Unexpected Byte" );

490 
abÜt_·r£
 = 
Œue
;

491 
	}
}

494 
	gMIDIFeR—d”
::
	$FÜmChªMes§ge
(
¡
, 
b1
, 
b2
) {

495 
MIDITimedMes§ge
 
m
;

497 
m
.
	`S‘Stus
(
¡
);

498 
m
.
	`S‘By‹1
(
b1
);

499 
m
.
	`S‘By‹2
(
b2
);

500 
m
.
	`S‘Time
(
cur_time
);

501 if(
¡
 >= 0x80 && st < 0xf0 )

502 
ev’t_hªdËr
->
	`ChªMes§ge
(
m
);

503 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\filereadmultitrack.cpp

39 
	~"../šşude/wÜld.h
"

40 
	~"../šşude/f”—dmuÉ™¿ck.h
"

45 
	gMIDIFeR—dMuÉiT¿ck
::
	$MIDIFeR—dMuÉiT¿ck
 (
MIDIMuÉiT¿ck
 *
mÉŒk
) :

46 
	`muÉ™¿ck
(
mÉŒk
), 
	`cur_Œack
(-1è{
	}
}

49 
	gMIDIFeR—dMuÉiT¿ck
::~
	$MIDIFeR—dMuÉiT¿ck
(è{
	}
}

52 
MIDIFeR—dMuÉiT¿ck
::
	$mf_h—d”
 (
fÜm©_
, 
Árks_
, 
divisiÚ_
) {

53 
h—d”
.
fÜm©
 = 
fÜm©_
;

54 
h—d”
.
Árks
 = 
Árks_
;

55 
h—d”
.
divisiÚ
 = 
divisiÚ_
;

57 
muÉ™¿ck
->
	`S‘ClksP”B—t
Ğ
h—d”
.
divisiÚ
 );

58 ià(
h—d”
.
fÜm©
 == 0)

60 
muÉ™¿ck
->
	`CË¬AndResize
(17);

62 
muÉ™¿ck
->
	`CË¬AndResize
(
h—d”
.
Árks
);

63 
	}
}

67 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_sy£x
Ğ
MIDIClockTime
 
time
, cÚ¡ 
MIDISy¡emExşusive
 &
ex
 ) {

68 
MIDITimedMes§ge
 
msg
;

70 
msg
.
	`S‘SysEx
(&
ex
);

71 
msg
.
	`S‘Time
(
time
);

73 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

75 
	}
}

95 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_¬b™¿ry
Ğ
MIDIClockTime
 
time
, 
Ën
, *
d©a
 ) {

97 
	}
}

100 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_m‘amisc
Ğ
MIDIClockTime
 
time
, , , *) {

102 
	}
}

106 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_m‘a16
Ğ
MIDIClockTime
 
time
, 
ty³
, 
b1
, 
b2
 ) {

108 
MIDITimedMes§ge
 
msg
;

110 
msg
.
	`S‘M‘aEv’t
(
ty³
, 
b1
, 
b2
);

111 
msg
.
	`S‘Time
(
time
);

112 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

113 
	}
}

116 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_sm±e
Ğ
MIDIClockTime
 
time
, 
h
, 
m
, 
s
, 
f
, 
sf
 ) {

118 
MIDITimedMes§ge
 
msg
;

120 
msg
.
	`S‘SMPTEOff£t
(
h
, 
m
, 
s
, 
f
, 
sf
);

121 
msg
.
	`S‘Time
(
time
);

122 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

123 
	}
}

126 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_timesig
(
MIDIClockTime
 
time
, 
num
, 
d’om_pow”
,

127 
şks_³r_m‘ro
, 
nÙ©ed_32nd_³r_qu¬‹r
) {

128 
MIDITimedMes§ge
 
msg
;

130 
d’om
ğ1 << 
d’om_pow”
;

132 
msg
.
	`S‘TimeSig
(()
num
, ()
d’om
,

133 ()
şks_³r_m‘ro
, ()
nÙ©ed_32nd_³r_qu¬‹r
);

134 
msg
.
	`S‘Time
(
time
);

144 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

146 
	}
}

149 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_‹mpo
(
MIDIClockTime
 
time
, 
m1
, 
m2
, 
m3
) {

157 
MIDITimedMes§ge
 
msg
;

158 
msg
.
	`S‘M‘aEv’t
(
META_TEMPO
, 0);

159 
msg
.
	`AÎoÿ‹SysEx
(3);

160 
msg
.
	`G‘SysEx
()->
	`PutSysBy‹
(
m1
);

161 
msg
.
	`G‘SysEx
()->
	`PutSysBy‹
(
m2
);

162 
msg
.
	`G‘SysEx
()->
	`PutSysBy‹
(
m3
);

164 
msg
.
	`S‘Time
(
time
);

166 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

168 
	}
}

171 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_keysig
(
MIDIClockTime
 
time
, 
c
, 
v
 ) {

172 
MIDITimedMes§ge
 
msg
;

174 
msg
.
	`S‘KeySig
Ğ()
c
, ()
v
 );

175 
msg
.
	`S‘Time
Ğ
time
 );

177 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

179 
	}
}

182 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_sq¥ecific
Ğ
MIDIClockTime
 
time
, , * ) {

184 
	}
}

187 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_‹xt
Ğ
MIDIClockTime
 
time
, 
ty³
, 
Ën
, *
s
 ) {

188 
MIDITimedMes§ge
 
msg
;

190 
msg
.
	`S‘Stus
(
META_EVENT
);

191 
msg
.
	`S‘M‘aTy³
(()
ty³
);

192 
msg
.
	`S‘Time
(
time
);

193 
msg
.
	`AÎoÿ‹SysEx
(
Ën
);

195  
i
=0; i<
Ën
; ++i )

196 
msg
.
	`G‘SysEx
()->
	`PutSysBy‹
Ğ
s
[
i
] );

198 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

200 
	}
}

203 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_eÙ
Ğ
MIDIClockTime
 
time
 ){

205 ifĞ
cur_Œack
 !ğ-1 && cur_Œack < (sigÃd)
muÉ™¿ck
->
	`G‘NumT¿cks
() ) {

206 
MIDIT¿ck
 *
t
 = 
muÉ™¿ck
->
	`G‘T¿ck
Ğ
cur_Œack
 );

208 ifĞ
t
 )

209 
t
->
	`S‘EndTime
(
time
);

211 
	}
}

214 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_”rÜ
(* 
”r
è{
	}
}

217 
MIDIFeR—dMuÉiT¿ck
::
	$mf_¡¬‰¿ck
 (
Œk
) {

218 
cur_Œack
 = 
Œk
;

219 
	}
}

222 
	gMIDIFeR—dMuÉiT¿ck
::
	$mf_’dŒack
 (
Œk
) {

223 
cur_Œack
 = -1;

224 
	}
}

271 
	gMIDIFeR—dMuÉiT¿ck
::
	$ChªMes§ge
ĞcÚ¡ 
MIDITimedMes§ge
 &
msg
 ) {

272 ifĞ
h—d”
.
fÜm©
 =ğ0 || 
cur_Œack
==0 ) {

276 
muÉ™¿ck
->
	`In£¹Ev’t
(
msg
.
	`G‘ChªÃl
(è+ 1, msg, 
INSMODE_INSERT
);

280 
muÉ™¿ck
->
	`In£¹Ev’t
(
cur_Œack
, 
msg
, 
INSMODE_INSERT
);

283 
	}
}

286 
MIDIFeH—d”
 
	$G‘MIDIFeH—d”
(cÚ¡ * 
f’ame
) {

287 
MIDIFeH—d”
 
h—d”
;

288 
MIDIFeR—dSŒ—m
 
	`mä—d”_¡»am
Ğ
f’ame
 );

289 
MIDIFeEv’tHªdËr
 
dummy_hªdËr
;

290 
MIDIFeR—d”
 
	`»ad”
 (&
mä—d”_¡»am
, &
dummy_hªdËr
);

292 ià(
»ad”
.
	`R—dH—d”
()) {

293 
h—d”
.
fÜm©
 = 
»ad”
.
	`G‘FÜm©
();

294 
h—d”
.
Árks
 = 
»ad”
.
	`G‘Numb”T¿cks
();

295 
h—d”
.
divisiÚ
 = 
»ad”
.
	`G‘DivisiÚ
();

297  
h—d”
;

298 
	}
}

301 
boŞ
 
	$LßdMIDIFe
(cÚ¡ * 
f’ame
, 
MIDIMuÉiT¿ck
* 
Œacks
) {

302 
MIDIFeR—dSŒ—m
 
	`mä—d”_¡»am
 ( 
f’ame
 );

303 
MIDIFeR—dMuÉiT¿ck
 
	`Œack_lßd”
 ( 
Œacks
 );

304 
MIDIFeR—d”
 
	`»ad”
 ( &
mä—d”_¡»am
, &
Œack_lßd”
 );

305  
»ad”
.
	`P¬£
();

306 
	}
}

309 
boŞ
 
	$LßdMIDIFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
MIDIMuÉiT¿ck
* 
Œacks
) {

310  
	`LßdMIDIFe
(
f’ame
.
	`c_¡r
(), 
Œacks
);

311 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\filewrite.cpp

39 
	~"../šşude/wÜld.h
"

40 
	~"../šşude/fewr™e.h
"

44 
	gMIDIFeWr™eSŒ—m
::
	$MIDIFeWr™eSŒ—m
(cÚ¡ *
âame
è: 
	`begš
(0), 
	$d–
(
Œue
) {

45 
outfs
 = 
Ãw
 
¡d
::
	`of¡»am
(
âame
, std::
ios
::
out
 | std::ios::
bš¬y
);

46 ià(!
outfs
->
	`ç
()) {

47 
d–‘e
 
outfs
;

48 
outfs
 = 0;

50 
	}
}

53 
	gMIDIFeWr™eSŒ—m
::
	$MIDIFeWr™eSŒ—m
(
¡d
::
o¡»am
* 
ofs
) :

54 
	`outfs
(
ofs
), 
	`begš
(ofs->
	`‹Îp
()), 
	$d–
(
çl£
è{
	}
}

57 
	gMIDIFeWr™eSŒ—m
::~
	$MIDIFeWr™eSŒ—m
() {

58 ià(
outfs
 && 
d–
)

59 
d–‘e
 
outfs
;

60 
	}
}

63 
	gMIDIFeWr™eSŒ—m
::
	$S“k
(
pos
, 
wh’û
) {

64 
¡d
::
¡»amoff
 
offs
 = 
pos
;

66 
wh’û
) {

67 
SEEK_SET
:

68 
outfs
->
	`£ekp
(
begš
+
offs
, 
¡d
::
ios_ba£
::
beg
);

70 
SEEK_CUR
:

71 
outfs
->
	`£ekp
(
offs
, 
¡d
::
ios_ba£
::
cur
);

73 
SEEK_END
:

74 
outfs
->
	`£ekp
(
offs
, 
¡d
::
ios_ba£
::
’d
);

77  
outfs
->
	`good
();

78 
	}
}

81 
	gMIDIFeWr™eSŒ—m
::
	$Wr™eCh¬
(
c
) {

82 ià(
outfs
) {

83 
outfs
->
	`put
(
c
);

84  
outfs
->
	`good
() ? 0 : -1;

87 
	}
}

90 
boŞ
 
	gMIDIFeWr™eSŒ—m
::
	$IsV®id
() {

91  
outfs
 != 0;

92 
	}
}

104 
	gMIDIFeWr™”
::
	$MIDIFeWr™”
(
MIDIFeWr™eSŒ—m
 *
out_¡»am_
è: 
	$out_¡»am
(
out_¡»am_
) {

105 
	`ENTER
( "MIDIFileWriter::MIDIFileWriter()" );

107 
fe_Ëngth
 = 0;

108 
”rÜ
 = 0;

109 
Œack_Ëngth
 = 0;

110 
Œack_time
 = 0;

111 
ruÂšg_¡©us
 = 0;

112 
Œack_pos™iÚ
 = 0;

113 
	}
}

116 
	gMIDIFeWr™”
::~
	$MIDIFeWr™”
() {

117 
	`ENTER
( "MIDIFileWriter::~MIDIFileWriter()" );

118 
	}
}

121 
	gMIDIFeWr™”
::
	$E¼Ü
(*
s
) {

122 
	`ENTER
( "void MIDIFileWriter::Error()" );

126 
”rÜ
 = 
Œue
;

127 
	}
}

130 
	gMIDIFeWr™”
::
	$Wr™eShÜt
(
c
) {

131 
	`ENTER
( "void MIDIFileWriter::WriteShort()" );

133 
	`Wr™eCh¬aù”
(()((
c
 >> 8) & 0xff));

134 
	`Wr™eCh¬aù”
(()((
c
 & 0xff)));

135 
	}
}

138 
	gMIDIFeWr™”
::
	$Wr™e3Ch¬
(
c
) {

139 
	`ENTER
( "void MIDIFileWriter::Write3Char()" );

141 
	`Wr™eCh¬aù”
(()((
c
 >> 16) & 0xff));

142 
	`Wr™eCh¬aù”
(()((
c
 >> 8) & 0xff));

143 
	`Wr™eCh¬aù”
(()((
c
 & 0xff)));

144 
	}
}

147 
	gMIDIFeWr™”
::
	$Wr™eLÚg
(
c
) {

148 
	`ENTER
( "void MIDIFileWriter::WriteLong()" );

150 
	`Wr™eCh¬aù”
(()((
c
 >> 24) & 0xff));

151 
	`Wr™eCh¬aù”
(()((
c
 >> 16) & 0xff));

152 
	`Wr™eCh¬aù”
(()((
c
 >> 8) & 0xff));

153 
	`Wr™eCh¬aù”
(()((
c
 & 0xff)));

154 
	}
}

157 
	gMIDIFeWr™”
::
	$Wr™eFeH—d”
(
fÜm©
, 
Árks
, 
divisiÚ
) {

158 
	`ENTER
( "void MIDIFileWriter::WriteFileHeader()" );

160 
	`Wr™eCh¬aù”
(() 'M');

161 
	`Wr™eCh¬aù”
(() 'T');

162 
	`Wr™eCh¬aù”
(() 'h');

163 
	`Wr™eCh¬aù”
(() 'd');

164 
	`Wr™eLÚg
(6);

165 
	`Wr™eShÜt
(()
fÜm©
);

166 
	`Wr™eShÜt
(()
Árks
);

167 
	`Wr™eShÜt
(()
divisiÚ
);

168 
fe_Ëngth
 = 4 + 4 + 6;

169 
	}
}

172 
	gMIDIFeWr™”
::
	$Wr™eT¿ckH—d”
(
Ëngth
) {

173 
	`ENTER
( "void MIDIFileWriter::WriteTrackHeader()" );

175 
Œack_pos™iÚ
 = 
fe_Ëngth
;

176 
Œack_Ëngth
 = 0;

177 
Œack_time
 = 0;

178 
ruÂšg_¡©us
 = 0;

180 
	`Wr™eCh¬aù”
(() 'M');

181 
	`Wr™eCh¬aù”
(() 'T');

182 
	`Wr™eCh¬aù”
(() 'r');

183 
	`Wr™eCh¬aù”
(() 'k');

185 
	`Wr™eLÚg
(
Ëngth
);

186 
fe_Ëngth
 += 8;

187 
w™hš_Œack
 = 
Œue
;

188 
	}
}

191 
	gMIDIFeWr™”
::
	$Wr™eV¬ŸbËNum
(
n
) {

192 
	`ENTER
( "short MIDIFileWriter::WriteVariableNum()" );

194 
bufãr
;

195 
út
 = 0;

197 
bufãr
 = 
n
 & 0x7f;

198 (
n
 >>= 7) > 0) {

199 
bufãr
 <<= 8;

200 
bufãr
 |= 0x80;

201 
bufãr
 +ğ(
n
 & 0x7f);

204 
Œue
) {

205 
	`Wr™eCh¬aù”
((è(
bufãr
 & 0xff));

206 
út
++;

207 if(
bufãr
 & 0x80)

208 
bufãr
 >>= 8;

212  
út
;

213 
	}
}

216 
	gMIDIFeWr™”
::
	$Wr™eD–Time
(
abs_time
) {

217 
	`ENTER
( "void MIDIFileWriter::WriteDeltaTime()" );

219 
dtime
 = 
abs_time
 - 
Œack_time
;

220 if(
dtime
 < 0) {

222 
dtime
 = 0;

225 
	`Inüem’tCouÁ”s
(
	`Wr™eV¬ŸbËNum
(
dtime
));

226 
Œack_time
 = 
abs_time
;

227 
	}
}

277 
	gMIDIFeWr™”
::
	$Wr™eEv’t
(cÚ¡ 
MIDITimedMes§ge
 &
msg
) {

278 if(
msg
.
	`IsNoOp
())

281 if(
msg
.
	`IsChªÃlMsg
())

282 
	`Wr™eChªÃlEv’t
(
msg
);

283 if(
msg
.
	`IsSysEx
())

284 
	`Wr™eSysExEv’t
(
msg
);

285 if(
msg
.
	`IsM‘aEv’t
()) {

289 if(
msg
.
	`G‘SysEx
()) {

290 
	`Wr™eM‘aEv’t
(

291 
msg
.
	`G‘Time
(),

292 
msg
.
	`G‘M‘aTy³
(),

293 
msg
.
	`G‘SysEx
()->
	`G‘Buf
(),

294 
msg
.
	`G‘SysEx
()->
	`G‘L’gth
());

299 if(
msg
.
	`IsD©aEnd
())

300 
	`Wr™eEndOfT¿ck
(
msg
.
	`G‘Time
());

303 
buf
[2];

304 
buf
[0] = 
msg
.
	`G‘By‹2
();

305 
buf
[1] = 
msg
.
	`G‘By‹3
();

306 
Ën
;

307 
msg
.
	`G‘M‘aTy³
()) {

308 
META_SEQUENCE_NUMBER
:

309 
META_KEYSIG
:

310 
Ën
 = 2;

312 
META_CHANNEL_PREFIX
:

313 
META_OUTPUT_CABLE
:

315 
Ën
 = 1;

318 
Ën
 = 0;

320 
	`Wr™eM‘aEv’t
(

321 
msg
.
	`G‘Time
(), msg.
	`G‘M‘aTy³
(), 
buf
, 
Ën
);

327 
	}
}

386 
	gMIDIFeWr™”
::
	$Wr™eChªÃlEv’t
(cÚ¡ 
MIDITimedMes§ge
 &
msg
) {

387 
Ën
 = 
msg
.
	`G‘L’gth
();

389 if(
Ën
 > 0) {

390 
	`Wr™eD–Time
(
msg
.
	`G‘Time
());

391 if(
msg
.
	`G‘Stus
(è!ğ
ruÂšg_¡©us
) {

392 
ruÂšg_¡©us
 = 
msg
.
	`G‘Stus
();

393 
	`Wr™eCh¬aù”
(()
ruÂšg_¡©us
);

394 
	`Inüem’tCouÁ”s
(1);

396 if(
Ën
 > 1) {

397 
	`Wr™eCh¬aù”
((è
msg
.
	`G‘By‹1
());

398 
	`Inüem’tCouÁ”s
(1);

400 if(
Ën
 > 2) {

401 
	`Wr™eCh¬aù”
((è
msg
.
	`G‘By‹2
());

402 
	`Inüem’tCouÁ”s
(1);

405 
	}
}

408 
	gMIDIFeWr™”
::
	$Wr™eSysExEv’t
(cÚ¡ 
MIDITimedMes§ge
 &
msg
) {

409 
	`ENTER
( "void MIDIFileWriter::WriteSysExEvent()" );

411 
	`Wr™eD–Time
(
msg
.
	`G‘Time
());

413 
Ën
 = 
msg
.
	`G‘SysEx
()->
	`G‘L’gth
();

414 
	`Wr™eCh¬aù”
(()
SYSEX_START
);

415 
	`Inüem’tCouÁ”s
(
	`Wr™eV¬ŸbËNum
(
Ën
 - 1));

417 
i
 = 1; i < 
Ën
; i++)

418 
	`Wr™eCh¬aù”
(()(
msg
.
	`G‘SysEx
()->
	`G‘D©a
(
i
)));

419 
	`Inüem’tCouÁ”s
(
Ën
);

420 
ruÂšg_¡©us
 = 0;

421 
	}
}

445 
	gMIDIFeWr™”
::
	$Wr™eM‘aEv’t
(
time
, 
ty³
, cÚ¡ *
d©a
, 
Ëngth
) {

446 
	`ENTER
( "void MIDIFileWriter::WriteMetaEvent()" );

448 
	`Wr™eD–Time
(
time
);

449 
	`Wr™eCh¬aù”
(() 0xff);

450 
	`Wr™eCh¬aù”
((è
ty³
);

452 
	`Inüem’tCouÁ”s
(2);

454 
	`Inüem’tCouÁ”s
(
	`Wr™eV¬ŸbËNum
(
Ëngth
));

456 
i
 = 0; i < 
Ëngth
; i++)

457 
	`Wr™eCh¬aù”
((è
d©a
[
i
]);

458 
	`Inüem’tCouÁ”s
(
Ëngth
);

459 
ruÂšg_¡©us
 = 0;

460 
	}
}

513 
	gMIDIFeWr™”
::
	$Wr™eEndOfT¿ck
(
time
) {

514 
	`ENTER
( "void MIDIFileWriter::WriteEndOfTrack()" );

516 if(
w™hš_Œack
 =ğ
Œue
) {

517 if(
time
 == 0)

518 
time
 = 
Œack_time
;

519 
	`Wr™eD–Time
(
time
);

520 
	`Wr™eCh¬aù”
(() 0xff);

521 
	`Wr™eCh¬aù”
(() 0x2f);

522 
	`Wr™eCh¬aù”
(() 0x00);

523 
	`Inüem’tCouÁ”s
(3);

524 
w™hš_Œack
 = 
çl£
;

525 
ruÂšg_¡©us
 = 0;

527 
	}
}

530 
	gMIDIFeWr™”
::
	$Rewr™eT¿ckL’gth
() {

531 
	`ENTER
( "void MIDIFileWriter::RewriteTrackLength()" );

537 
	`S“k
(
Œack_pos™iÚ
 + 4);

538 
	`Wr™eLÚg
(
Œack_Ëngth
);

539 
	`S“k
(
Œack_pos™iÚ
 + 8 + 
Œack_Ëngth
);

540 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\filewritemultitrack.cpp

31 
	~"../šşude/wÜld.h
"

32 
	~"../šşude/fewr™emuÉ™¿ck.h
"

36 
	gMIDIFeWr™eMuÉiT¿ck
::
	$MIDIFeWr™eMuÉiT¿ck
(cÚ¡ 
MIDIMuÉiT¿ck
 *
mÉ_
, 
MIDIFeWr™eSŒ—m
 *
¡rm_
) :

37 
	`muÉ™¿ck
Ğ
mÉ_
 ), 
	$wr™”
Ğ
¡rm_
 ) {
	}
}

40 
	gMIDIFeWr™eMuÉiT¿ck
::~
	$MIDIFeWr™eMuÉiT¿ck
(è{
	}
}

43 
boŞ
 
MIDIFeWr™eMuÉiT¿ck
::
	$Wr™e
(
num_Œacks
, 
divisiÚ
) {

44 
boŞ
 
f
 = 
Œue
;

46 if(!
	`P»Wr™e
())

47  
çl£
;

50 
wr™”
.
	`Wr™eFeH—d”
(
num_Œacks
 > 1 ? 1 : 0,‚um_Œacks, 
divisiÚ
);

53 
i
 = 0; i < 
num_Œacks
; ++i) {

54 ià(
wr™”
.
	`E¼ÜOccu¼ed
()) {

55 
f
 = 
çl£
;

58 cÚ¡ 
MIDIT¿ck
 *
t
 = 
muÉ™¿ck
->
	`G‘T¿ck
(
i
);

59 
wr™”
.
	`Wr™eT¿ckH—d”
(0);

60 ià(
t
) {

61 
ev’t_num
 = 0;ƒv’t_num < 
t
->
	`G‘NumEv’ts
(); ++event_num) {

62 cÚ¡ 
MIDITimedMes§ge
 *
ev
 = 
t
->
	`G‘Ev’tAdd»ss
(
ev’t_num
);

63 if(
ev
 && !ev->
	`IsNoOp
()) {

64 ià(!
ev
->
	`IsD©aEnd
()) {

65 
wr™”
.
	`Wr™eEv’t
(*
ev
);

66 if(
wr™”
.
	`E¼ÜOccu¼ed
()) {

67 
f
 = 
çl£
;

74 
wr™”
.
	`Wr™eEndOfT¿ck
(0);

75 
wr™”
.
	`Rewr™eT¿ckL’gth
();

78 if(!
	`Po¡Wr™e
())

79  
çl£
;

81  
f
;

82 
	}
}

85 
boŞ
 
	gMIDIFeWr™eMuÉiT¿ck
::
	$P»Wr™e
() {

86  
Œue
;

87 
	}
}

90 
boŞ
 
	gMIDIFeWr™eMuÉiT¿ck
::
	$Po¡Wr™e
() {

91  
Œue
;

92 
	}
}

96 
boŞ
 
	$Wr™eMIDIFe
(cÚ¡ * 
f’ame
, 
fÜm©
, cÚ¡ 
MIDIMuÉiT¿ck
* 
Œacks
) {

97 
MIDIMuÉiT¿ck
 
	`tmp_Œacks
(1, 
Œacks
->
	`G‘ClksP”B—t
());

98 ià(
fÜm©
 == 0) {

99 
MIDIClockTime
 
max_’d_time
 = 0;

100 cÚ¡ 
MIDIT¿ck
* 
cur_Œack
;

101 
i
 = 0; i < 
Œacks
->
	`G‘NumT¿cks
(); i++) {

102 
cur_Œack
 = 
Œacks
->
	`G‘T¿ck
(
i
);

103 ià(
cur_Œack
->
	`G‘EndTime
(è> 
max_’d_time
)

104 
max_’d_time
 = 
cur_Œack
->
	`G‘EndTime
();

105 
j
 = 0; j < 
cur_Œack
->
	`G‘NumEv’ts
(); j++)

106 
tmp_Œacks
.
	`In£¹Ev’t
 (0, 
cur_Œack
->
	`G‘Ev’t
(
j
), 
INSMODE_INSERT
);

108 
tmp_Œacks
.
	`G‘T¿ck
(0)->
	`S‘EndTime
(
max_’d_time
);

110 
MIDIFeWr™eSŒ—m
 
	`wr™e_¡»am
 (
f’ame
);

111 ià(!
wr™e_¡»am
.
	`IsV®id
())

112  
çl£
;

113 cÚ¡ 
MIDIMuÉiT¿ck
* 
tmp_±¿cks
 = (
fÜm©
 =ğ0 ? (cÚ¡ MIDIMuÉiT¿ck *)&
tmp_Œacks
 : 
Œacks
);

114 
MIDIFeWr™eMuÉiT¿ck
 
	`wr™”
 (
tmp_±¿cks
, &
wr™e_¡»am
);

115  
wr™”
.
	`Wr™e
(
tmp_±¿cks
->
	`G‘NumT¿cks
(),mp_±¿cks->
	`G‘ClksP”B—t
());

116 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\manager.cpp

27 
	~<io¡»am
>

29 
	~"../šşude/wÜld.h
"

30 
	~"../šşude/mªag”.h
"

34 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
MIDIMªag”
::
MIDI_out_Çmes
;

35 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
MIDIMªag”
::
MIDI_š_Çmes
;

37 
	gMIDIMªag”
::
	$MIDIMªag”
(

38 
MIDISequ’ûrGUINÙif›r
 *
n
,

39 
MIDISequ’ûr
 *
£q_
 ) :

40 
	`£qu’ûr
(
£q_
),

41 
	`nÙif›r
Ğ
n
 ),

42 
	`sys_time_off£t
(0),

43 
	`£q_time_off£t
(0),

44 
	`¶ay_mode
(
çl£
),

45 
	`¡İ_mode
(
Œue
),

46 
	`thru_’abË
(
çl£
),

47 
	`»³©_¶ay_mode
(
çl£
),

48 
	`»³©_¡¬t_m—su»
(0),

49 
	`»³©_’d_m—su»
(0),

50 
	$İ’_pŞicy
(
AUTO_OPEN
)

53 #ifdeà
WIN32


54 
	`CoIn™ŸlizeEx
(
NULL
, 
COINIT_MULTITHREADED
);

56 
RtMidiOut
 
‹mp_MIDI_out
;

57 
i
 = 0; i < 
‹mp_MIDI_out
.
	`g‘PÜtCouÁ
(); i++) {

58 
MIDI_outs
.
	`push_back
(
Ãw
 
	`MIDIOutDriv”
(
i
));

59 
MIDI_out_Çmes
.
	`push_back
(
‹mp_MIDI_out
.
	`g‘PÜtName
(
i
));

61 
RtMidiIn
 
‹mp_MIDI_š
;

62 
i
 = 0; i < 
‹mp_MIDI_š
.
	`g‘PÜtCouÁ
(); i++) {

63 
MIDI_šs
.
	`push_back
(
Ãw
 
	`MIDIInDriv”
(
i
));

64 
MIDI_š_Çmes
.
	`push_back
(
‹mp_MIDI_š
.
	`g‘PÜtName
(
i
));

66 
tim”
 = 
Ãw
 
	`MIDITim”
();

67 
tim”
->
	`S‘MIDITick
(
TickProc
, 
this
);

68 
	}
}

71 
	gMIDIMªag”
::~
	$MIDIMªag”
() {

72 
i
 = 0; i < 
MIDI_outs
.
	`size
(); i++)

73 
d–‘e
 
MIDI_outs
[
i
];

74 
i
 = 0; i < 
MIDI_šs
.
	`size
(); i++)

75 
d–‘e
 
MIDI_šs
[
i
];

77 #ifdeà
WIN32


78 
	`CoUnš™Ÿlize
();

80 
	}
}

83 
	gMIDIMªag”
::
	$Re£t
() {

84 
	`SeqStİ
();

85 
sys_time_off£t
 = 0;

86 
£q_time_off£t
 = 0;

87 
¶ay_mode
 = 
çl£
;

88 
¡İ_mode
 = 
Œue
;

89 ifĞ
nÙif›r
 )

90 
nÙif›r
->
	`NÙify
(
	`MIDISequ’ûrGUIEv’t
Ğ
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
));

91 
i
 = 0; i < 
MIDI_outs
.
	`size
(); i++)

92 
MIDI_outs
[
i
]->
	`Clo£PÜt
();

93 
i
 = 0; i < 
MIDI_šs
.
	`size
(); i++)

94 
MIDI_šs
[
i
]->
	`Clo£PÜt
();

95 
	}
}

99 
	gMIDIMªag”
::
	$S‘Seq
 ( 
MIDISequ’ûr
 *
£q
 ) {

100 ià(
nÙif›r
)

101 
nÙif›r
->
	`NÙify
 (
	`MIDISequ’ûrGUIEv’t
 (
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
));

102 
£qu’ûr
 = 
£q
;

103 
	}
}

106 
	gMIDIMªag”
::
	$O³nOutPÜts
() {

107 
i
 = 0; i < 
MIDI_outs
.
	`size
(); i++)

108 ià(!
MIDI_outs
[
i
]->
	`IsPÜtO³n
())

109 
MIDI_outs
[
i
]->
	`O³nPÜt
();

110 
	}
}

113 
	gMIDIMªag”
::
	$Clo£OutPÜts
() {

114 
i
 = 0; i < 
MIDI_outs
.
	`size
(); i++)

115 ià(
MIDI_outs
[
i
]->
	`IsPÜtO³n
())

116 
MIDI_outs
[
i
]->
	`Clo£PÜt
();

117 
	}
}

121 
	gMIDIMªag”
::
	$SeqPÏy
() {

122 ià(
£qu’ûr
) {

124 
¡d
::
cout
 << "ThMIDIMªag” i ¡¬tšgh£qu’û¸..." << std::
’dl
;

126 
	`O³nOutPÜts
();

128 
£q_time_off£t
 = (è
£qu’ûr
->
	`G‘Cu¼’tTimeInMs
();

129 
sys_time_off£t
 = 
tim”
->
	`G‘SysTimeMs
();

130 
¡İ_mode
 = 
çl£
;

131 
¶ay_mode
 = 
Œue
;

132 
tim”
->
	`S¹
();

134 ià(
nÙif›r
) {

135 
nÙif›r
->
	`NÙify
 ( 
	`MIDISequ’ûrGUIEv’t
 (

136 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT
,

138 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_MODE


142 
	}
}

145 
	gMIDIMªag”
::
	$SeqStİ
() {

146 ià(
£qu’ûr
 && 
¶ay_mode
 =ğ
Œue
) {

147 
tim”
->
	`Stİ
();

148 
¶ay_mode
 = 
çl£
;

149 
¡İ_mode
 = 
Œue
;

151 ià(
nÙif›r
) {

152 
nÙif›r
->
	`NÙify
 ( 
	`MIDISequ’ûrGUIEv’t
 (

153 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT
,

155 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_MODE


158 ià(
İ’_pŞicy
 =ğ
AUTO_OPEN
)

159 
	`Clo£OutPÜts
();

161 
¡d
::
cout
 << "ThMidiMªag” ha ¡İ³dh£qu’ûr" << std::
’dl
;

163 
	}
}

167 
	gMIDIMªag”
::
	$S‘R•—tPÏy
 ( 
boŞ
 
æag
, 
¡¬t_m—su»
, 
’d_m—su»
 ) {

169 
»³©_¶ay_mode
 = 
çl£
;

170 
»³©_¡¬t_m—su»
 = 
¡¬t_m—su»
;

171 
»³©_’d_m—su»
 = 
’d_m—su»
;

173 
»³©_¶ay_mode
 = 
æag
;

174 
	}
}

177 
	gMIDIMªag”
::
	$AÎNÙesOff
() {

178 
i
 = 0; i < 
MIDI_outs
.
	`size
(); i++)

179 
MIDI_outs
[
i
]->
	`AÎNÙesOff
();

180 
	}
}

183 
	gMIDIMªag”
::
	$TickProc
Ğ
sys_time_
, * 
p
 ) {

185 
MIDIMªag”
* 
mªag”
 = 
¡©ic_ÿ¡
<MIDIMªag” *>(
p
);

186 ifĞ
mªag”
->
¶ay_mode
 )

187 
mªag”
->
	`TimeTickPÏyMode
(
sys_time_
);

188 ifĞ
mªag”
->
¡İ_mode
 )

189 
mªag”
->
	`TimeTickStİMode
(
sys_time_
);

192 
	}
}

307 
	gMIDIMªag”
::
	$TimeTickPÏyMode
Ğ
sys_time_
 )

309 
sys_time
 = ()
sys_time_
 - ()
sys_time_off£t
;

310 
Ãxt_ev’t_time
 = 0.0;

311 
ev_Œack
;

312 
MIDITimedMes§ge
 
ev
;

315 if(
»³©_¶ay_mode
 && 
£qu’ûr
->
	`G‘Cu¼’tM—su»
(è>ğ
»³©_’d_m—su»
) {

318 
MIDI_outs
[0]->
	`AÎNÙesOff
();

321 
£qu’ûr
->
	`GoToM—su»
Ğ
»³©_¡¬t_m—su»
 );

324 
sys_time_off£t
 = 
sys_time_
;

325 
sys_time
 = 0;

329 
£q_time_off£t
 = ()
£qu’ûr
->
	`G‘Cu¼’tTimeInMs
();

335 
ouut_couÁ
=100;

338 
£qu’ûr
->
	`G‘NextEv’tTimeMs
Ğ&
Ãxt_ev’t_time
 )

339 && (
Ãxt_ev’t_time
 - 
£q_time_off£t
è<ğ
sys_time


341 && (--
ouut_couÁ
)>0 ) {

344 if(
£qu’ûr
->
	`G‘NextEv’t
(&
ev_Œack
, &
ev
) &&

345 !
ev
.
	`IsM‘aEv’t
()) {

348 
MIDI_outs
[0]->
	`OuutMes§ge
(
ev
);

349 
ev
.
	`CË¬
();

354 ifĞ!(
»³©_¶ay_mode
 && 
£qu’ûr
->
	`G‘Cu¼’tM—su»
()>=
»³©_’d_m—su»
) &&

355 !
£qu’ûr
->
	`G‘NextEv’tTimeMs
Ğ&
Ãxt_ev’t_time
 ) ) {

357 
¡İ_mode
 = 
Œue
;

358 
¶ay_mode
 = 
çl£
;

360 if(
nÙif›r
) {

361 
nÙif›r
->
	`NÙify
Ğ
	`MIDISequ’ûrGUIEv’t
(

362 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT
,

364 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_MODE


367 
nÙif›r
->
	`NÙify
Ğ
	`MIDISequ’ûrGUIEv’t
(

368 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT
,

370 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_ENDOFSONG


375 
	}
}

378 
	gMIDIMªag”
::
	$TimeTickStİMode
Ğ
sys_time_
 ) {

379 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\matrix.cpp

42 
	~"../šşude/wÜld.h
"

43 
	~"../šşude/m©rix.h
"

45 
	gMIDIM©rix
::
	$MIDIM©rix
()

47  
chªÃl
=0; channel<16; channel++ )

49 
chªÃl_couÁ
[
chªÃl
]=0;

50 
hŞd_³d®
[
chªÃl
]ğ
çl£
;

51  
nÙe
=0;‚ote<128;‚ote++ )

52 
nÙe_Ú_couÁ
[
chªÃl
][
nÙe
]=0;

55 
tÙ®_couÁ
=0;

56 
	}
}

58 
	gMIDIM©rix
::~
	$MIDIM©rix
()

60 
	}
}

63 
MIDIM©rix
::
	$DecNÙeCouÁ
ĞcÚ¡ 
MIDIMes§ge
 &, 
chªÃl
, 
nÙe
 )

65 ifĞ
nÙe_Ú_couÁ
[
chªÃl
][
nÙe
]>0 )

67 --
nÙe_Ú_couÁ
[
chªÃl
][
nÙe
];

68 --
chªÃl_couÁ
[
chªÃl
];

69 --
tÙ®_couÁ
;

71 
	}
}

73 
	gMIDIM©rix
::
	$IncNÙeCouÁ
ĞcÚ¡ 
MIDIMes§ge
 &, 
chªÃl
, 
nÙe
 )

75 ++
nÙe_Ú_couÁ
[
chªÃl
][
nÙe
];

76 ++
chªÃl_couÁ
[
chªÃl
];

77 ++
tÙ®_couÁ
;

78 
	}
}

80 
	gMIDIM©rix
::
	$Oth”Mes§ge
ĞcÚ¡ 
MIDIMes§ge
 & )

82 
	}
}

85 
boŞ
 
MIDIM©rix
::
	$Proûss
ĞcÚ¡ 
MIDIMes§ge
 &
m
 )

87 
boŞ
 
¡©us
=
çl£
;

89 ifĞ
m
.
	`IsChªÃlMsg
() )

91 
chªÃl
=
m
.
	`G‘ChªÃl
();

92 
nÙe
=
m
.
	`G‘NÙe
();

94 ifĞ
m
.
	`IsAÎNÙesOff
() )

96 
	`CË¬ChªÃl
Ğ
chªÃl
 );

97 
¡©us
=
Œue
;

100 ifĞ
m
.
	`IsNÙeOn
() )

102 ifĞ
m
.
	`G‘V–oc™y
()!=0 )

103 
	`IncNÙeCouÁ
Ğ
m
, 
chªÃl
, 
nÙe
 );

105 
	`DecNÙeCouÁ
Ğ
m
, 
chªÃl
, 
nÙe
 );

106 
¡©us
=
Œue
;

109 ifĞ
m
.
	`IsNÙeOff
() )

111 
	`DecNÙeCouÁ
Ğ
m
, 
chªÃl
, 
nÙe
 );

112 
¡©us
=
Œue
;

115 ifĞ
m
.
	`IsCÚŒŞChªge
(è&& m.
	`G‘CÚŒŞËr
()==
C_DAMPER
 )

117 ifĞ
m
.
	`G‘CÚŒŞËrV®ue
() & 0x40 )

119 
hŞd_³d®
[
chªÃl
]=
Œue
;

123 
hŞd_³d®
[
chªÃl
]=
çl£
;

127 
	`Oth”Mes§ge
Ğ
m
 );

129  
¡©us
;

130 
	}
}

132 
	gMIDIM©rix
::
	$CË¬
()

134  
chªÃl
=0; channel<16; ++channel )

136 
	`CË¬ChªÃl
Ğ
chªÃl
 );

138 
tÙ®_couÁ
=0;

139 
	}
}

141 
	gMIDIM©rix
::
	$CË¬ChªÃl
Ğ
chªÃl
 )

143  
nÙe
=0;‚ote<128; ++note )

145 
tÙ®_couÁ
 -ğ
nÙe_Ú_couÁ
[
chªÃl
][
nÙe
];

146 
nÙe_Ú_couÁ
[
chªÃl
][
nÙe
]=0;

148 
chªÃl_couÁ
[
chªÃl
]=0;

149 
hŞd_³d®
[
chªÃl
]=0;

150 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\midi.cpp

35 
	~"../šşude/wÜld.h
"

36 
	~"../šşude/midi.h
"

39 cÚ¡ * 
	$g‘_chª_msg_Çme
(
¡©us
) {

40 cÚ¡ * 
chª_msg_Çmes
[16] = {

57  
chª_msg_Çmes
[
¡©us
 >> 4];

58 
	}
}

60 cÚ¡ * 
	$g‘_chª_mode_Çme
(
¡©us
) {

61 cÚ¡ * 
chª_mode_Çmes
[8] = {

70  
chª_mode_Çmes
[
¡©us
 - 
C_ALL_SOUND_OFF
];

71 
	}
}

74 cÚ¡ * 
	gsys_msg_Çmes
[16] = {

94 cÚ¡ * 
	$g‘_m‘a_Çme
(
b
) {

95 cÚ¡ * 
m‘a_msg_Çmes
[18] {

115 ià(
b
 < 0x08)

116  
m‘a_msg_Çmes
[
b
];

117 
b
) {

119  
m‘a_msg_Çmes
[8];

121  
m‘a_msg_Çmes
[9];

123  
m‘a_msg_Çmes
[10];

125  
m‘a_msg_Çmes
[11];

127  
m‘a_msg_Çmes
[12];

129  
m‘a_msg_Çmes
[13];

131  
m‘a_msg_Çmes
[14];

133  
m‘a_msg_Çmes
[15];

135  
m‘a_msg_Çmes
[16];

137  
m‘a_msg_Çmes
[17];

139 
	}
}

144 cÚ¡ sigÃd 
	glut_msgËn
[16] =

157 cÚ¡ sigÃd 
	glut_sysmsgËn
[16] =

178 cÚ¡ 
boŞ
 
	glut_is_wh™e
[12] =

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\msg.cpp

43 
	~"../šşude/wÜld.h
"

44 
	~"../šşude/sy£x.h
"

45 
	~"../šşude/msg.h
"

55 
	g¡d
::
¡ršg
 
MIDIMes§ge
::
	$MsgToText
 () const {

56 
buf
[256];

57 
¡d
::
¡ršg
 
txt
;

60 ià(
	`IsM‘aEv’t
()) {

61 
	`¥rštf
 (
buf
, "% ", 
sys_msg_Çmes
[
¡©us
 - 0xF0]);

62 
txt
 +ğ
buf
;

63 
txt
 +ğ
	`g‘_m‘a_Çme
(
by‹1
);

65 
by‹1
) {

67 
META_SEQUENCE_NUMBER
:

68 
	`¥rštf
 (
buf
, "D©¨%02X ", (()
by‹2
 >> 8è+ 
by‹3
);

71 
META_GENERIC_TEXT
:

72 
META_COPYRIGHT
:

73 
META_TRACK_NAME
:

74 
META_INSTRUMENT_NAME
:

75 
META_LYRIC_TEXT
:

76 
META_MARKER_TEXT
:

77 
META_CUE_TEXT
:

78 
META_PROGRAM_NAME
:

79 
META_DEVICE_NAME
:

80 
META_GENERIC_TEXT_A
:

81 
META_GENERIC_TEXT_B
:

82 
META_GENERIC_TEXT_C
:

83 
META_GENERIC_TEXT_D
:

84 
META_GENERIC_TEXT_E
:

85 
META_GENERIC_TEXT_F
:

86 
	`¥rštf
(
buf
, "\"%s\"", 
	`G‘Text
().
	`c_¡r
());

87 ià(
	`¡¾’
(
buf
) > 40)

88 
buf
[40] = 0;

91 
META_CHANNEL_PREFIX
:

92 
META_OUTPUT_CABLE
:

93 
	`¥rštf
(
buf
, "D©¨%2d", 
by‹2
);

97 
META_END_OF_TRACK
:

98 *
buf
 = 0;

101 
META_TEMPO
:

102 
	`¥rštf
(
buf
, "BpM %3.2f", 
	`G‘Tempo
());

105 
META_SMPTE
:

106 
	`¥rštf
(
buf
, "Data %02d %02d %02d %02d %02d",

107 
sy£x
->
	`G‘D©a
(0), sysex->GetData(1), sysex->GetData(2),

108 
sy£x
->
	`G‘D©a
(3), sysex->GetData(4));

111 
META_TIMESIG
:

112 
	`¥rštf
(
buf
, "Time %d/%d (Other data %02d %02d)",

113 
	`G‘TimeSigNum”©Ü
(), 
	`G‘TimeSigD’omš©Ü
(),

114 
sy£x
->
	`G‘D©a
(2), sysex->GetData(3));

117 
META_KEYSIG
:

119 
	`¥rštf
(
buf
, "D©¨%02d %02d", 
by‹2
, 
by‹3
);

123 *
buf
 = 0;

126 
txt
 +ğ
buf
;

130 ià(
	`IsSysEx
()) {

131 
	`¥rštf
 (
buf
, "% ", 
sys_msg_Çmes
[
¡©us
 - 0xF0]);

132 
txt
 +ğ
buf
;

133 ià(
	`G‘SysEx
()->
	`IsGMRe£t
())

134 
	`¥rštf
(
buf
, "GM Reset");

135 ià(
	`G‘SysEx
()->
	`IsGSRe£t
())

136 
	`¥rštf
(
buf
, "GS Reset");

137 ià(
	`G‘SysEx
()->
	`IsXGRe£t
())

138 
	`¥rštf
(
buf
, "XG Reset");

140 
	`¥rštf
 (
buf
, "Ö’gth: %d)", 
	`G‘SysEx
()->
	`G‘L’gth
());

141 
txt
 +ğ
buf
;

147 
	`¥rštf
 (
buf
, "Ch %2d ", (è
	`G‘ChªÃl
() + 1);

148 
txt
 +ğ
buf
;

150 ià(
	`IsChªÃlMode
()) {

151 
	`¥rštf
 (
buf
, "% ", 
	`g‘_chª_mode_Çme
(
	`G‘Ty³
()));

152 
txt
 +ğ
buf
;

153 ià(
	`G‘Ty³
(è=ğ
C_LOCAL
)

154 
txt
 +ğ(
by‹1
 ? " On" : " Off");

157 
	`¥rštf
 (
buf
, "%  ", 
	`g‘_chª_msg_Çme
(
	`G‘Ty³
()));

158 
txt
 +ğ
buf
;

159 
¡©us
 & 0xf0) {

160 
NOTE_ON
:

161 ià(
	`G‘V–oc™y
() == 0)

162 
	`¥rštf
 (
buf
, "NÙ%3d V– %3d (NÙOffè ", (è
by‹1
, (è
by‹2
);

164 
	`¥rštf
 (
buf
, "NÙ%3d V– %3d ", (è
by‹1
, (è
by‹2
);

167 
NOTE_OFF
:

168 
	`¥rštf
 (
buf
, "NÙ%3d V– %3d ", (è
by‹1
, (è
by‹2
 );

171 
POLY_PRESSURE
:

172 
	`¥rštf
 (
buf
, "NÙ%3d P» %3d ", (è
by‹1
, (è
by‹2
 );

175 
CONTROL_CHANGE
:

176 
	`¥rštf
 (
buf
, "CŒÈ%3d V® %3d ", ( è
by‹1
, ( è
by‹2
 );

179 
PROGRAM_CHANGE
:

180 
	`¥rštf
 (
buf
, "Prog %3d ", (è
by‹1
);

183 
CHANNEL_PRESSURE
:

184 
	`¥rštf
 (
buf
, "P» %3d ", (è
by‹1
 );

187 
PITCH_BEND
:

188 
	`¥rštf
 (
buf
, "V® %5d ", (è
	`G‘B’d”V®ue
() );

191 
txt
 +ğ
buf
;

194  
txt
;

195 
	}
}

202 
	gMIDIMes§ge
::
	$MIDIMes§ge
(è: 
	`¡©us
(0), 
	`by‹1
(0), 
	`by‹2
(0è, 
	`by‹3
(0), 
	$sy£x
(0)

203 {
	}
}

206 
	gMIDIMes§ge
::
	$MIDIMes§ge
(cÚ¡ 
MIDIMes§ge
 &
msg
) :

207 
	`¡©us
(
msg
.
¡©us
), 
	`by‹1
(msg.
by‹1
), 
	`by‹2
(msg.
by‹2
), 
	`by‹3
(msg.
by‹3
), 
	$sy£x
(0) {

208 if(
msg
.
sy£x
)

209 
sy£x
 = 
Ãw
 
	`MIDISy¡emExşusive
(*
msg
.sysex);

210 
	}
}

213 
	gMIDIMes§ge
::~
	$MIDIMes§ge
() {

214 
	`CË¬SysEx
();

215 
	}
}

218 
	gMIDIMes§ge
::
	$CË¬
() {

219 
¡©us
 = 
by‹1
 = 
by‹2
 = 
by‹3
 = 0;

220 
	`CË¬SysEx
();

221 
	}
}

224 
	gMIDIMes§ge
::
	$CË¬SysEx
() {

225 ià(
sy£x
) {

226 
d–‘e
 
sy£x
;

227 
sy£x
 = 0;

229 
	}
}

235 cÚ¡ 
	gMIDIMes§ge
& MIDIMes§ge::
İ”©Ü
ğ(cÚ¡ 
MIDIMes§ge
 &
msg
) {

236 
¡©us
 = 
msg
.status,

237 
	gby‹1
 = 
msg
.
by‹1
;

238 
	gby‹2
 = 
msg
.
by‹2
;

239 
	gby‹3
 = 
msg
.
by‹3
;

240 
CË¬SysEx
();

241 if(
	gmsg
.
	gsy£x
)

242 
	gsy£x
 = 
Ãw
 
MIDISy¡emExşusive
(*
msg
.
sy£x
);

243  *
	gthis
;

252 
	gMIDIMes§ge
::
	$G‘L’gth
() const {

253 if((
¡©us
 & 0xf0) == 0xf0)

254  
	`G‘Sy¡emMes§geL’gth
(
¡©us
);

256  
	`G‘Mes§geL’gth
(
¡©us
);

257 
	}
}

260 
	gMIDIMes§ge
::
	$G‘Tempo
() const {

261 
‹mpo_bpm
 = 60.0 * 1.0e6 / 
	`G‘IÁ”ÇlTempo
();

262  
‹mpo_bpm
;

263 
	}
}

266 
	gMIDIMes§ge
::
	$G‘IÁ”ÇlTempo
() const {

267 
miüo£cs_³r_b—t
 = 
sy£x
->
	`G‘D©a
(0);

268 
miüo£cs_³r_b—t
 <<= 8;

269 
miüo£cs_³r_b—t
 +ğ
sy£x
->
	`G‘D©a
(1);

270 
miüo£cs_³r_b—t
 <<= 8;

271 
miüo£cs_³r_b—t
 +ğ
sy£x
->
	`G‘D©a
(2);

272  
miüo£cs_³r_b—t
;

273 
	}
}

276 
	g¡d
::
¡ršg
 
MIDIMes§ge
::
	$G‘Text
() const {

277 
¡d
::
¡ršg
 
s
;

278 
i
 = 0; i < 
sy£x
->
	`G‘L’gth
(); i++)

279 
s
 +ğ
sy£x
->
	`G‘D©a
(
i
);

280  
s
;

281 
	}
}

288 
	gMIDIMes§ge
::
	$S‘B’d”V®ue
(
v
) {

289 
x
 = ()(
v
 + 8192);

290 
by‹1
 = ()(
x
 & 0x7f);

291 
by‹2
 = ()((
x
 >> 7) & 0x7f);

292 
	}
}

295 
	gMIDIMes§ge
::
	$S‘M‘aV®ue
(
v
) {

296 
by‹2
 = ()(
v
 & 0xff);

297 
by‹3
 = ()((
v
 >> 8) & 0xff);

298 
	}
}

301 
	gMIDIMes§ge
::
	$S‘NÙeOn
(
chª
, 
nÙe
, 
v–
) {

302 
¡©us
 = ()(
chª
 | 
NOTE_ON
);

303 
by‹1
 = 
nÙe
;

304 
by‹2
 = 
v–
;

305 
by‹3
 = 0;

306 
	`CË¬SysEx
();

307 
	}
}

310 
	gMIDIMes§ge
::
	$S‘NÙeOff
(
chª
, 
nÙe
, 
v–
) {

311 
¡©us
 = ()(
chª
 | 
NOTE_OFF
);

312 
by‹1
 = 
nÙe
;

313 
by‹2
 = 
v–
;

314 
by‹3
 = 0;

315 
	`CË¬SysEx
();

316 
	}
}

319 
	gMIDIMes§ge
::
	$S‘PŞyP»ssu»
(
chª
, 
nÙe
, 
´es
) {

320 
¡©us
 = ()(
chª
 | 
POLY_PRESSURE
);

321 
by‹1
 = 
nÙe
;

322 
by‹2
 = 
´es
;

323 
by‹3
 = 0;

324 
	`CË¬SysEx
();

325 
	}
}

328 
	gMIDIMes§ge
::
	$S‘CÚŒŞChªge
(
chª
, 
ù¾
, 
v®
) {

329 
¡©us
 = ()(
chª
 | 
CONTROL_CHANGE
);

330 
by‹1
 = 
ù¾
;

331 
by‹2
 = 
v®
;

332 
by‹3
 = 0;

333 
	`CË¬SysEx
();

334 
	}
}

337 
	gMIDIMes§ge
::
	$S‘Prog¿mChªge
(
chª
, 
´og
) {

338 
¡©us
 = ()(
chª
 | 
PROGRAM_CHANGE
);

339 
by‹1
 = 
´og
;

340 
by‹2
 = 0;

341 
by‹3
 = 0;

342 
	`CË¬SysEx
();

343 
	}
}

346 
	gMIDIMes§ge
::
	$S‘ChªÃlP»ssu»
(
chª
, 
´es
) {

347 
¡©us
 = ()(
chª
 | 
CHANNEL_PRESSURE
);

348 
by‹1
 = 
´es
;

349 
by‹2
 = 0;

350 
by‹3
 = 0;

351 
	`CË¬SysEx
();

352 
	}
}

355 
	gMIDIMes§ge
::
	$S‘P™chB’d
(
chª
, 
v®
) {

356 
¡©us
 = ()(
chª
 | 
PITCH_BEND
);

357 
v®
 += ()0x2000;

358 
by‹1
 = ()(
v®
 & 0x7f);

359 
by‹2
 = ()((
v®
 >> 7) & 0x7f);

360 
by‹3
 = 0;

361 
	`CË¬SysEx
();

362 
	}
}

365 
	gMIDIMes§ge
::
	$S‘SysEx
(cÚ¡ 
MIDISy¡emExşusive
* 
£
) {

366 
¡©us
=
SYSEX_START
;

367 
by‹1
 = 0;

368 
by‹2
 = 0;

369 
by‹3
 = 0;

370 
	`CİySysEx
(
£
);

371 
	}
}

374 
	gMIDIMes§ge
::
	$S‘MTC
(
f›ld
, 
v®
) {

375 
¡©us
 = 
MTC
;

376 
by‹1
 = ()((
f›ld
 << 4è| 
v®
);

377 
by‹2
 = 0;

378 
by‹3
 = 0;

379 
	`CË¬SysEx
();

380 
	}
}

383 
	gMIDIMes§ge
::
	$S‘SÚgPos™iÚ
(
pos
) {

384 
¡©us
 = 
SONG_POSITION
;

385 
by‹1
 = ()(
pos
 & 0x7f);

386 
by‹2
 = ()((
pos
 >> 7) & 0x7f);

387 
by‹3
 = 0;

388 
	`CË¬SysEx
();

389 
	}
}

392 
	gMIDIMes§ge
::
	$S‘SÚgS–eù
(
¢g
) {

393 
¡©us
 = 
SONG_SELECT
;

394 
by‹1
 = 
¢g
;

395 
by‹2
 = 0;

396 
by‹3
 = 0;

397 
	`CË¬SysEx
();

398 
	}
}

401 
	gMIDIMes§ge
::
	$S‘Sy¡emMes§ge
(
ty³
) {

402 
¡©us
 = 
ty³
;

403 
by‹1
 = 0;

404 
by‹2
 = 0;

405 
by‹3
 = 0;

406 
	`CË¬SysEx
();

407 
	}
}

410 
	gMIDIMes§ge
::
	$S‘M‘aEv’t
(
ty³
, 
v1
, 
v2
) {

411 
¡©us
 = 
META_EVENT
;

412 
by‹1
 = 
ty³
;

413 
by‹2
 = 
v1
;

414 
by‹3
 = 
v2
;

415 
	`CË¬SysEx
();

416 
	}
}

419 
	gMIDIMes§ge
::
	$S‘M‘aEv’t
(
ty³
, 
v®
) {

420 
¡©us
 = 
META_EVENT
;

421 
by‹1
 = 
ty³
;

422 
by‹2
 = ()(
v®
 & 0xff);

423 
by‹3
 = ()((
v®
 >> 8) & 0xff);

424 
	`CË¬SysEx
();

425 
	}
}

428 
	gMIDIMes§ge
::
	$S‘Text
(cÚ¡ * 
‹xt
, 
ty³
) {

429 
	`S‘M‘aEv’t
(
ty³
, 0);

430 
	`AÎoÿ‹SysEx
(
	`¡¾’
(
‹xt
));

431 
i
 = 0; i < 
	`¡¾’
(
‹xt
); ++i)

432 
sy£x
->
	`PutSysBy‹
(
‹xt
[
i
]);

433 
	}
}

436 
	gMIDIMes§ge
::
	$S‘Tempo
(
‹mpo_bpm
) {

437 
	`S‘M‘aEv’t
(
META_TEMPO
, 0);

438 
	`AÎoÿ‹SysEx
(3);

439 
miüo£cs_³r_b—t
 = ()(60.0 * 1.0e6 / 
‹mpo_bpm
);

441 
sy£x
->
	`PutSysBy‹
((
miüo£cs_³r_b—t
 >> 16) & 0xff);

442 
sy£x
->
	`PutSysBy‹
((
miüo£cs_³r_b—t
 >> 8) & 0xff);

443 
sy£x
->
	`PutSysBy‹
(
miüo£cs_³r_b—t
 & 0xff);

444 
	}
}

447 
	gMIDIMes§ge
::
	$S‘SMPTEOff£t
(
hour
, 
mš
, 
£c
,

448 
äame
,
subäame
) {

449 
	`S‘M‘aEv’t
(
META_SMPTE
, 0);

450 
	`AÎoÿ‹SysEx
(5);

451 
sy£x
->
	`PutSysBy‹
(
hour
);

452 
sy£x
->
	`PutSysBy‹
(
mš
);

453 
sy£x
->
	`PutSysBy‹
(
£c
);

454 
sy£x
->
	`PutSysBy‹
(
äame
);

455 
sy£x
->
	`PutSysBy‹
(
subäame
);

456 
	}
}

459 
	gMIDIMes§ge
::
	$S‘TimeSig
(
num
, 
d’
,

460 
şocks_³r_m‘rÚome
, 
num_32_³r_qu¬‹r
) {

461 
	`S‘M‘aEv’t
(
META_TIMESIG
, 
num
, 
d’
);

462 
	`AÎoÿ‹SysEx
(4);

463 
pow”_of_2
 = 0;

464 
d’
 > 1) {

465 
pow”_of_2
++;

466 
d’
 >>= 1;

468 ià(
şocks_³r_m‘rÚome
 == 0)

469 
şocks_³r_m‘rÚome
 = 24 * 4 / 
by‹3
;

470 
sy£x
->
	`PutSysBy‹
(
num
);

471 
sy£x
->
	`PutSysBy‹
(
pow”_of_2
);

472 
sy£x
->
	`PutSysBy‹
(
şocks_³r_m‘rÚome
);

473 
sy£x
->
	`PutSysBy‹
(
num_32_³r_qu¬‹r
);

474 
	}
}

477 
	gMIDIMes§ge
::
	$AÎoÿ‹SysEx
(
Ën
) {

478 
	`CË¬SysEx
();

479 
sy£x
 = 
Ãw
 
	`MIDISy¡emExşusive
(
Ën
);

480 
	}
}

483 
	gMIDIMes§ge
::
	$CİySysEx
(cÚ¡ 
MIDISy¡emExşusive
* 
£
) {

484 
	`CË¬SysEx
();

485 ià(
£
)

486 
sy£x
 = 
Ãw
 
	`MIDISy¡emExşusive
(*
£
);

487 
	}
}

490 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
MIDIMes§ge
 &
m1
, cÚ¡ 
	gMIDIMes§ge
 &
	gm2
) {

491 ià(
	gm1
.
	g¡©us
 !ğ
m2
.
¡©us
 ||

492 
m1
.
by‹1
 !ğ
m2
.byte1 ||

493 
m1
.
by‹2
 !ğ
m2
.byte2 ||

494 
m1
.
by‹3
 !ğ
m2
.byte3)

495  
çl£
;

496 ià((
	gm1
.
	gsy£x
 =ğ0 && 
m2
.
sy£x
 != 0) ||

497 (
m1
.
sy£x
 !ğ0 && 
m2
.sysex == 0))

498  
çl£
;

499  (*
	gm1
.
	gsy£x
 =ğ*
m2
.
sy£x
);

508 
	g¡d
::
¡ršg
 
MIDITimedMes§ge
::
	$MsgToText
() const {

509 
buf
[256];

510 
¡d
::
¡ršg
 
txt
;

512 
	`¥rštf
 (
buf
, "%8ld : ", 
	`G‘Time
());

513 
txt
 +ğ
buf
;

514 
txt
 +ğ
MIDIMes§ge
::
	`MsgToText
();

515  
txt
;

516 
	}
}

523 
	gMIDITimedMes§ge
::
	$MIDITimedMes§ge
(è: 
	$time
(0è{
	}
}

526 
MIDITimedMes§ge
::
	$MIDITimedMes§ge
(cÚ¡ 
MIDITimedMes§ge
 &
msg
)

527 : 
	`MIDIMes§ge
(
msg
), 
	$time
(
msg
.
time
)

528 {
	}
}

531 
	gMIDITimedMes§ge
::
	$MIDITimedMes§ge
(cÚ¡ 
MIDIMes§ge
 &
msg
)

532 : 
	`MIDIMes§ge
(
msg
), 
	$time
(0)

533 {
	}
}

536 
	gMIDITimedMes§ge
::~
	$MIDITimedMes§ge
()

537 {
	}
}

540 
MIDITimedMes§ge
::
	$CË¬
() {

541 
time
 = 0;

542 
MIDIMes§ge
::
	`CË¬
();

543 
	}
}

550 cÚ¡ 
	gMIDITimedMes§ge
 &MIDITimedMes§ge::
İ”©Ü
ğ(cÚ¡ 
MIDITimedMes§ge
 &
msg
) {

551 
time
 = 
msg
.time;

552 
	gMIDIMes§ge
::
İ”©Ü
ğ(
msg
);

553  *
	gthis
;

557 cÚ¡ 
	gMIDITimedMes§ge
 &MIDITimedMes§ge::
İ”©Ü
ğ(cÚ¡ 
MIDIMes§ge
 &
msg
) {

558 
time
 = 0;

559 
	gMIDIMes§ge
::
İ”©Ü
ğ(
msg
);

560  *
	gthis
;

564 
	gMIDITimedMes§ge
::
	$Com·»Ev’tsFÜIn£¹
 (cÚ¡ 
MIDITimedMes§ge
 &
m1
, cÚ¡ MIDITimedMes§g&
m2
) {

565 
boŞ
 
n1
 = 
m1
.
	`IsNoOp
();

566 
boŞ
 
n2
 = 
m2
.
	`IsNoOp
();

569 iàĞ
n1
 && 
n2
 )

571 iàĞ
n1
 )

573 iàĞ
n2
 )

576 iàĞ
m1
.
	`G‘Time
(è> 
m2
.GetTime() )

579 iàĞ
m2
.
	`G‘Time
(è> 
m1
.GetTime() )

582 
n1
 = 
m1
.
	`IsD©aEnd
();

583 
n2
 = 
m2
.
	`IsD©aEnd
();

585 iàĞ
n1
 && 
n2
 )

587 iàĞ
n1
 )

589 iàĞ
n2
 )

592 
n1
 = 
m1
.
	`IsM‘aEv’t
();

593 
n2
 = 
m2
.
	`IsM‘aEv’t
();

595 ià(
n1
 && 
n2
)

597 ià(
n1
)

599 ià(
n2
)

603 
n1
 = 
m1
.
	`IsSysEx
();

604 
n2
 = 
m2
.
	`IsSysEx
();

606 iàĞ
n1
 && 
n2
 )

608 iàĞ
n1
 )

610 iàĞ
n2
 )

613 iàĞ
m1
.
	`IsChªÃlMsg
(è&& 
m2
.IsChannelMsg() )

615 iàĞ
m1
.
	`G‘ChªÃl
(è!ğ
m2
.GetChannel() )

616  
m1
.
	`G‘ChªÃl
(è< 
m2
.GetChannel();

620 
n1
 = ! 
m1
.
	`IsNÙe
();

621 
n2
 = ! 
m2
.
	`IsNÙe
();

622 ià(
n1
 && 
n2
)

624 ià(
n1
)

626 ià(
n2
)

629 
n1
 = 
m1
.
	`IsNÙeOn
();

630 
n2
 = 
m2
.
	`IsNÙeOn
();

631 ià(
n1
 && 
n2
)

633 ià(
n1
)

635 ià(
n2
)

641 
	}
}

644 
boŞ
 
	gMIDITimedMes§ge
::
	$IsSameKšd
 (cÚ¡ 
MIDITimedMes§ge
 &
m1
, cÚ¡ MIDITimedMes§g&
m2
) {

645 ià(
m1
.
	`IsNoOp
(è&& 
m2
.IsNoOp())

646  
Œue
;

648 ià(
m1
.
	`G‘Time
(è!ğ
m2
.GetTime())

649  
çl£
;

651 ià(
m1
.
	`IsChªÃlMsg
(è&& 
m2
.IsChannelMsg() &&

652 
m1
.
	`G‘ChªÃl
(è=ğ
m2
.GetChannel()) {

653 ià(
m1
.
	`G‘Ty³
(è!ğ
m2
.GetType())

654  
çl£
;

655 ià(
m1
.
	`IsNÙeOn
(è&& 
m2
.IsNÙeOn(è&& m1.
	`G‘NÙe
() != m2.GetNote())

656  
çl£
;

657 ià(
m1
.
	`IsNÙeOff
(è&& 
m2
.IsNÙeOff(è&& m1.
	`G‘NÙe
() != m2.GetNote())

658  
çl£
;

659 ià(
m1
.
	`IsCÚŒŞChªge
(è&& 
m2
.IsCÚŒŞChªge(è&& m1.
	`G‘CÚŒŞËr
() != m2.GetController())

660  
çl£
;

661  
Œue
;

663 ià(
m1
.
	`IsM‘aEv’t
(è&& 
m2
.IsMetaEvent()) {

664 ià(
m1
.
	`G‘M‘aTy³
(è=ğ
m2
.GetMetaType())

665  
Œue
;

666  
çl£
;

668 ià(
m1
.
	`G‘Stus
(è=ğ
m2
.GetStatus())

669  
Œue
;

670  
çl£
;

671 
	}
}

674 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
MIDITimedMes§ge
 &
m1
, cÚ¡ 
	gMIDITimedMes§ge
 &
	gm2
) {

675 ià(
	gm1
.
G‘Time
(è!ğ
m2
.GetTime())

676  
çl£
;

677  ((
	gMIDIMes§ge
)
	gm1
 =ğ(
MIDIMes§ge
)
m2
);

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\multitrack.cpp

38 
	~"../šşude/muÉ™¿ck.h
"

40 
	~"../šşude/dump_Œacks.h
"

41 
	~<io¡»am
>

49 
	gMIDIMuÉiT¿ck
::
	$MIDIMuÉiT¿ck
(
num_Œacks
, 
ş_p_b
) :

50 
	$şks_³r_b—t
(
ş_p_b
) {

51 
Œacks
.
	`»size
(
num_Œacks
);

52 
i
 = 0; i < 
num_Œacks
; i++)

53 
Œacks
[
i
] = 
Ãw
 
MIDIT¿ck
;

54 
	}
}

57 
	gMIDIMuÉiT¿ck
::~
	$MIDIMuÉiT¿ck
() {

58 
i
 = 0; i < 
Œacks
.
	`size
(); ++i)

59 
d–‘e
 
Œacks
[
i
];

60 
	}
}

63 
	gMIDIMuÉiT¿ck
::
	$S‘ClksP”B—t
(
ş_p_b
) {

64 
MIDIClockTime
 
ev_time
;

66 
¿tio
 = 
ş_p_b
 / 
şks_³r_b—t
;

68 
şks_³r_b—t
 = 
ş_p_b
;

70 
i
 = 0; i < 
Œacks
.
	`size
(); i++) {

71 
ev_num
 = 0;ƒv_num < 
Œacks
[
i
]->
	`G‘NumEv’ts
();ƒv_num++) {

72 
ev_time
 = 
Œacks
[
i
]->
	`G‘Ev’t
(
ev_num
).
	`G‘Time
();

73 
ev_time
 = (
MIDIClockTime
)Óv_tim* 
¿tio
 + 0.5);

74 
Œacks
[
i
]->
	`G‘Ev’t
(
ev_num
).
	`S‘Time
(
ev_time
);

77 
	}
}

80 
	gMIDIMuÉiT¿ck
::
	$G‘NumT¿cksW™hEv’ts
() const {

81 
num_Œacks
 = 0;

82 
i
 = 0; i < 
Œacks
.
	`size
(); i++ )

83 ià(!
Œacks
[
i
]->
	`IsT¿ckEm±y
())

84 
num_Œacks
++;

85  
num_Œacks
;

86 
	}
}

89 
	gMIDIMuÉiT¿ck
::
	$G‘NumEv’ts
() const {

90 
num_ev’ts
 = 0;

91 
i
 = 0; i < 
Œacks
.
	`size
(); i++ )

92 
num_ev’ts
 +ğ
Œacks
[
i
]->
	`G‘NumEv’ts
();

93  
num_ev’ts
;

94 
	}
}

97 
	gMIDIMuÉiT¿ck
::
	$CË¬
() {

98 
i
 = 0; i < 
Œacks
.
	`size
(); i++)

99 
d–‘e
 
Œacks
[
i
];

100 
Œacks
.
	`»size
(0);

101 
	}
}

104 
	gMIDIMuÉiT¿ck
::
	$CË¬AndResize
(
n
) {

105 
	`CË¬
();

106 
i
 = 0; i < 
n
; i++)

107 
	`In£¹T¿ck
();

108 
	}
}

110 
	gMIDIMuÉiT¿ck
::
	$CË¬T¿cks
(
boŞ
 
mªš_’d
) {

111 
i
 = 0; i < 
Œacks
.
	`size
(); i++)

112 
Œacks
[
i
]->
	`CË¬
(
mªš_’d
);

113 
	}
}

117 
	gMIDIMuÉiT¿ck
::
	$AssignEv’tsToT¿cks
 ( cÚ¡ 
MIDIT¿ck
 *
¤c
 )

119 
MIDIT¿ck
 
	`tmp
Ğ*
¤c
 );

123 
	`CË¬AndResize
( 17 );

126 
i
 = 0; i < 
tmp
.
	`G‘NumEv’ts
(); ++i)

128 cÚ¡ 
MIDITimedMes§ge
 *
msg
;

129 
msg
 = 
tmp
.
	`G‘Ev’tAdd»ss
 ( 
i
 );

131 
Œack_num
 = 0;

132 iàĞ
msg
->
	`IsChªÃlMsg
() )

133 
Œack_num
 = 1 + 
msg
->
	`G‘ChªÃl
();

135 
Œacks
[
Œack_num
]->
	`PushEv’t
(*
msg
);

137 
	}
}

140 
boŞ
 
	gMIDIMuÉiT¿ck
::
	$In£¹T¿ck
(
Œk
) {

141 ià(
Œk
 =ğ-1èŒk = 
Œacks
.
	`size
();

142 ià(
Œk
 < 0 || (érk > 
Œacks
.
	`size
()è 
çl£
;

143 
Œacks
.
	`š£¹
Ñ¿cks.
	`begš
(è+ 
Œk
, 
Ãw
 
MIDIT¿ck
);

144  
Œue
;

145 
	}
}

148 
boŞ
 
	gMIDIMuÉiT¿ck
::
	$D–‘eT¿ck
(
Œk
) {

149 ià(!
	`IsV®idT¿ckNumb”
(
Œk
)è 
çl£
;

150 
d–‘e
 
Œacks
[
Œk
];

151 
Œacks
.
	`”a£
Ñ¿cks.
	`begš
(è+ 
Œk
);

152  
Œue
;

153 
	}
}

156 
boŞ
 
	gMIDIMuÉiT¿ck
::
	$MoveT¿ck
(
äom
, 
to
) {

157 ià(
äom
 =ğ
to
è 
Œue
;

158 ià(!
	`IsV®idT¿ckNumb”
(
äom
è|| !IsV®idT¿ckNumb”(
to
)è 
çl£
;

159 
MIDIT¿ck
* 
‹mp
 = 
Œacks
[
äom
];

160 
Œacks
.
	`”a£
Ñ¿cks.
	`begš
(è+ 
äom
);

161 ià(
äom
 < 
to
)

162 
to
--;

163 
Œacks
.
	`š£¹
Ñ¿cks.
	`begš
(è+ 
to
, 
‹mp
);

164  
Œue
;

165 
	}
}

168 
boŞ
 
	gMIDIMuÉiT¿ck
::
	$In£¹Ev’t
(
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
, 
_šs_mode
) {

169 ià(
	`IsV®idT¿ckNumb”
(
Œk
))

170  
Œacks
[
Œk
]->
	`In£¹Ev’t
(
msg
, 
_šs_mode
);

171  
çl£
;

172 
	}
}

175 
boŞ
 
	gMIDIMuÉiT¿ck
::
	$In£¹NÙe
(
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
, 
MIDIClockTime
 
Ën
, 
_šs_mode
) {

176 ià(
	`IsV®idT¿ckNumb”
(
Œk
))

177  
Œacks
[
Œk
]->
	`In£¹NÙe
(
msg
, 
Ën
, 
_šs_mode
);

178  
çl£
;

179 
	}
}

182 
boŞ
 
	gMIDIMuÉiT¿ck
::
	$D–‘eEv’t
(
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
) {

183 ià(
	`IsV®idT¿ckNumb”
(
Œk
))

184  
Œacks
[
Œk
]->
	`D–‘eEv’t
(
msg
);

185  
çl£
;

186 
	}
}

189 
boŞ
 
	gMIDIMuÉiT¿ck
::
	$D–‘eNÙe
(
Œk
, cÚ¡ 
MIDITimedMes§ge
& 
msg
) {

190 ià(
	`IsV®idT¿ckNumb”
(
Œk
))

191  
Œacks
[
Œk
]->
	`D–‘eNÙe
(
msg
);

192  
çl£
;

193 
	}
}

197 
	gMIDIMuÉiT¿ck
::
	$Ed™Cİy
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
,

198 
Œ_¡¬t
, 
Œ_’d
, 
MIDIEd™MuÉiT¿ck
* 
ed™
) {

199 ià(
Œ_¡¬t
 < 0 || ()
Œ_’d
 >ğ
	`G‘NumT¿cks
()) ;

201 
ed™
->
	`CË¬
();

202 
i
 = 0; i <ğ
Œ_’d
; i++)

203 
ed™
->
	`In£¹T¿ck
();

204 
ed™
->
	`S‘S¹T¿ck
(
Œ_¡¬t
);

205 
ed™
->
	`S‘EndT¿ck
(
Œ_’d
);

207 
ed™
->
Œacks
[0]->
	`S‘EndTime
(
’d
 - 
¡¬t
);

208 
i
 = 
Œ_¡¬t
; i <ğ
Œ_’d
; i++)

209 
Œacks
[
i
]->
	`MakeIÁ”v®
(
¡¬t
, 
’d
, 
ed™
->tracks[i]);

211 
	`DumpMIDIMuÉiT¿ck
(
this
);

212 
	`DumpMIDIMuÉiT¿ck
(
ed™
);

213 
	}
}

216 
	gMIDIMuÉiT¿ck
::
	$Ed™Cut
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
MIDIEd™MuÉiT¿ck
* 
ed™
) {

217 
	`DumpMIDIMuÉiT¿ck
(
this
);

219 
	`Ed™Cİy
(
¡¬t
, 
’d
, 0, 
	`G‘NumT¿cks
()-1, 
ed™
);

221 
i
 = 0; i < 
Œacks
.
	`size
(); i++)

222 
	`G‘T¿ck
(
i
)->
	`D–‘eIÁ”v®
(
¡¬t
, 
’d
);

224 
	`DumpMIDIMuÉiT¿ck
(
this
);

225 
	}
}

228 
	gMIDIMuÉiT¿ck
::
	$Ed™CË¬
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
Œ_¡¬t
, 
Œ_’d
) {

229 
	`DumpMIDIMuÉiT¿ck
(
this
);

231 
i
 = 
Œ_¡¬t
; i <ğ
Œ_’d
; i++)

232 
	`G‘T¿ck
(
i
)->
	`CË¬IÁ”v®
(
¡¬t
, 
’d
);

234 
	`DumpMIDIMuÉiT¿ck
(
this
);

235 
	}
}

238 
	gMIDIMuÉiT¿ck
::
	$Ed™In£¹
(
MIDIClockTime
 
¡¬t
, 
Œ_¡¬t
, 
times
, 
boŞ
 
sy£x
,

239 
MIDIEd™MuÉiT¿ck
* 
ed™
) {

241 
MIDIClockTime
 
Ëngth
 = 
ed™
->
Œacks
[0]->
	`G‘EndTime
();

242 
Œ_’d
 = 
Œ_¡¬t
 + 
ed™
->
	`G‘EndT¿ck
(è-ƒd™->
	`G‘S¹T¿ck
();

244 
i
 = 0; i < 
Œacks
.
	`size
(); i++)

245 
Œacks
[
i
]->
	`In£¹IÁ”v®
(
¡¬t
, 
Ëngth
 * 
times
, 0);

247 
	`DumpMIDIMuÉiT¿ck
(
this
);

248 
	`DumpMIDIMuÉiT¿ck
(
ed™
);

250 if(
ed™
) {

251 ià(
Œ_¡¬t
 == 0)

252 
Œ_¡¬t
 = 1;

254 
i
 = 
Œ_¡¬t
; i <ğ
Œ_’d
; i++) {

255 
j
 = 0; j < 
times
; j++)

256 
Œacks
[
i
]->
	`R•ÏûIÁ”v®
(
¡¬t
 + 
j
 * 
Ëngth
,†’gth, 
sy£x
, 
ed™
->tracks[i]);

260 
	`DumpMIDIMuÉiT¿ck
(
this
);

261 
	`DumpMIDIMuÉiT¿ck
(
ed™
);

262 
	}
}

265 
	gMIDIMuÉiT¿ck
::
	$Ed™R•Ïû
(
MIDIClockTime
 
¡¬t
, 
Œ_¡¬t
, 
times
, 
boŞ
 
sy£x
,

266 
MIDIEd™MuÉiT¿ck
* 
ed™
) {

267 
MIDIClockTime
 
Ëngth
 = 
ed™
->
Œacks
[0]->
	`G‘EndTime
(è* 
times
;

268 
Œ_’d
 = 
Œ_¡¬t
 + 
ed™
->
	`G‘EndT¿ck
(è-ƒd™->
	`G‘S¹T¿ck
();

270 
	`DumpMIDIMuÉiT¿ck
(
this
);

271 
	`DumpMIDIMuÉiT¿ck
(
ed™
);

273 
i
 = 
Œ_¡¬t
; i <ğ
Œ_’d
; i++)

274 
Œacks
[
i
]->
	`CË¬IÁ”v®
(
¡¬t
, 
Ëngth
);

276 ià(
Œ_¡¬t
 == 0)

277 
Œ_¡¬t
 = 1;

279 ià(
¡¬t
 + 
times
 * 
ed™
->
Œacks
[0]->
	`G‘EndTime
() >racks[0]->GetEndTime())

280 
Œacks
[0]->
	`S‘EndTime
(
¡¬t
 + 
times
 * 
ed™
->Œacks[0]->
	`G‘EndTime
());

281 
i
 = 
Œ_¡¬t
; i <ğ
Œ_’d
; i++) {

282 
j
 = 0; j < 
times
; j++)

283 
Œacks
[
i
]->
	`R•ÏûIÁ”v®
(
¡¬t
 + 
j
 * 
ed™
->Œacks[0]->
	`G‘EndTime
(),

284 
ed™
->
Œacks
[0]->
	`G‘EndTime
(), 
sy£x
,ƒd™->Œacks[
i
]);

287 
	`DumpMIDIMuÉiT¿ck
(
this
);

288 
	}
}

298 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
::
	$MIDIMuÉiT¿ckI‹¿tÜS‹
(
n_Œacks
) :

299 
	$num_Œacks
(
n_Œacks
) {

300 
Ãxt_ev’t_numb”
 = 
Ãw
 [
n_Œacks
];

301 
Ãxt_ev’t_time
 = 
Ãw
 
MIDIClockTime
 [
n_Œacks
];

302 
	`Re£t
();

303 
	}
}

306 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
::
	$MIDIMuÉiT¿ckI‹¿tÜS‹
(cÚ¡ 
MIDIMuÉiT¿ckI‹¿tÜS‹
 &
m
) :

307 
	`num_Œacks
(
m
.
num_Œacks
), 
	`cur_time
(m.
cur_time
),

308 
	$cur_ev’t_Œack
(
m
.
cur_ev’t_Œack
) {

310 
Ãxt_ev’t_numb”
 = 
Ãw
 [
m
.
num_Œacks
];

311 
Ãxt_ev’t_time
 = 
Ãw
 
MIDIClockTime
 [
m
.
num_Œacks
];

312 
i
 = 0; i < 
num_Œacks
; i++) {

313 
Ãxt_ev’t_numb”
[
i
] = 
m
.next_event_number[i];

314 
Ãxt_ev’t_time
[
i
] = 
m
.next_event_time[i];

316 
	}
}

319 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
::~
	$MIDIMuÉiT¿ckI‹¿tÜS‹
() {

320 
d–‘e
[] 
Ãxt_ev’t_numb”
;

321 
d–‘e
[] 
Ãxt_ev’t_time
;

322 
	}
}

325 cÚ¡ 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
& MIDIMuÉiT¿ckI‹¿tÜS‹::
İ”©Ü
ğ(cÚ¡ 
MIDIMuÉiT¿ckI‹¿tÜS‹
 &
m
) {

326 
S‘NumT¿cks
(
m
.
num_Œacks
);

327 
	gcur_time
 = 
m
.
cur_time
;

328 
	gcur_ev’t_Œack
 = 
m
.
cur_ev’t_Œack
;

329 
	gi
 = 0; i < 
	gnum_Œacks
; ++i) {

330 
	gÃxt_ev’t_numb”
[
i
] = 
m
.
Ãxt_ev’t_numb”
[i];

331 
	gÃxt_ev’t_time
[
i
] = 
m
.
Ãxt_ev’t_time
[i];

333  *
	gthis
;

337 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
::
	$S‘NumT¿cks
(
n
) {

338 ià(
n
 !ğ
num_Œacks
) {

339 
num_Œacks
 = 
n
;

340 
d–‘e
[] 
Ãxt_ev’t_numb”
;

341 
d–‘e
[] 
Ãxt_ev’t_time
;

342 
Ãxt_ev’t_numb”
 = 
Ãw
 [
n
];

343 
Ãxt_ev’t_time
 = 
Ãw
 
MIDIClockTime
 [
n
];

345 
	`Re£t
();

346 
	}
}

349 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
::
	$Re£t
() {

350 
cur_time
 = 0;

351 
cur_ev’t_Œack
 = 0;

352 
i
 = 0; i < 
num_Œacks
; ++i) {

353 
Ãxt_ev’t_numb”
[
i
] = 0;

354 
Ãxt_ev’t_time
[
i
] = 
TIME_INFINITE
;

356 
	}
}

359 
	gMIDIMuÉiT¿ckI‹¿tÜS‹
::
	$FšdT¿ckOfFœ¡Ev’t
() {

360 
MIDIClockTime
 
mšimum_time
 = 
TIME_INFINITE
;

361 
mšimum_time_Œack
 = -1;

364 
j
 = 0; j < 
num_Œacks
; ++j) {

365 
i
 = (
j
 + 
cur_ev’t_Œack
 + 1è% 
num_Œacks
;

368 if(
Ãxt_ev’t_numb”
[
i
] >ğ0 && 
Ãxt_ev’t_time
[i] < 
mšimum_time
) {

369 
mšimum_time
 = 
Ãxt_ev’t_time
[
i
];

370 
mšimum_time_Œack
 = 
i
;

375 
cur_ev’t_Œack
 = 
mšimum_time_Œack
;

376 
cur_time
 = 
mšimum_time
;

377  
cur_ev’t_Œack
;

378 
	}
}

388 
	gMIDIMuÉiT¿ckI‹¿tÜ
::
	$MIDIMuÉiT¿ckI‹¿tÜ
(
MIDIMuÉiT¿ck
 *
mÉ
) :

389 
	`muÉ™¿ck
(
mÉ
), 
	`¡©e
(mÉ->
	$G‘NumT¿cks
()) {

390 
	`Re£t
();

391 
	}
}

394 
	gMIDIMuÉiT¿ckI‹¿tÜ
::~
	$MIDIMuÉiT¿ckI‹¿tÜ
(è{
	}
}

397 
MIDIMuÉiT¿ckI‹¿tÜ
::
	$Re£t
() {

398 
¡©e
.
	`S‘NumT¿cks
(
muÉ™¿ck
->
	`G‘NumT¿cks
());

399 
	`GoToTime
(0);

400 
	}
}

403 
	gMIDIMuÉiT¿ckI‹¿tÜ
::
	$GoToTime
(
MIDIClockTime
 
time
) {

405 
¡©e
.
	`Re£t
();

409 
i
 = 0; i < 
muÉ™¿ck
->
	`G‘NumT¿cks
(); ++i) {

410 
MIDIT¿ck
 *
Œack
 = 
muÉ™¿ck
->
	`G‘T¿ck
(
i
);

413 
MIDITimedMes§ge
 *
msg
 = 
Œack
->
	`G‘Ev’tAdd»ss
(0);

416 
¡©e
.
Ãxt_ev’t_numb”
[
i
] = 0;

417 
¡©e
.
Ãxt_ev’t_time
[
i
]=
msg
->
	`G‘Time
();

421 if(
¡©e
.
	`FšdT¿ckOfFœ¡Ev’t
() != -1) {

423 
¡©e
.
	`G‘CurTime
(è< 
time
) {

427 if(!
	`GoToNextEv’t
()) ;

432 
	}
}

436 
boŞ
 
	gMIDIMuÉiT¿ckI‹¿tÜ
::
	$G‘CurEv’tTime
(
MIDIClockTime
 *
t
) const {

438 if(
¡©e
.
	`G‘CurEv’tT¿ck
() != -1) {

439 *
t
 = 
¡©e
.
	`G‘CurTime
();

440  
Œue
;

443  
çl£
;

444 
	}
}

447 
boŞ
 
	gMIDIMuÉiT¿ckI‹¿tÜ
::
	$G‘CurEv’t
(*
Œack
, 
MIDITimedMes§ge
 **
msg
) {

448 
t
 = 
¡©e
.
	`G‘CurEv’tT¿ck
();

450 if(
t
 != -1) {

451 if(
Œack
)

452 *
Œack
=
t
;

453 if(
msg
) {

454 
num
 = 
¡©e
.
Ãxt_ev’t_numb”
[
t
];

455 if(
num
 >= 0)

456 *
msg
 = 
muÉ™¿ck
->
	`G‘T¿ck
(
t
)->
	`G‘Ev’tAdd»ss
(
¡©e
.
Ãxt_ev’t_numb”
[t]);

458 *
msg
 = 0;

461 if(! *
msg
)

463  
çl£
;

465  
Œue
;

467  
çl£
;

469 
	}
}

472 
boŞ
 
	gMIDIMuÉiT¿ckI‹¿tÜ
::
	$GoToNextEv’t
() {

476 if(
¡©e
.
cur_ev’t_Œack
 == -1)

478  
çl£
;

483 
	`GoToNextEv’tOnT¿ck
(
¡©e
.
cur_ev’t_Œack
);

487 if(
¡©e
.
	`FšdT¿ckOfFœ¡Ev’t
() == -1)

489  
çl£
;

493  
Œue
;

494 
	}
}

497 
boŞ
 
	gMIDIMuÉiT¿ckI‹¿tÜ
::
	$GoToNextEv’tOnT¿ck
(
Œack_num
) {

499 
MIDIT¿ck
 *
Œack
 = 
muÉ™¿ck
->
	`G‘T¿ck
(
Œack_num
);

502 *
ev’t_num
 = &
¡©e
.
Ãxt_ev’t_numb”
[
Œack_num
];

505 if(*
ev’t_num
 < 0)

506  
çl£
;

509 (*
ev’t_num
) += 1;

512 if(*
ev’t_num
 >ğ
Œack
->
	`G‘NumEv’ts
()) {

514 *
ev’t_num
=-1;

515  
çl£
;

519 
MIDITimedMes§ge
 *
msg
;

520 
msg
 = 
Œack
->
	`G‘Ev’tAdd»ss
Ğ*
ev’t_num
 );

521 
¡©e
.
Ãxt_ev’t_time
[
Œack_num
] = 
msg
->
	`G‘Time
();

524  
Œue
;

525 
	}
}

533 
	gMIDIEd™MuÉiT¿ck
::
	$CİyAÎ
(
MIDIMuÉiT¿ck
* 
m
) {

534 
	`CË¬
();

535 
i
 = 0; i < 
m
->
	`G‘NumT¿cks
(); i++) {

536 
	`In£¹T¿ck
(
i
);

537 *
	`G‘T¿ck
(
i
èğ*(
m
->GetTrack(i));

539 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\notifier.cpp

1 
	~"../šşude/nÙif›r.h
"

2 
	~"../šşude/£qu’ûr.h
"

5 cÚ¡ 
	gMIDISequ’ûrGUIEv’t
::
group_Çmes
[][10] =

7 cÚ¡ 
	gMIDISequ’ûrGUIEv’t
::
cÚduùÜ_™ems_Çmes
[][10] =

9 cÚ¡ 
	gMIDISequ’ûrGUIEv’t
::
Œª¥Üt_™ems_Çmes
[][10] =

11 cÚ¡ 
	gMIDISequ’ûrGUIEv’t
::
Œack_™ems_Çmes
[][10] =

15 
	gMIDISequ’ûrGUINÙif›rText
::
	$NÙify
(
MIDISequ’ûrGUIEv’t
 
e
) {

16 ià(
£qu’ûr
 == 0) ;

17 ià(!
’
) ;

19 
o¡
 << "GUI EVENT: " << 
MIDISequ’ûrGUIEv’t
::
group_Çmes
[
e
.
	`G‘Ev’tGroup
()] << " ";

21 
e
.
	`G‘Ev’tGroup
()) {

22 
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
:

23 
o¡
 << "GENERAL RESET";

25 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT
:

26 
e
.
	`G‘Ev’tI‹m
()) {

27 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_BEAT
:

28 
o¡
 << "MEAS " << 
£qu’ûr
->
	`G‘Cu¼’tM—su»
() + 1 << " " <<

29 "BEAT " << 
£qu’ûr
->
	`G‘Cu¼’tB—t
() + 1;

31 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_ENDOFSONG
:

32 
o¡
 << "ENDOFSONG";

35 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR
:

36 
e
.
	`G‘Ev’tI‹m
()) {

37 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_TEMPO
:

38 
o¡
 << "TEMPO: " << 
£qu’ûr
->
	`G‘S‹
()->
‹mpobpm
 ;

40 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_TIMESIG
:

41 
o¡
 << "TIMESIG: " << 
£qu’ûr
->
	`G‘S‹
()->
timesig_num”©Ü
 << "/" <<

42 
£qu’ûr
->
	`G‘S‹
()->
timesig_d’omš©Ü
;

44 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_KEYSIG
:

45 
o¡
 << "KEYSIG: ";

47 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_MARKER
:

48 
o¡
 << "MARKER: " << 
£qu’ûr
->
	`G‘S‹
()->
m¬k”_‹xt
;

51 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK
: {

52 
s
[10];

53 
Œack_num
 = 
e
.
	`G‘Ev’tSubGroup
();

54 
	`¥rštf
 (
s
, "TRACK %3d ", 
Œack_num
);

55 
e
.
	`G‘Ev’tI‹m
()) {

56 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_NAME
:

57 
o¡
 << 
s
 << "NAME: " << 
£qu’ûr
->
	`G‘S‹
()->
Œack_¡©es
[
Œack_num
].
Œack_Çme
;

59 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_PROGRAM
:

60 
o¡
 << 
s
 << "PROGRAM: " << 
£qu’ûr
->
	`G‘S‹
()->
Œack_¡©es
[
Œack_num
].
´og¿m
;

62 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_NOTE
:

63 
o¡
 << 
s
 << "NOTE: ";

65 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_VOLUME
:

66 
o¡
 << 
s
 << "VOLUME: " << 
£qu’ûr
->
	`G‘S‹
()->
Œack_¡©es
[
Œack_num
].
vŞume
;

68 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_PAN
:

69 
o¡
 << 
s
 << "PAN: " << 
£qu’ûr
->
	`G‘S‹
()->
Œack_¡©es
[
Œack_num
].
·n
;

71 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_CHR
:

72 
o¡
 << 
s
 << "CHORUS: " << 
£qu’ûr
->
	`G‘S‹
()->
Œack_¡©es
[
Œack_num
].
chr
;

74 
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_REV
:

75 
o¡
 << 
s
 << "REVERB: " << 
£qu’ûr
->
	`G‘S‹
()->
Œack_¡©es
[
Œack_num
].
»v
;

79 
o¡
 << 
¡d
::
’dl
;

81 
	}
}

211 #ifdeà
_WIN32


213 
	gMIDISequ’ûrGUINÙif›rWš32
::
	$MIDISequ’ûrGUINÙif›rWš32
 (

214 
HWND
 
w
, 
DWORD
 
msg
, 
WPARAM
 
w·¿m_v®ue_
 ) :

215 
	`de¡_wšdow
 ( 
w
 ), 
	`wšdow_msg
 ( 
msg
 ), 
	$w·¿m_v®ue
 ( 
w·¿m_v®ue_
 ) {
	}
}

219 
	gMIDISequ’ûrGUINÙif›rWš32
::
	$MIDISequ’ûrGUINÙif›rWš32
 ( 
HWND
 
w
 ) :

220 
	`de¡_wšdow
 ( 
w
 ), 
	`wšdow_msg
 ( 
	`G‘SaãSy¡emMsgId
(è), 
	$w·¿m_v®ue
 ( 0 ) {
	}
}

223 
	gMIDISequ’ûrGUINÙif›rWš32
::
	$NÙify
 (
MIDISequ’ûrGUIEv’t
 
e
) {

224 iàĞ
’
 )

225 
	`Po¡Mes§ge
 ( 
de¡_wšdow
, 
wšdow_msg
, 
w·¿m_v®ue
, ( è
e
 );

226 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\process.cpp

31 
	~"../šşude/wÜld.h
"

32 
	~"../šşude/´oûss.h
"

36 
	gMIDIProûssÜ
::
	$MIDIProûssÜ
()

38 
	}
}

40 
MIDIProûssÜ
::~
	$MIDIProûssÜ
()

42 
	}
}

47 
MIDIMuÉiProûssÜ
::
	$MIDIMuÉiProûssÜ
Ğ
num
 )

49 
	`´oûssÜs
Ğ
Ãw
 
MIDIProûssÜ
 *[
num
] ),

50 
	$num_´oûssÜs
Ğ
num
 )

52  
i
=0; i<
num_´oûssÜs
; ++i )

54 
´oûssÜs
[
i
] = 0;

56 
	}
}

58 
	gMIDIMuÉiProûssÜ
::~
	$MIDIMuÉiProûssÜ
()

60 
d–‘e
 [] 
´oûssÜs
;

61 
	}
}

65 
boŞ
 
	gMIDIMuÉiProûssÜ
::
	$Proûss
Ğ
MIDITimedMes§ge
 *
msg
 )

67  
i
=0; i<
num_´oûssÜs
; ++i )

69 ifĞ
´oûssÜs
[
i
] )

71 ifĞ
´oûssÜs
[
i
]->
	`Proûss
Ğ
msg
 )==
çl£
 )

73  
çl£
;

79  
Œue
;

80 
	}
}

86 
	gMIDIProûssÜT¿n¥o£r
::
	$MIDIProûssÜT¿n¥o£r
()

88  
i
=0; i<16; ++i )

90 
Œªs_amouÁ
[
i
] = 0;

93 
	}
}

95 
	gMIDIProûssÜT¿n¥o£r
::~
	$MIDIProûssÜT¿n¥o£r
()

97 
	}
}

100 
MIDIProûssÜT¿n¥o£r
::
	$S‘AÎT¿n¥o£
Ğ
v®
 )

102  
chª
=0; chan<16; ++chan )

104 
Œªs_amouÁ
[
chª
]=
v®
;

106 
	}
}

108 
boŞ
 
	gMIDIProûssÜT¿n¥o£r
::
	$Proûss
Ğ
MIDITimedMes§ge
 *
msg
 )

110 ifĞ
msg
->
	`IsChªÃlMsg
() )

112 ifĞ
msg
->
	`IsNÙeOn
(è|| msg->
	`IsNÙeOff
(è|| msg->
	`IsPŞyP»ssu»
() )

114 
Œªs
 = 
Œªs_amouÁ
[ 
msg
->
	`G‘ChªÃl
() ];

116 
Ãw_nÙe
 = (()
msg
->
	`G‘NÙe
())+
Œªs
;

118 ifĞ
Œªs
>127 ||rans<0 )

121  
çl£
;

126 
msg
->
	`S‘NÙe
Ğ()
Ãw_nÙe
 );

132  
Œue
;

133 
	}
}

139 
	gMIDIProûssÜRechªÃliz”
::
	$MIDIProûssÜRechªÃliz”
()

141  
i
=0; i<16; ++i )

143 
»chª_m­
[
i
] = i;

146 
	}
}

148 
	gMIDIProûssÜRechªÃliz”
::~
	$MIDIProûssÜRechªÃliz”
()

150 
	}
}

153 
MIDIProûssÜRechªÃliz”
::
	$S‘AÎRechª
Ğ
de¡_chª
 )

155  
i
=0; i<16; ++i )

157 
»chª_m­
[
i
] = 
de¡_chª
;

159 
	}
}

161 
boŞ
 
	gMIDIProûssÜRechªÃliz”
::
	$Proûss
Ğ
MIDITimedMes§ge
 *
msg
 )

163 ifĞ
msg
->
	`IsChªÃlMsg
() )

165 
Ãw_chª
 = 
»chª_m­
[ 
msg
->
	`G‘ChªÃl
() ];

167 ifĞ
Ãw_chª
==-1 )

170  
çl£
;

173 
msg
->
	`S‘ChªÃl
Ğ()
Ãw_chª
 );

176  
Œue
;

177 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\queue.cpp

30 
	~"../šşude/wÜld.h
"

31 
	~"../šşude/queue.h
"

34 
	gMIDIQueue
::
	$MIDIQueue
Ğ
num_msgs
 )

36 
	`buf
Ğ
Ãw
 
MIDITimedMes§ge
[ 
num_msgs
 ] ),

37 
	`bufsize
Ğ
num_msgs
 ),

38 
	`Ãxt_š
(0),

39 
	$Ãxt_out
(0)

42 
	}
}

45 
	gMIDIQueue
::~
	$MIDIQueue
()

47 
d–‘e
 [] 
buf
;

48 
	}
}

50 
	gMIDIQueue
::
	$CË¬
()

52 
Ãxt_š
=0;

53 
Ãxt_out
=0;

54 
i
 = 0; i < 
bufsize
; i++)

55 
buf
[
i
].
	`CË¬
();

56 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\sequencer.cpp

24 
	~"../šşude/wÜld.h
"

25 
	~"../šşude/£qu’ûr.h
"

56 
	gMIDISequ’ûrT¿ckProûssÜ
::
	$MIDISequ’ûrT¿ckProûssÜ
() :

57 
	`mu‹
(
çl£
), 
	`sŞo
(çl£), 
	`v–oc™y_sÿË
(100), 
	`»chªÃl
(-1), 
	`Œª¥o£
(0), 
	$exŒa_´oc
(0) {

58 
	}
}

61 
	gMIDISequ’ûrT¿ckProûssÜ
::
	$Re£t
() {

62 
mu‹
 = 
çl£
;

63 
sŞo
 = 
çl£
;

64 
v–oc™y_sÿË
 = 100;

65 
»chªÃl
 = -1;

66 
Œª¥o£
 = 0;

67 
	}
}

70 
boŞ
 
	gMIDISequ’ûrT¿ckProûssÜ
::
	$Proûss
Ğ
MIDITimedMes§ge
 *
msg
 ) {

72 if(
mu‹
)

74  
çl£
;

77 if(
msg
->
	`IsNoOp
())

79  
çl£
;

82 if(
exŒa_´oc
 &&ƒxŒa_´oc->
	`Proûss
(
msg
è=ğ
çl£
)

84  
çl£
;

87 if(
msg
->
	`IsChªÃlMsg
()) {

89 if(
»chªÃl
 != -1)

90 
msg
->
	`S‘ChªÃl
(()
»chªÃl
);

93 if(
msg
->
	`IsNÙeOn
(è&& msg->
	`G‘V–oc™y
() > 0) {

95 
v–
 = ()
msg
->
	`G‘V–oc™y
();

96 
v–
 = v– * 
v–oc™y_sÿË
 / 100;

99 ifĞ
v–
 < 0 )

100 
v–
 = 0;

103 
msg
->
	`S‘V–oc™y
(()
v–
);

107 if(
msg
->
	`IsNÙeOn
(è|| msg->
	`IsNÙeOff
(è|| msg->
	`IsPŞyP»ssu»
()) {

108 
Ãw_nÙe
 = (()
msg
->
	`G‘NÙe
()è+ 
Œª¥o£
;

109 if(
Ãw_nÙe
 >= 0 &&‚ew_note <= 127)

112 
msg
->
	`S‘NÙe
(()
Ãw_nÙe
);

115  
çl£
;

118  
Œue
;

119 
	}
}

128 
	gMIDISequ’ûrT¿ckS‹
::
	$MIDISequ’ûrT¿ckS‹
():

129 
	`´og¿m
(-1), 
	`vŞume
(100), 
	`·n
(64), 
	`»v
(0), 
	`chr
(0),

130 
	`b’d”_v®ue
(0), 
	`nÙes_¬e_Ú
(
çl£
), 
	`nÙe_m©rix
(), 
	$gÙ_good_Œack_Çme
(
çl£
è{
	}
}

133 
	gMIDISequ’ûrT¿ckS‹
::
	$Re£t
() {

134 
´og¿m
 = -1;

135 
vŞume
 = 100;

136 
·n
 = 64;

137 
»v
 = 0;

138 
chr
 = 0;

139 
Œack_Çme
 = "";

140 
nÙes_¬e_Ú
 = 
çl£
;

141 
b’d”_v®ue
 = 0;

142 
nÙe_m©rix
.
	`CË¬
();

143 
gÙ_good_Œack_Çme
 = 
çl£
;

144 
	}
}

216 
	gMIDISequ’ûrS‹
::
	$MIDISequ’ûrS‹
(
MIDIMuÉiT¿ck
 *
m
, 
MIDISequ’ûrGUINÙif›r
 *
n
) :

217 
	`nÙif›r
(
n
), 
	`muÉ™¿ck
(
m
), 
	`™”©Ü
(m), 
	`cur_şock
(0), 
	`cur_time_ms
(0.0),

218 
	`cur_b—t
(0), 
	`cur_m—su»
(0), 
	`Ãxt_b—t_time
(0),

219 
	`‹mpobpm
(120.0), 
	`timesig_num”©Ü
(4), 
	`timesig_d’omš©Ü
(4),

220 
	`keysig_sh¬pæ©
(0), 
	`keysig_mode
(0), 
	`Ï¡_ev’t_Œack
(-1)

222 
Œack_¡©es
.
	`»size
(
m
->
	`G‘NumT¿cks
());

223 
	}
}

226 
	gMIDISequ’ûrS‹
::
	$MIDISequ’ûrS‹
(cÚ¡ 
MIDISequ’ûrS‹
& 
s
) :

227 
	`nÙif›r
(
s
.
nÙif›r
), 
	`muÉ™¿ck
(s.
muÉ™¿ck
), 
	`™”©Ü
(s.
™”©Ü
),

228 
	`cur_şock
(
s
.
cur_şock
), 
	`cur_time_ms
(s.
cur_time_ms
), 
	`cur_b—t
(s.
cur_b—t
),

229 
	`cur_m—su»
(
s
.
cur_m—su»
), 
	`Ãxt_b—t_time
(s.
Ãxt_b—t_time
),

230 
	`‹mpobpm
(
s
.
‹mpobpm
), 
	`timesig_num”©Ü
(s.
timesig_num”©Ü
),

231 
	`timesig_d’omš©Ü
(
s
.
timesig_d’omš©Ü
), 
	`keysig_sh¬pæ©
(s.
keysig_sh¬pæ©
),

232 
	`keysig_mode
(
s
. 
keysig_mode
), 
	`m¬k”_‹xt
(s.
m¬k”_‹xt
), 
	`Œack_¡©es
(s.
Œack_¡©es
),

233 
	$Ï¡_ev’t_Œack
(
s
.
Ï¡_ev’t_Œack
)

234 {
	}
}

237 cÚ¡ 
	gMIDISequ’ûrS‹
& MIDISequ’ûrS‹::
İ”©Ü
ğ(cÚ¡ 
MIDISequ’ûrS‹
& 
s
) {

238 
nÙif›r
 = 
s
.notifier;

239 
	gmuÉ™¿ck
 = 
s
.
muÉ™¿ck
;

240 
	g™”©Ü
.
S‘S‹
(
s
.
™”©Ü
.
G‘S‹
());

241 
	gÏ¡_ev’t_Œack
 = 
s
.
Ï¡_ev’t_Œack
;

243 
	gcur_şock
 = 
s
.
cur_şock
;

244 
	gcur_time_ms
 = 
s
.
cur_time_ms
;

245 
	gcur_b—t
 = 
s
.
cur_b—t
;

246 
	gcur_m—su»
 = 
s
.
cur_m—su»
;

247 
	gÃxt_b—t_time
 = 
s
.
Ãxt_b—t_time
;

248 
	g‹mpobpm
 = 
s
.
‹mpobpm
;

249 
	gtimesig_num”©Ü
 = 
s
.
timesig_num”©Ü
;

250 
	gtimesig_d’omš©Ü
 = 
s
.
timesig_d’omš©Ü
;

251 
	gkeysig_sh¬pæ©
 = 
s
.
keysig_sh¬pæ©
;

252 
	gkeysig_mode
 = 
s
.
keysig_mode
;

253 
	gm¬k”_‹xt
 = 
s
.
m¬k”_‹xt
;

255 
	gŒack_¡©es
 = 
s
.
Œack_¡©es
;

256  *
	gthis
;

260 
	gMIDISequ’ûrS‹
::
	$Re£t
() {

261 
™”©Ü
.
	`Re£t
();

262 
cur_şock
 = 0;

263 
cur_time_ms
 = 0.0;

264 
cur_b—t
 = 0;

265 
cur_m—su»
 = 0;

266 
‹mpobpm
 = 120.0;

267 
timesig_num”©Ü
 = 4;

268 
timesig_d’omš©Ü
 = 4;

269 
keysig_sh¬pæ©
 = 0;

270 
keysig_mode
 = 0;

271 
m¬k”_‹xt
 = "";

272 
Ãxt_b—t_time
 = 
muÉ™¿ck
->
	`G‘ClksP”B—t
();

273 ià(
muÉ™¿ck
->
	`G‘NumT¿cks
(è!ğ
Œack_¡©es
.
	`size
()) {

274 
Œack_¡©es
.
	`ş—r
();

275 
Œack_¡©es
.
	`»size
(
muÉ™¿ck
->
	`G‘NumT¿cks
());

278 
i
 = 0; i < 
Œack_¡©es
.
	`size
(); i++)

279 
Œack_¡©es
[
i
].
	`Re£t
();

280 
	}
}

284 
boŞ
 
	gMIDISequ’ûrS‹
::
	$Proûss
Ğ
MIDITimedMes§ge
 *
msg
 ) {

285 
MIDISequ’ûrT¿ckS‹
& 
t_¡©e
 = 
Œack_¡©es
[
Ï¡_ev’t_Œack
];

288 ifĞ
msg
->
	`IsNoOp
() )

289  
çl£
;

292 if(
msg
->
	`IsChªÃlMsg
()) {

293 ifĞ
msg
->
	`G‘Ty³
()==
PITCH_BEND
 )

295 
t_¡©e
.
b’d”_v®ue
 = 
msg
->
	`G‘B’d”V®ue
();

296 ifĞ
msg
->
	`IsCÚŒŞChªge
() ) {

299 ifĞ
msg
->
	`G‘CÚŒŞËr
(è=ğ
C_MAIN_VOLUME
 ) {

301 
t_¡©e
.
vŞume
 = 
msg
->
	`G‘CÚŒŞËrV®ue
();

302 
	`NÙifyT¿ck
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_VOLUME
);

305 ifĞ
msg
->
	`G‘CÚŒŞËr
(è=ğ
C_PAN
 ) {

307 
t_¡©e
.
·n
 = 
msg
->
	`G‘CÚŒŞËrV®ue
();

308 
	`NÙifyT¿ck
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_PAN
);

311 if(
msg
->
	`G‘CÚŒŞËr
(è=ğ
C_CHORUS_DEPTH
) {

313 
t_¡©e
.
chr
 = 
msg
->
	`G‘CÚŒŞËrV®ue
();

314 
	`NÙifyT¿ck
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_CHR
);

317 ifĞ
msg
->
	`G‘CÚŒŞËr
(è=ğ
C_EFFECT_DEPTH
 ) {

319 
t_¡©e
.
»v
 = 
msg
->
	`G‘CÚŒŞËrV®ue
();

320 
	`NÙifyT¿ck
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_REV
);

323 ifĞ
msg
->
	`IsProg¿mChªge
() ) {

325 
t_¡©e
.
´og¿m
 = 
msg
->
	`G‘Prog¿mV®ue
();

326 
	`NÙifyT¿ck
Ğ
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_PROGRAM
 );

331 if(
t_¡©e
.
nÙe_m©rix
.
	`Proûss
(*
msg
)) {

333 if((
t_¡©e
.
nÙes_¬e_Ú
 &&_¡©e.
nÙe_m©rix
.
	`G‘TÙ®CouÁ
() == 0) ||

334 (!
t_¡©e
.
nÙes_¬e_Ú
 &&_¡©e.
nÙe_m©rix
.
	`G‘TÙ®CouÁ
() > 0) ) {

336 
t_¡©e
.
nÙes_¬e_Ú
 = !t_state.notes_are_on;

338 
	`NÙifyT¿ck
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_NOTE
);

341  
Œue
;

344 if(
msg
->
	`IsM‘aEv’t
()) {

346 if(
msg
->
	`IsTempo
()) {

347 
‹mpobpm
 = 
msg
->
	`G‘Tempo
();

348 if(
‹mpobpm
 < 1 )

349 
‹mpobpm
=120.0;

350 
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR
,

351 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_TEMPO
);

353 if(
msg
->
	`IsTimeSig
()) {

354 
timesig_num”©Ü
 = 
msg
->
	`G‘TimeSigNum”©Ü
();

355 
timesig_d’omš©Ü
 = 
msg
->
	`G‘TimeSigD’omš©Ü
();

356 
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR
,

357 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_TIMESIG
);

359 if(
msg
->
	`IsKeySig
()) {

360 
keysig_sh¬pæ©
 = 
msg
->
	`G‘KeySigSh¬pFÏts
();

361 
keysig_mode
 = 
msg
->
	`G‘KeySigMajÜMšÜ
();

362 
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR
,

363 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_KEYSIG
);

365 iàĞ
msg
->
	`IsM¬k”Text
()) {

366 
m¬k”_‹xt
 = 
¡d
::
	`¡ršg
((cÚ¡ *)
msg
->
	`G‘SysEx
()->
	`G‘Buf
(), msg->G‘SysEx()->
	`G‘L’gth
());

367 
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR
,

368 
MIDISequ’ûrGUIEv’t
::
GROUP_CONDUCTOR_MARKER
);

370 iàĞ
msg
->
	`IsB—tM¬k”
()) {

372 
Ãw_b—t
 = 
cur_b—t
 + 1;

373 
Ãw_m—su»
 = 
cur_m—su»
;

376 ifĞ
Ãw_b—t
 >ğ
timesig_num”©Ü
 ) {

378 
Ãw_b—t
=0;

379 ++
Ãw_m—su»
;

389 
Ãxt_b—t_time
 +=

390 
muÉ™¿ck
->
	`G‘ClksP”B—t
(è* 4 / 
timesig_d’omš©Ü
;

391 
cur_b—t
 = 
Ãw_b—t
;

392 
cur_m—su»
 = 
Ãw_m—su»
;

395 
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT
,

396 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_BEAT
);

399 ifĞ
cur_b—t
 == 0 )

400 
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT
,

401 
MIDISequ’ûrGUIEv’t
::
GROUP_TRANSPORT_MEASURE
);

403 ifĞĞ
msg
->
	`G‘M‘aTy³
()==
META_TRACK_NAME


404 || 
msg
->
	`G‘M‘aTy³
()==
META_INSTRUMENT_NAME


405 || (!
t_¡©e
.
gÙ_good_Œack_Çme
 && 
msg
->
	`G‘M‘aTy³
()==
META_GENERIC_TEXT
 && msg->
	`G‘Time
()==0) )

406 && 
msg
->
	`G‘SysEx
() ) {

408 
t_¡©e
.
gÙ_good_Œack_Çme
 = 
Œue
;

409 
Ën
 = 
msg
->
	`G‘SysEx
()->
	`G‘L’gth
();

410 
t_¡©e
.
Œack_Çme
 = 
¡d
::
	`¡ršg
((cÚ¡ *)
msg
->
	`G‘SysEx
()->
	`G‘Buf
(), 
Ën
);

412 
	`NÙifyT¿ck
(
MIDISequ’ûrGUIEv’t
::
GROUP_TRACK_NAME
);

414  
Œue
;

416  
çl£
;

417 
	}
}

420 
	gMIDISequ’ûrS‹
::
	$NÙify
(
group
, 
™em
) const {

421 ià(
nÙif›r
) {

422 
MIDISequ’ûrGUIEv’t
 
	`e
(
group
, 0, 
™em
);

423 
nÙif›r
->
	`NÙify
(
e
);

425 
	}
}

428 
	gMIDISequ’ûrS‹
::
	$NÙifyT¿ck
(
™em
) const {

429 ià(
nÙif›r
) {

430 
MIDISequ’ûrGUIEv’t
 
	`e
(MIDISequ’ûrGUIEv’t::
GROUP_TRACK
,

431 
Ï¡_ev’t_Œack
,

432 
™em
);

433 
nÙif›r
->
	`NÙify
(
e
);

435 
	}
}

444 
	gMIDISequ’ûr
::
	$MIDISequ’ûr
 (
MIDIMuÉiT¿ck
 *
m
, 
MIDISequ’ûrGUINÙif›r
 *
n
) :

445 
	`sŞo_mode
 (
çl£
), 
	`‹mpo_sÿË
 (100), 
	$¡©e
 (
m
, 
n
) {

446 ià(
n
)

447 
n
->
	`S‘Sequ’ûr
(
this
);

448 
Œack_´oûssÜs
.
	`»size
(
	`G‘NumT¿cks
());

449 
i
 = 0; i < 
	`G‘NumT¿cks
(); ++i)

450 
Œack_´oûssÜs
[
i
] = 
Ãw
 
MIDISequ’ûrT¿ckProûssÜ
;

451 
	}
}

454 
	gMIDISequ’ûr
::~
	$MIDISequ’ûr
() {

455 
i
 = 0; i < 
	`G‘NumT¿cks
(); ++i)

456 
d–‘e
 
Œack_´oûssÜs
[
i
];

457 
	}
}

469 
	gMIDISequ’ûr
::
	$Re£t
() {

470 
¡©e
.
	`Re£t
();

471 ià(
Œack_´oûssÜs
.
	`size
(è!ğ
	`G‘NumT¿cks
()) {

472 
i
 = 0; i < 
Œack_´oûssÜs
.
	`size
(); i++)

473 
d–‘e
 
Œack_´oûssÜs
[
i
];

474 
Œack_´oûssÜs
.
	`»size
(
	`G‘NumT¿cks
());

475 
i
 = 0; i < 
Œack_´oûssÜs
.
	`size
(); i++)

476 
Œack_´oûssÜs
[
i
] = 
Ãw
 
MIDISequ’ûrT¿ckProûssÜ
;

479 
i
 = 0; i < 
	`G‘NumT¿cks
(); ++i)

480 
Œack_´oûssÜs
[
i
]->
	`Re£t
();

481 
	}
}

485 
	gMIDISequ’ûr
::
	$S‘SŞoMode
(
boŞ
 
m
, 
Œk
) {

486 
sŞo_mode
 = 
m
;

488 
i
 = 0; i < 
	`G‘NumT¿cks
(); ++i ) {

489 if(
i
 =ğ()
Œk
)

490 
Œack_´oûssÜs
[
i
]->
sŞo
 = 
Œue
;

492 
Œack_´oûssÜs
[
i
]->
sŞo
 = 
çl£
;

494 
	}
}

497 
boŞ
 
	gMIDISequ’ûr
::
	$In£¹T¿ck
(
Œk
) {

498 ià(
Œk
 =ğ-1èŒk = 
	`G‘NumT¿cks
();

499 ià(
¡©e
.
muÉ™¿ck
->
	`In£¹T¿ck
(
Œk
)) {

500 
Œack_´oûssÜs
.
	`š£¹
Ñ¿ck_´oûssÜs.
	`begš
(è+ 
Œk
, 
Ãw
 
MIDISequ’ûrT¿ckProûssÜ
);

501 
MIDIClockTime
 
now
 = 
¡©e
.
cur_şock
;

502 
¡©e
.
	`Re£t
();

503 
	`GoToTime
(
now
);

504  
Œue
;

506  
çl£
;

507 
	}
}

510 
boŞ
 
	gMIDISequ’ûr
::
	$D–‘eT¿ck
(
Œk
) {

511 ià(
¡©e
.
muÉ™¿ck
->
	`D–‘eT¿ck
(
Œk
)) {

512 
Œack_´oûssÜs
.
	`”a£
Ñ¿ck_´oûssÜs.
	`begš
(è+ 
Œk
);

513 
MIDIClockTime
 
now
 = 
¡©e
.
cur_şock
;

514 
¡©e
.
	`Re£t
();

515 
	`GoToTime
(
now
);

516  
Œue
;

518  
çl£
;

519 
	}
}

522 
boŞ
 
	gMIDISequ’ûr
::
	$MoveT¿ck
(
äom
, 
to
) {

523 ià(
äom
 =ğ
to
è 
Œue
;

524 ià(
¡©e
.
muÉ™¿ck
->
	`MoveT¿ck
(
äom
, 
to
)) {

525 
MIDISequ’ûrT¿ckProûssÜ
* 
‹mp
 = 
Œack_´oûssÜs
[
äom
];

526 
Œack_´oûssÜs
.
	`”a£
Ñ¿ck_´oûssÜs.
	`begš
(è+ 
äom
);

527 ià(
äom
 < 
to
)

528 
to
--;

529 
Œack_´oûssÜs
.
	`š£¹
Ñ¿ck_´oûssÜs.
	`begš
(è+ 
to
, 
‹mp
);

530 
MIDIClockTime
 
now
 = 
¡©e
.
cur_şock
;

531 
¡©e
.
	`Re£t
();

532 
	`GoToTime
(
now
);

533  
Œue
;

535  
çl£
;

536 
	}
}

539 
	gMIDISequ’ûr
::
	$GoToZ”o
() {

541 
¡©e
.
	`Re£t
();

545 
	`SÿnEv’tsAtThisTime
();

547 
¡©e
.
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
);

548 
	}
}

551 
boŞ
 
	gMIDISequ’ûr
::
	$GoToTime
(
MIDIClockTime
 
time_şk
) {

552 
boŞ
 
»t
 = 
Œue
;

555 
boŞ
 
nÙif›r_mode
 = 
çl£
;

556 if(
¡©e
.
nÙif›r
) {

557 
nÙif›r_mode
 = 
¡©e
.
nÙif›r
->
	`G‘EÇbË
();

558 
¡©e
.
nÙif›r
->
	`S‘EÇbË
(
çl£
);

562 if(
time_şk
 <ğ
¡©e
.
cur_şock
)

566 
¡©e
.
	`Re£t
();

568 
MIDIClockTime
 
t
;

569 
Œk
;

570 
MIDITimedMes§ge
 
ev
;

572 
¡©e
.
cur_şock
 < 
time_şk
) {

573 ià(!
	`G‘NextEv’tTime
(&
t
)) {

574 
»t
 = 
çl£
;

577 ià(
t
 < 
time_şk
)

578 
	`G‘NextEv’t
 ( &
Œk
, &
ev
 );

579 ià(
t
 =ğ
time_şk
) {

580 
MIDIMuÉiT¿ckI‹¿tÜS‹
 
	`i¡©e
(
¡©e
.
™”©Ü
.
	`G‘S‹
());

581 
	`G‘NextEv’t
Ğ&
Œk
, &
ev
 );

582 
¡©e
.
™”©Ü
.
	`S‘S‹
Ğ
i¡©e
 );

585 
¡©e
.
cur_şock
 = 
time_şk
;

586 
¡©e
.
cur_time_ms
 = 
	`MIDItoMs
(
time_şk
);

592 ià(
»t
è
	`SÿnEv’tsAtThisTime
();

595 ifĞ
¡©e
.
nÙif›r
 ) {

596 
¡©e
.
nÙif›r
->
	`S‘EÇbË
(
nÙif›r_mode
);

598 
¡©e
.
nÙif›r
->
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
);

600  
»t
;

601 
	}
}

604 
boŞ
 
	gMIDISequ’ûr
::
	$GoToTimeMs
(
time_ms
) {

605 
boŞ
 
»t
 = 
Œue
;

608 
boŞ
 
nÙif›r_mode
 = 
çl£
;

609 if(
¡©e
.
nÙif›r
) {

610 
nÙif›r_mode
 = 
¡©e
.
nÙif›r
->
	`G‘EÇbË
();

611 
¡©e
.
nÙif›r
->
	`S‘EÇbË
(
çl£
);

615 if(
time_ms
 <ğ
¡©e
.
cur_time_ms
)

620 
¡©e
.
	`Re£t
();

622 
t
;

623 
Œk
;

624 
MIDITimedMes§ge
 
ev
;

626 
¡©e
.
cur_time_ms
 < 
time_ms
) {

627 ià(!
	`G‘NextEv’tTimeMs
(&
t
)) {

628 
»t
 = 
çl£
;

631 ià(
t
 < 
time_ms
)

632 
	`G‘NextEv’t
 (&
Œk
, &
ev
);

633 ià(
	`abs
 (
t
 - 
time_ms
) < 0.001){

634 
MIDIMuÉiT¿ckI‹¿tÜS‹
 
	`i¡©e
(
¡©e
.
™”©Ü
.
	`G‘S‹
());

635 
	`G‘NextEv’t
(&
Œk
, &
ev
);

636 
¡©e
.
™”©Ü
.
	`S‘S‹
(
i¡©e
);

639 
d–_t_ms
 = 
t
 - 
time_ms
;

640 
ms_³r_şock
 = ()6000000.0 / (
¡©e
.
‹mpobpm
 *

641 ()
‹mpo_sÿË
 * 
¡©e
.
muÉ™¿ck
->
	`G‘ClksP”B—t
());

642 
¡©e
.
cur_şock
 +ğ(
MIDIClockTime
)(
d–_t_ms
 / 
ms_³r_şock
);

643 
¡©e
.
cur_time_ms
 = 
time_ms
;

649 ià(
»t
è
	`SÿnEv’tsAtThisTime
();

652 ifĞ
¡©e
.
nÙif›r
 ) {

653 
¡©e
.
nÙif›r
->
	`S‘EÇbË
Ğ
nÙif›r_mode
 );

655 
¡©e
.
nÙif›r
->
	`NÙify
(
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
);

657  
»t
;

658 
	}
}

662 
boŞ
 
	gMIDISequ’ûr
::
	$GoToM—su»
 (
m—su»
, 
b—t
) {

663 
boŞ
 
»t
 = 
Œue
;

666 
boŞ
 
nÙif›r_mode
 = 
çl£
;

667 ià(
¡©e
.
nÙif›r
) {

668 
nÙif›r_mode
 = 
¡©e
.
nÙif›r
->
	`G‘EÇbË
();

669 
¡©e
.
nÙif›r
->
	`S‘EÇbË
 (
çl£
);

676 ià(
m—su»
 < 
¡©e
.
cur_m—su»
 ||

678 (
m—su»
 =ğ
¡©e
.
cur_m—su»
 && 
b—t
 <ğ¡©e.
cur_b—t
))

679 
¡©e
.
	`Re£t
();

681 
Œk
;

682 
MIDITimedMes§ge
 
ev
;

686 ià(
m—su»
 > 0 || 
b—t
 > 0) {

688 ià(!
	`G‘NextEv’t
(&
Œk
, &
ev
)) {

689 
»t
 = 
çl£
;

692 ià(
ev
.
	`IsB—tM¬k”
()) {

693 if(
¡©e
.
cur_m—su»
 =ğ
m—su»
 && s‹.
cur_b—t
 >ğ
b—t
)

700 ià(
»t
è
	`SÿnEv’tsAtThisTime
();

703 ià(
¡©e
.
nÙif›r
) {

704 
¡©e
.
nÙif›r
->
	`S‘EÇbË
 (
nÙif›r_mode
);

706 
¡©e
.
	`NÙify
 (
MIDISequ’ûrGUIEv’t
::
GROUP_ALL
);

709  
»t
;

710 
	}
}

713 
boŞ
 
	gMIDISequ’ûr
::
	$G‘NextEv’tTime
(
MIDIClockTime
 *
time_şk
) {

715 
boŞ
 
f
 = 
¡©e
.
™”©Ü
.
	`G‘CurEv’tTime
(
time_şk
);

717 if(
f
) {

721 if((*
time_şk
è>ğ
¡©e
.
Ãxt_b—t_time
)

723 *
time_şk
 = 
¡©e
.
Ãxt_b—t_time
;

725  
f
;

726 
	}
}

729 
boŞ
 
	gMIDISequ’ûr
::
	$G‘NextEv’tTimeMs
(*
time_ms
) {

730 
MIDIClockTime
 
t
;

731 
boŞ
 
f
 = 
	`G‘NextEv’tTime
(&
t
);

733 if(
f
)

734 *
time_ms
 = 
	`MIDItoMs
(
t
);

735  
f
;

736 
	}
}

739 
boŞ
 
	gMIDISequ’ûr
::
	$G‘NextEv’t
(*
Œk
, 
MIDITimedMes§ge
 *
msg
) {

740 
MIDIClockTime
 
t
;

743 ifĞ
¡©e
.
™”©Ü
.
	`G‘CurEv’tTime
(&
t
) ) {

745 
MIDIClockTime
 
Ãw_şock
;

746 
Ãw_time_ms
;

747 
	`G‘NextEv’tTime
(&
Ãw_şock
);

748 
	`G‘NextEv’tTimeMs
(&
Ãw_time_ms
);

753 
¡©e
.
cur_şock
 = 
Ãw_şock
;

754 
¡©e
.
cur_time_ms
 = 
Ãw_time_ms
;

757 if(
¡©e
.
Ãxt_b—t_time
 <ğ
t
) {

760 
¡©e
.
Ï¡_ev’t_Œack
 = *
Œk
 = 0;

763 
b—t_m¬k”_msg
.
	`S‘B—tM¬k”
();

764 
b—t_m¬k”_msg
.
	`S‘Time
Ğ
¡©e
.
Ãxt_b—t_time
 );

765 *
msg
 = 
b—t_m¬k”_msg
;

767 
¡©e
.
	`Proûss
(
msg
);

770 
MIDITimedMes§ge
 *
msg_±r
;

772 if(
¡©e
.
™”©Ü
.
	`G‘CurEv’t
(
Œk
, &
msg_±r
)) {

773 
¡©e
.
Ï¡_ev’t_Œack
 = *
Œk
;

776 *
msg
 = *
msg_±r
;

777 
boŞ
 
®low_msg
 = 
Œue
;

780 ifĞ
sŞo_mode
 ) {

784 
®low_msg
 = (*
Œk
 =ğ0 || 
Œack_´oûssÜs
[*Œk]->
sŞo
è? 
Œue
 : 
çl£
;

786 if(!(
®low_msg


787 && 
Œack_´oûssÜs
[*
Œk
]->
	`Proûss
(
msg
)

788 && 
¡©e
.
	`Proûss
(
msg
)))

791 
msg
->
	`CË¬
();

794 
¡©e
.
™”©Ü
.
	`GoToNextEv’t
();

797  
Œue
;

799  
çl£
;

800 
	}
}

803 
	gMIDISequ’ûr
::
	$MIDItoMs
(
MIDIClockTime
 
t
) {

804 
MIDITimedMes§ge
* 
msg
;

805 
MIDIT¿ckI‹¿tÜ
 
	`Œ_™”
(
¡©e
.
muÉ™¿ck
->
	`G‘T¿ck
(0));

806 
MIDIClockTime
 
ba£_t
 = 0, 
d–_t
 = 0, 
now_t
 = 0;

807 
ms_time
 = 0.0, 
Şd_‹mpo
 = 120.0, 
ms_³r_şock
;

809 
now_t
 < 
t
) {

810 ià(!
Œ_™”
.
	`G‘CurEv’t
(&
msg
, 
t
))

811 
now_t
 = 
t
;

813 
now_t
 = 
msg
->
	`G‘Time
();

814 ià(
msg
->
	`IsTempo
(è|| 
now_t
 =ğ
t
) {

816 
d–_t
 = 
now_t
 - 
ba£_t
;

823 
ms_³r_şock
 = 6000000.0 / (
Şd_‹mpo
 *

824 ()
‹mpo_sÿË
 * 
¡©e
.
muÉ™¿ck
->
	`G‘ClksP”B—t
());

827 
ms_time
 +ğ(
d–_t
 * 
ms_³r_şock
);

830 
ba£_t
 = 
msg
->
	`G‘Time
();

831 ià(
msg
->
	`IsTempo
())

832 
Şd_‹mpo
 = 
msg
->
	`G‘Tempo
();

833 ià(
now_t
 =ğ
t
) ;

836  
ms_time
;

837 
	}
}

840 
	gMIDISequ’ûr
::
	$SÿnEv’tsAtThisTime
() {

842 
MIDIMuÉiT¿ckI‹¿tÜS‹
 
	`i¡©e
Ğ
¡©e
.
™”©Ü
.
	`G‘S‹
() );

843 
´ev_m—su»
 = 
¡©e
.
cur_m—su»
;

844 
´ev_b—t
 = 
¡©e
.
cur_b—t
;

847 
MIDIClockTime
 
Üig_şock
 = 
¡©e
.
cur_şock
;

848 
Üig_time_ms
 = 
¡©e
.
cur_time_ms
;

850 
MIDIClockTime
 
t
 = 0;

851 
Œk
;

852 
MIDITimedMes§ge
 
ev
;

854  
	`G‘NextEv’tTime
(&
t
è&& =ğ
Üig_şock
 && 
	`G‘NextEv’t
(&
Œk
, &
ev
)) {

859 
¡©e
.
™”©Ü
.
	`S‘S‹
Ğ
i¡©e
 );

862 
¡©e
.
cur_şock
 = 
Üig_şock
;

863 
¡©e
.
cur_time_ms
 = (
Üig_time_ms
);

865 
¡©e
.
cur_m—su»
 = 
´ev_m—su»
;

866 
¡©e
.
cur_b—t
 = 
´ev_b—t
;

867 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\smpte.cpp

34 
	~"../šşude/wÜld.h
"

35 
	~"../šşude/sm±e.h
"

39 cÚ¡ 
uch¬
 
	gsm±e_max_äames
[] =

44 cÚ¡ 
	gsm±e_sm±e_¿‹s
[] =

54 cÚ¡ 
	gsm±e_sm±e_¿‹s_lÚg
[] =

64 cÚ¡ 
	gsm±e_§m¶e_¿‹s
[] =

74 cÚ¡ 
	gsm±e_§m¶e_¿‹s_lÚg
[] =

86 
	gSMPTE
::
	$SMPTE
(
SMPTE_RATE
 
sm±e_¿‹_
, 
SAMPLE_RATE
 
§m¶e_¿‹_
) :

87 
	`sm±e_¿‹
(
sm±e_¿‹_
),

88 
	`§m¶e_¿‹
(
§m¶e_¿‹_
),

89 
	`§m¶e_numb”
(0),

90 
	`hours
(0),

91 
	`mšu‹s
(0),

92 
	`£cÚds
(0),

93 
	`äames
(0),

94 
	`sub_äames
(0),

95 
	$§m¶e_numb”_dœty
(
çl£
) {

96 
	}
}

99 
	gSMPTE
::
	$SMPTE
(cÚ¡ 
SMPTE
 &
s
) {

100 
	`Cİy
(
s
);

101 
	}
}

104 
	gSMPTE
::
	$S‘Sam¶eNumb”
 (
ulÚg
 
n
) {

105 
§m¶e_numb”
 = 
n
;

106 
	`Sam¶eToTime
();

107 
	}
}

110 
ulÚg
 
	gSMPTE
::
	$G‘Sam¶eNumb”
() {

111 ià(
§m¶e_numb”_dœty
)

112 
	`TimeToSam¶e
();

113  
§m¶e_numb”
;

114 
	}
}

117 
	gSMPTE
::
	$S‘Time
 (
uch¬
 
h
, uch¬ 
m
, uch¬ 
s
, uch¬ 
f
, uch¬ 
sf
) {

118 
hours
 = 
h
;

119 
mšu‹s
 = 
m
;

120 
£cÚds
 = 
s
;

121 
äames
 = 
f
;

122 
sub_äames
 = 
sf
;

123 
§m¶e_numb”_dœty
 = 
Œue
;

124 
	}
}

127 
	gSMPTE
::
	$S‘MliSecÚds
 (
ulÚg
 
m£cs
) {

128 
§m¶e_numb”
 = (
ulÚg
è(
m£cs
 * 
	`G‘Sam¶eR©eF»qu’cy
(
§m¶e_¿‹
) / 1000);

129 
	`Sam¶eToTime
();

130 
	}
}

133 
ulÚg
 
	gSMPTE
::
	$G‘MliSecÚds
 () {

134 ià(
§m¶e_numb”_dœty
)

135 
	`TimeToSam¶e
();

136  (
ulÚg
 ) (
§m¶e_numb”
 * 1000 / 
	`G‘Sam¶eR©eF»qu’cy
(
§m¶e_¿‹
));

137 
	}
}

140 
	gSMPTE
::
	$AddSam¶es
 (
n
) {

141 
§m¶e_numb”
 = 
	`G‘Sam¶eNumb”
(è+ 
n
;

142 
	`Sam¶eToTime
();

143 
	}
}

146 
	gSMPTE
::
	$AddHours
(
h
) {

147 
	`AddSam¶es
Ğ
	`G‘Sam¶eR©eLÚg
()

148 * 
h
 *

154 
	}
}

157 
	gSMPTE
::
	$AddMšu‹s
(
m
) {

158 
	`AddSam¶es
Ğ
	`G‘Sam¶eR©eLÚg
()

159 * 
m
 *

163 
	}
}

166 
	gSMPTE
::
	$AddSecÚds
(
s
) {

167 
	`AddSam¶es
Ğ
	`G‘Sam¶eR©eLÚg
()

168 * 
s


171 
	}
}

174 
	gSMPTE
::
	$AddF¿mes
(
f
) {

175 
	`AddSam¶es
Ğ
	`G‘Sam¶eR©eLÚg
()

176 * 
f


178 / 
	`G‘SMPTER©eLÚg
()

180 
	}
}

183 
	gSMPTE
::
	$AddSubF¿mes
(
sf
) {

184 
	`AddSam¶es
Ğ
	`G‘Sam¶eR©eLÚg
()

185 * 
sf


186 / 
	`G‘SMPTER©eLÚg
()

189 
	}
}

193 
	gSMPTE
::
	$Sam¶eToTime
() {

196 
ulÚg
 
tmp_§m¶e
=
§m¶e_numb”
;

199 
the_sm±e_¿‹
 = 
sm±e_sm±e_¿‹s
[ 
sm±e_¿‹
 ];

200 
the_§m¶e_¿‹
 = 
sm±e_§m¶e_¿‹s
[ 
§m¶e_¿‹
 ];

203 
uch¬
 
max_äame
 = 
sm±e_max_äames
[ 
sm±e_¿‹
 ];

206 
§m¶es_³r_äame
 = 
sm±e_§m¶e_¿‹s
[
§m¶e_¿‹
] / 
sm±e_sm±e_¿‹s
[
sm±e_¿‹
];

210 if(
sm±e_¿‹
 =ğ
SMPTE_RATE_30DF
 || sm±e_¿‹ =ğ
SMPTE_RATE_2997DF
) {

214 
num_mšu‹s
 = 
tmp_§m¶e
/(48000 * 60);

217 
‹n_mšu‹s
 = 
num_mšu‹s
 / 10;

220 
drİs
 = (
num_mšu‹s
 - 
‹n_mšu‹s
) * 2;

223 
tmp_§m¶e
 +ğ(
ulÚg
)(
drİs
 * 
§m¶es_³r_äame
);

227 
ulÚg
 
rounded_sub_äames
ğ(ulÚg)((
tmp_§m¶e
*
the_sm±e_¿‹
 * 100)/
the_§m¶e_¿‹
 +.5);

229 
sub_äames
 = (
uch¬
è((
rounded_sub_äames
) % 100);

230 
äames
 = (
uch¬
è((
rounded_sub_äames
 / 100è% 
max_äame
);

231 
£cÚds
 = (
uch¬
è((
rounded_sub_äames
 / (100L * 
max_äame
)) % 60 );

232 
mšu‹s
 = (
uch¬
è((
rounded_sub_äames
 / (100L * 60L * 
max_äame
)) % 60 );

233 
hours
 = (
uch¬
è((
rounded_sub_äames
 / (100L * 60L * 24L *
max_äame
)) % 24 );

234 
	}
}

237 
	gSMPTE
::
	$TimeToSam¶e
() {

240 
the_sm±e_¿‹
 = 
sm±e_sm±e_¿‹s
[
sm±e_¿‹
];

241 
the_§m¶e_¿‹
 = 
sm±e_§m¶e_¿‹s
[
§m¶e_¿‹
];

244 
§m¶es_³r_äame
 = 
the_§m¶e_¿‹
 / 
the_sm±e_¿‹
;

247 
tmp_§m¶e
 = () (

248 Ğ(
hours
 * 
the_§m¶e_¿‹
 * (60 * 60))

249 + (
mšu‹s
 * 
the_§m¶e_¿‹
 * 60)

250 + (
£cÚds
 * 
the_§m¶e_¿‹
)

251 + (
äames
 * 
§m¶es_³r_äame
)

252 + (
sub_äames
 * 
§m¶es_³r_äame
 * (1.0/100.0) ) +.5)

256 if(
sm±e_¿‹
 =ğ
SMPTE_RATE_30DF
 || sm±e_¿‹==
SMPTE_RATE_2997DF
) {

259 
num_mšu‹s
 = ()(()
tmp_§m¶e
 / (
sm±e_§m¶e_¿‹s
[
§m¶e_¿‹
] * 60));

262 
‹n_mšu‹s
 = 
num_mšu‹s
 / 10;

265 
drİs
 = (
num_mšu‹s
 - 
‹n_mšu‹s
) * 2;

268 
tmp_§m¶e
 -ğ
drİs
 * 
§m¶es_³r_äame
;

272 
§m¶e_numb”
 = (
ulÚg
)
tmp_§m¶e
;

273 
	}
}

276 
	gSMPTE
::
	$Cİy
(cÚ¡ 
SMPTE
 &
s
) {

277 
sm±e_¿‹
 = 
s
.smpte_rate;

278 
§m¶e_¿‹
 = 
s
.sample_rate;

279 
§m¶e_numb”
 = 
s
.sample_number;

280 
hours
 = 
s
.hours;

281 
mšu‹s
 = 
s
.minutes;

282 
£cÚds
 = 
s
.seconds;

283 
äames
 = 
s
.frames;

284 
sub_äames
 = 
s
.sub_frames;

285 
§m¶e_numb”_dœty
 = 
s
.sample_number_dirty;

286 
	}
}

289 
	gSMPTE
::
	$Com·»
(
SMPTE
 & 
s
) {

290 
ulÚg
 
a
 = 
	`G‘Sam¶eNumb”
();

291 
ulÚg
 
b
 = 
s
.
	`G‘Sam¶eNumb”
();

293 if(
a
 < 
b
)

295 if(
a
 > 
b
)

298 
	}
}

301 
	gSMPTE
::
	$Add
(
SMPTE
 &
s
) {

302 
ulÚg
 
a
 = 
	`G‘Sam¶eNumb”
();

303 
ulÚg
 
b
 = 
s
.
	`G‘Sam¶eNumb”
();

305 
	`S‘Sam¶eNumb”
(
a
 + 
b
);

306 
	}
}

309 
	gSMPTE
::
	$SubŒaù
(
SMPTE
 &
s
) {

310 
ulÚg
 
a
 = 
	`G‘Sam¶eNumb”
();

311 
ulÚg
 
b
 = 
s
.
	`G‘Sam¶eNumb”
();

313 
	`S‘Sam¶eNumb”
(
a
 - 
b
);

314 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\sysex.cpp

38 
	~"../šşude/wÜld.h
"

39 
	~"../šşude/sy£x.h
"

41 #iâdeà
DEBUG_MDSYSEX


42 
	#DEBUG_MDSYSEX
 0

	)

45 #ià
DEBUG_MDSYSEX


46 #undeà
DBG


47 
	#DBG
(
a
è
	)
a

51 
	~<io¡»am
>

54 cÚ¡ 
	gMIDISy¡emExşusive
::
GMRe£t_d©a
[] = { 0xF0, 0x7E, 0x7F, 0x09, 0x01, 0xF7 };

55 cÚ¡ 
	gMIDISy¡emExşusive
::
GSRe£t_d©a
[] = { 0xF0, 0x41, 0x10, 0x42, 0x12, 0x40, 0x00, 0x7F, 0x00, 0x41, 0xF7 };

56 cÚ¡ 
	gMIDISy¡emExşusive
::
XGRe£t_d©a
[] = { 0xF0, 0x43, 0x10, 0x4C, 0x00, 0x00, 0x7E, 0x00, 0xF7 };

59 
	gMIDISy¡emExşusive
::
	$MIDISy¡emExşusive
Ğ
size_
 ) {

60 
buf
=
Ãw
 
uch¬
[
size_
];

61 ifĞ
buf
 )

62 
max_Ën
=
size_
;

64 
max_Ën
=0;

66 
cur_Ën
=0;

67 
chk_sum
=0;

68 
d–‘abË
=
Œue
;

69 
	}
}

72 
	gMIDISy¡emExşusive
::
	$MIDISy¡emExşusive
ĞcÚ¡ 
MIDISy¡emExşusive
 &
e
 ) {

73 
buf
 = 
Ãw
 [
e
.
max_Ën
];

74 
max_Ën
 = 
e
.max_len;

76 
cur_Ën
 = 
e
.cur_len;

77 
chk_sum
 = 
e
.chk_sum;

78 
d–‘abË
 = 
Œue
;

80  
i
=0; i<
cur_Ën
; ++i )

81 
buf
[
i
] = 
e
.buf[i];

82 
	}
}

85 
	gMIDISy¡emExşusive
::
	$MIDISy¡emExşusive
(*
buf_
, 
max_Ën_
, 
cur_Ën_
, 
boŞ
 
d–‘abË_
) {

87 
buf
=
buf_
;

88 
max_Ën
=
max_Ën_
;

89 
cur_Ën
=
cur_Ën_
;

90 
chk_sum
=0;

91 
d–‘abË
=
d–‘abË_
;

92 
	}
}

95 
	gMIDISy¡emExşusive
::~
	$MIDISy¡emExşusive
() {

96 ifĞ
d–‘abË
 )

97 
d–‘e
 [] 
buf
;

99 
	}
}

102 
boŞ
 
	gİ”©Ü
 =ğĞcÚ¡ 
MIDISy¡emExşusive
 &
e1
, cÚ¡ 
	gMIDISy¡emExşusive
 &
	ge2
 ) {

103 iàĞ
	ge1
.
	gcur_Ën
 !ğ
e2
.
cur_Ën
 )

104  
çl£
;

105 iàĞ
	ge1
.
	gcur_Ën
 == 0 )

106  
Œue
;

107  
memcmp
Ğ
e1
.
buf
, 
e2
.buf,ƒ1.
cur_Ën
 ) == 0 ;

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\timer.cpp

1 
	~"../šşude/tim”.h
"

3 
	gMIDITim”
::
tim•ošt
 
MIDITim”
::
sys_şock_ba£
 = 
¡—dy_şock
::
now
();

6 
	gMIDITim”
::
	$MIDITim”
(
»s
è: 
	`»sŞutiÚ
Ôes), 
	`tick
(0), 
	`tick_·¿m
(0),

7 
	$tim”_Ú
(
çl£
è{
	}
}

10 
	gMIDITim”
::
	$S‘ResŞutiÚ
(
»s
) {

11 
	`Stİ
();

12 
»sŞutiÚ
 = 
»s
;

13 
	}
}

16 
	gMIDITim”
::
	$S‘MIDITick
(
MIDITick
 
t
, * 

) {

17 
	`Stİ
();

18 
tick
 = 
t
;

19 
tick_·¿m
 = 

;

20 
	}
}

23 
boŞ
 
	gMIDITim”
::
	$S¹
 () {

24 if(
bg_th»ad
.
	`jošabË
(è|| 
tick
 == 0)

25  
çl£
;

27 
tim”_Ú
 = 
Œue
;

28 
bg_th»ad
 = 
¡d
::
	`th»ad
(
Th»adProc
, 
this
);

30 
¡d
::
cout
 << "Tim” o³Àw™h " << 
»sŞutiÚ
 << " m£c »sŞutiÚ" << std::
’dl
;

32  
Œue
;

33 
	}
}

36 
	gMIDITim”
::
	$Stİ
() {

37 ià(
tim”_Ú
) {

38 
tim”_Ú
 = 
çl£
;

39 
bg_th»ad
.
	`još
();

41 
¡d
:: 
cout
 << "Tim” stİ³d" << std::
’dl
;

43 
	}
}

47 
	gMIDITim”
::
	$Th»adProc
(
MIDITim”
* 
tim”
) {

48 
tim•ošt
 
cu¼’t
, 
Ãxt
;

49 
du¿tiÚ
 
	`tick
(
tim”
->
»sŞutiÚ
);

51 
tim”
->
tim”_Ú
) {

52 
cu¼’t
 = 
¡—dy_şock
::
	`now
();

54 
tim”
->
	`tick
Ñim”->
	`G‘SysTimeMs
(),im”->
tick_·¿m
);

56 
Ãxt
 = 
cu¼’t
 + 
tick
;

57 
¡d
::
this_th»ad
::
	`¦“p_uÁ
(
Ãxt
);

59 
	}
}

	@C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\track.cpp

24 
	~"../šşude/Œack.h
"

25 
	~"../šşude/m©rix.h
"

32 
	gMIDIT¿ck
::
šs_mode
 = 
INSMODE_INSERT_OR_REPLACE
;

35 
	gMIDIT¿ck
::
	$MIDIT¿ck
(
MIDIClockTime
 
’d_t
) {

37 
MIDITimedMes§ge
 
msg
;

38 
msg
.
	`S‘D©aEnd
();

39 
msg
.
	`S‘Time
(
’d_t
);

40 
ev’ts
.
	`push_back
(
msg
);

41 
	}
}

44 
	gMIDIT¿ck
::
	$MIDIT¿ck
(cÚ¡ 
MIDIT¿ck
& 
Œk
) {

45 
ev’ts
 = 
Œk
.events;

46 
	}
}

49 
	gMIDIT¿ck
::~
	$MIDIT¿ck
(è{
	}
}

52 
MIDIT¿ck
& MIDIT¿ck::
İ”©Ü
=(cÚ¡ MIDIT¿ck& 
Œk
) {

53 
ev’ts
 = 
Œk
.events;

54  *
	gthis
;

58 
	gMIDIT¿ck
::
	$CË¬
(
boŞ
 
mªš_’d
) {

59 
MIDIClockTime
 
’d
 = 
mªš_’d
 ? 
	`G‘EndTime
() : 0;

60 
ev’ts
.
	`»size
(0);

61 
MIDITimedMes§ge
 
msg
;

62 
msg
.
	`S‘D©aEnd
();

63 
msg
.
	`S‘Time
(
’d
);

64 
ev’ts
.
	`push_back
(
msg
);

65 
	}
}

68 
boŞ
 
	gMIDIT¿ck
::
	$S‘EndTime
(
MIDIClockTime
 
’d_t
) {

69 ià(
’d_t
 < 
	`G‘EndTime
(è&& 
ev’ts
.
	`size
() > 1)

70 ià(
ev’ts
[ev’ts.
	`size
(è- 2].
	`G‘Time
(è> 
’d_t
è 
çl£
;

72 
ev’ts
.
	`back
().
	`S‘Time
(
’d_t
);

73  
Œue
;

74 
	}
}

77 
	gMIDIT¿ck
::
	$S‘ChªÃl
(
ch
) {

78 
ch
 &= 0x0f;

79 
i
 = 0; i < 
ev’ts
.
	`size
(); i++) {

80 ià(
	`G‘Ev’t
(
i
).
	`IsChªÃlMsg
())

81 
	`G‘Ev’t
(
i
).
	`S‘ChªÃl
(
ch
);

83 
	}
}

86 
MIDIClockTime
 
	gMIDIT¿ck
::
	$G‘NÙeL’gth
(cÚ¡ 
MIDITimedMes§ge
& 
msg
) const {

87 if(!
msg
.
	`IsNÙeOn
())  0;

88 
ev_num
;

89 ià(!
	`FšdEv’tNumb”
(
msg
, &
ev_num
))  0;

90 
	`IsV®idEv’tNum
(
ev_num
)) {

91 ià(
ev’ts
[
ev_num
].
	`IsNÙeOff
() &&

92 
ev’ts
[
ev_num
].
	`G‘ChªÃl
(è=ğ
msg
.GetChannel() &&

93 
ev’ts
[
ev_num
].
	`G‘NÙe
(è=ğ
msg
.GetNote())

94  
ev’ts
[
ev_num
].
	`G‘Time
(è- 
msg
.GetTime();

95 
ev_num
++;

99  
TIME_INFINITE
;

100 
	}
}

103 
	gMIDIT¿ck
::
	$S‘In£¹Mode
Ğ
mode
 )

105 iàĞ
mode
 !ğ
INSMODE_DEFAULT
 )

106 
šs_mode
 = 
mode
;

107 
	}
}

144 
boŞ
 
	gMIDIT¿ck
::
	$In£¹Ev’t
(cÚ¡ 
MIDITimedMes§ge
& 
msg
, 
mode
) {

145 ià(
msg
.
	`IsD©aEnd
()è 
çl£
;

147 ià(
	`G‘EndTime
(è< 
msg
.
	`G‘Time
()) {

148 
	`S‘EndTime
(
msg
.
	`G‘Time
());

149 
ev’ts
.
	`š£¹
Óv’ts.
	`’d
(è- 1, 
msg
);

150  
Œue
;

153 
ev_num
;

155 
	`FšdEv’tNumb”
(
msg
.
	`G‘Time
(), &
ev_num
);

156 
Şd_ev_num
 = 
ev_num
;

158 ià(
mode
 =ğ
INSMODE_DEFAULT
)

159 
mode
 = 
šs_mode
;

161 
mode
) {

162 
INSMODE_INSERT
:

164 
MIDITimedMes§ge
::
	`Com·»Ev’tsFÜIn£¹
(
msg
, 
ev’ts
[
ev_num
]) == 1)

165 
ev_num
++;

166 
ev’ts
.
	`š£¹
Óv’ts.
	`begš
(è+ 
ev_num
, 
msg
);

167  
Œue
;

169 
INSMODE_REPLACE
:

171 
	`IsV®idEv’tNum
(
ev_num
è&& 
ev’ts
[ev_num].
	`G‘Time
(è=ğ
msg
.GetTime()) {

172 ià(
MIDITimedMes§ge
::
	`IsSameKšd
(
ev’ts
[
ev_num
], 
msg
)) {

173 
ev’ts
[
ev_num
] = 
msg
;

174  
Œue
;

176 
ev_num
++;

178  
çl£
;

180 
INSMODE_INSERT_OR_REPLACE
:

181 
INSMODE_INSERT_OR_REPLACE_BUT_NOTE
:

183 
	`IsV®idEv’tNum
(
ev_num
è&& 
ev’ts
[ev_num].
	`G‘Time
(è=ğ
msg
.GetTime()) {

184 ià(
MIDITimedMes§ge
::
	`IsSameKšd
(
ev’ts
[
ev_num
], 
msg
) &&

185 (
mode
 =ğ
INSMODE_INSERT_OR_REPLACE
 || !
msg
.
	`IsNÙe
())) {

186 
ev’ts
[
ev_num
] = 
msg
;

187  
Œue
;

189 
ev_num
++;

192 
ev_num
 = 
Şd_ev_num
;

193 
MIDITimedMes§ge
::
	`Com·»Ev’tsFÜIn£¹
(
msg
, 
ev’ts
[
ev_num
]) == 1)

194 
ev_num
++;

195 
ev’ts
.
	`š£¹
Óv’ts.
	`begš
(è+ 
ev_num
, 
msg
);

196  
Œue
;

199  
çl£
;

200 
	}
}

203 
boŞ
 
	gMIDIT¿ck
::
	$In£¹NÙe
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
, 
MIDIClockTime
 
Ën
, 
mode
 ) {

204 ià(!
msg
.
	`IsNÙeOn
()è 
çl£
;

206 
MIDITimedMes§ge
 
	`msgoff
(
msg
);

207 
msgoff
.
	`S‘Ty³
(
NOTE_OFF
);

208 
msgoff
.
	`S‘Time
(
msg
.
	`G‘Time
(è+ 
Ën
);

210 
ev_num
;

212 ià(
mode
 =ğ
INSMODE_DEFAULT
)

213 
mode
 = 
šs_mode
;

215 
mode
) {

216 
INSMODE_INSERT
:

217 
INSMODE_INSERT_OR_REPLACE_BUT_NOTE
:

218 
	`In£¹Ev’t
(
msg
, 
mode
);

219 
	`In£¹Ev’t
(
msgoff
, 
mode
);

220  
Œue
;

222 
INSMODE_REPLACE
:

223 ià(
	`FšdEv’tNumb”
(
msg
, &
ev_num
, 
COMPMODE_SAMEKIND
)) {

225 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

226 
	`IsV®idEv’tNum
(
ev_num
) ) {

227 ià(
ev’ts
[
ev_num
].
	`IsNÙeOff
(è&&ƒv’ts[ev_num].
	`G‘NÙe
(è=ğ
msg
.GetNote()) {

228 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

231 
ev_num
++;

233 
	`In£¹Ev’t
(
msg
, 
INSMODE_INSERT
);

234 
	`In£¹Ev’t
(
msgoff
, 
INSMODE_INSERT
);

235  
Œue
;

237  
çl£
;

239 
INSMODE_INSERT_OR_REPLACE
:

240 ià(
	`FšdEv’tNumb”
(
msg
, &
ev_num
, 
COMPMODE_SAMEKIND
)) {

242 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

243 
	`IsV®idEv’tNum
(
ev_num
)) {

244 ià(
ev’ts
[
ev_num
].
	`IsNÙeOff
(è&&ƒv’ts[ev_num].
	`G‘NÙe
(è=ğ
msg
.GetNote()) {

245 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

248 
ev_num
++;

251 
	`In£¹Ev’t
(
msg
, 
INSMODE_INSERT
);

252 
	`In£¹Ev’t
(
msgoff
, 
INSMODE_INSERT
);

253  
Œue
;

259  
çl£
;

260 
	}
}

286 
boŞ
 
	gMIDIT¿ck
::
	$D–‘eEv’t
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
 )

288 ià(
msg
.
	`IsD©aEnd
())

289  
çl£
;

290 
ev_num
;

291 ià(!
	`FšdEv’tNumb”
(
msg
, &
ev_num
))

292  
çl£
;

293 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

294  
Œue
;

295 
	}
}

298 
boŞ
 
	gMIDIT¿ck
::
	$D–‘eNÙe
ĞcÚ¡ 
MIDITimedMes§ge
& 
msg
 ) {

299 ià(!
msg
.
	`IsNÙeOn
())

300  
çl£
;

302 
ev_num
;

303 ià(!
	`FšdEv’tNumb”
(
msg
, &
ev_num
))

304  
çl£
;

305 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

306 
	`IsV®idEv’tNum
(
ev_num
)) {

307 ià(
ev’ts
[
ev_num
].
	`IsNÙeOff
(è&&ƒv’ts[ev_num].
	`G‘NÙe
(è=ğ
msg
.GetNote()) {

308 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

311 
ev_num
++;

313  
Œue
;

314 
	}
}

317 
	gMIDIT¿ck
::
	$PushEv’t
(cÚ¡ 
MIDITimedMes§ge
& 
msg
) {

318 ià(
msg
.
	`IsD©aEnd
()) ;

320 ià(
	`G‘EndTime
(è< 
msg
.
	`G‘Time
())

321 
	`S‘EndTime
(
msg
.
	`G‘Time
());

322 
ev’ts
.
	`š£¹
Óv’ts.
	`’d
(è- 1, 
msg
);

323 
	}
}

326 
	gMIDIT¿ck
::
	$In£¹IÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
Ëngth
, cÚ¡ 
MIDIT¿ck
* 
¤c
) {

327 ià(
Ëngth
 == 0) ;

329 
	`Clo£O³nEv’ts
(
¡¬t
);

330 
¡¬t_n
;

331 ià(
	`FšdEv’tNumb”
(
¡¬t
, &
¡¬t_n
)) {

332 
i
 = 
¡¬t_n
; i < 
ev’ts
.
	`size
(); i++)

333 
ev’ts
[
i
].
	`AddTime
(
Ëngth
);

335 if(!
¤c
) ;

337 
i
 = 0; i < 
¤c
->
	`G‘NumEv’ts
(); i++) {

339 
MIDITimedMes§ge
 
msg
 = 
¤c
->
ev’ts
[
i
];

340 ià(
msg
.
	`G‘Time
(è>ğ
Ëngth
) ;

341 
msg
.
	`AddTime
(
¡¬t
);

343 
	`In£¹Ev’t
(
msg
);

345 
	`Clo£O³nEv’ts
(
¡¬t
 + 
Ëngth
);

346 
	}
}

349 
MIDIT¿ck
* 
	gMIDIT¿ck
::
	$MakeIÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
, 
MIDIT¿ck
* 
š‹rv®
) const {

350 
š‹rv®
->
	`CË¬
();

351 ià(
’d
 > 
	`G‘EndTime
())

352 
’d
 = 
	`G‘EndTime
();

353 ià(
’d
 <ğ
¡¬t
è 
š‹rv®
;

355 
MIDIT¿ck
 
	`ed™Œack
(*
this
);

357 
š‹rv®
->
	`S‘EndTime
(
’d
 - 
¡¬t
);

358 
ed™Œack
.
	`Clo£O³nEv’ts
(
¡¬t
);

360 
ed™Œack
.
	`Clo£O³nEv’ts
(
’d
);

362 
ev_num
;

363 
ed™Œack
.
	`FšdEv’tNumb”
(
¡¬t
, &
ev_num
);

364 
MIDITimedMes§ge
 
msg
 = 
ed™Œack
.
ev’ts
[
ev_num
];

365 ; 
msg
.
	`G‘Time
(è<ğ
’d
 && !msg.
	`IsD©aEnd
(); 
ev_num
++, msg = 
ed™Œack
.
ev’ts
[ev_num]) {

366 ià(
msg
.
	`G‘Time
(è=ğ
¡¬t
 &&

367 (
msg
.
	`IsNÙeOff
(è|| msg.
	`IsPed®Off
() ||

368 (
msg
.
	`IsP™chB’d
(è&& msg.
	`G‘B’d”V®ue
() == 0)))

370 ià(
msg
.
	`G‘Time
(è=ğ
’d
 &&

371 (
msg
.
	`IsNÙeOn
(è|| msg.
	`IsPed®On
() ||

372 (
ev’ts
[
ev_num
].
	`IsP™chB’d
(è&&ƒv’ts[ev_num].
	`G‘B’d”V®ue
() != 0)))

375 
msg
.
	`SubTime
(
¡¬t
);

376 
š‹rv®
->
	`In£¹Ev’t
(
msg
);

378  
š‹rv®
;

379 
	}
}

382 
	gMIDIT¿ck
::
	$D–‘eIÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
) {

383 ià(
’d
 > 
	`G‘EndTime
())

384 
’d
 = 
	`G‘EndTime
();

385 ià(
’d
 <ğ
¡¬t
) ;

386 
	`CË¬IÁ”v®
(
¡¬t
, 
’d
);

387 
ev_num
;

388 
	`FšdEv’tNumb”
(
’d
, &
ev_num
);

389 
i
 = 
ev_num
; i < 
ev’ts
.
	`size
(); i++)

390 
ev’ts
[
i
].
	`SubTime
(
’d
 - 
¡¬t
);

391 
	}
}

394 
	gMIDIT¿ck
::
	$CË¬IÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
’d
) {

395 ià(
’d
 > 
	`G‘EndTime
())

396 
’d
 = 
	`G‘EndTime
();

397 ià(
’d
 <ğ
¡¬t
) ;

399 
	`Clo£O³nEv’ts
(
¡¬t
);

401 
	`Clo£O³nEv’ts
(
’d
);

402 
ev_num
;

403 
ev_to_»move
 = 0;

404 
	`FšdEv’tNumb”
(
¡¬t
, &
ev_num
);

405 
ev’ts
[
ev_num
].
	`G‘Time
(è=ğ
¡¬t
 &&

406 (
ev’ts
[
ev_num
].
	`IsNÙeOff
(è||ƒv’ts[ev_num].
	`IsPed®Off
() ||

407 (
ev’ts
[
ev_num
].
	`IsP™chB’d
(è&&ƒv’ts[ev_num].
	`G‘B’d”V®ue
() == 0)))

408 
ev_num
++;

409 
ev’ts
[
ev_num
].
	`G‘Time
(è< 
’d
) {

410 
ev_num
++;

411 
ev_to_»move
++;

413 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
,ƒv’ts.begš(è+ƒv_num + 
ev_to_»move
);

415 
ev’ts
[
ev_num
].
	`G‘Time
(è=ğ
’d
 && !ev’ts[ev_num].
	`IsD©aEnd
())

416 ià(
ev’ts
[
ev_num
].
	`IsNÙeOff
(è||ƒv’ts[ev_num].
	`IsPed®Off
() ||

417 (
ev’ts
[
ev_num
].
	`IsP™chB’d
(è&&ƒv’ts[ev_num].
	`G‘B’d”V®ue
() == 0))

418 
ev’ts
.
	`”a£
Óv’ts.
	`begš
(è+ 
ev_num
);

420 
ev_num
++;

421 
	}
}

424 
	gMIDIT¿ck
::
	$R•ÏûIÁ”v®
(
MIDIClockTime
 
¡¬t
, MIDIClockTim
Ëngth
, 
boŞ
 
sy£x
, cÚ¡ 
MIDIT¿ck
* 
¤c
) {

425 ià(
Ëngth
 == 0) ;

427 
	`CË¬IÁ”v®
(
¡¬t
, s¹ + 
Ëngth
);

428 
i
 = 0; i < 
¤c
->
	`G‘NumEv’ts
(); i++) {

429 
MIDITimedMes§ge
 
	`msg
(
¤c
->
	`G‘Ev’t
(
i
));

430 ià(
msg
.
	`G‘Time
(è>ğ
Ëngth
) ;

431 
msg
.
	`AddTime
(
¡¬t
);

432 
	`In£¹Ev’t
(
msg
);

434 
	`Clo£O³nEv’ts
(
¡¬t
 + 
Ëngth
);

435 
	}
}

438 
	gMIDIT¿ck
::
	$Clo£O³nEv’ts
(
MIDIClockTime
 
t
) {

439 ià(
t
 =ğ0 || >ğ
	`G‘EndTime
()) ;

441 
MIDIT¿ckI‹¿tÜ
 
	`™”
(
this
);

442 
ch
 = 
™”
.
	`G‘MIDIChªÃl
();

443 
MIDITimedMes§ge
* 
msgp
;

444 
MIDITimedMes§ge
 
msg
;

446 
™”
.
	`GoToTime
(
t
);

447 
msg
.
	`S‘Time
(
t
);

448 ià(
™”
.
	`NÙesOn
()) {

449 
i
 = 0; i < 0x7f; i++) {

450 
msg
.
	`S‘NÙeOn
(
ch
, 
i
, 100);

451 ià(
™”
.
	`IsNÙeOn
(
i
è&& !™”.
	`Ev’tIsNow
(
msg
)) {

452 ià(
™”
.
	`FšdNÙeOff
(
i
, &
msgp
))

453 
	`D–‘eEv’t
(*
msgp
);

454 
msg
.
	`S‘NÙeOff
(
ch
, 
i
, 0);

455 
	`In£¹Ev’t
(
msg
);

459 
msg
.
	`S‘CÚŒŞChªge
(
ch
, 
C_DAMPER
, 127);

460 ià(
™”
.
	`IsPed®On
()&& !™”.
	`Ev’tIsNow
(
msg
)) {

461 
™”
.
	`GoToTime
(
t
);

462 ià(
™”
.
	`FšdPed®Off
(&
msgp
))

463 
	`D–‘eEv’t
(*
msgp
);

464 
msg
.
	`S‘CÚŒŞChªge
(
ch
, 
C_DAMPER
, 0);

465 
	`In£¹Ev’t
(
msg
);

466 
msg
.
	`S‘Time
(
t
);

468 
msg
.
	`S‘P™chB’d
(
ch
, 0);

469 ià(
™”
.
	`G‘B’d”
()) {

470 
™”
.
	`GoToTime
(
t
);

471 
™”
.
	`G‘CurEv’t
(&
msgp
)) {

472 ià(
msgp
->
	`IsP™chB’d
()) {

473 
v®
 = 
msgp
->
	`G‘B’d”V®ue
();

474 
	`D–‘eEv’t
(*
msgp
);

475 ià(
v®
 == 0) ;

478 
	`In£¹Ev’t
(
msg
);

480 
	}
}

484 
boŞ
 
	gMIDIT¿ck
::
	$FšdEv’tNumb”
(cÚ¡ 
MIDITimedMes§ge
& 
msg
, * 
ev’t_num
, 
mode
) const {

485 ià(
msg
.
	`G‘Time
(è> 
	`G‘EndTime
()) {

486 *
ev’t_num
 = -1;

487  
çl£
;

490 
mš
 = 0,

491 
max
 = 
ev’ts
.
	`size
() - 1;

492 
mš
 < 
max
) {

493 
mid
 = 
mš
 + (
max
 - min) / 2;

494 ià(
	`G‘Ev’tAdd»ss
(
mid
)->
	`G‘Time
(è< 
msg
.GetTime())

495 
mš
 = 
mid
 + 1;

497 
max
 = 
mid
;

500 *
ev’t_num
 = 
mš
;

503 ià(
mode
 =ğ
COMPMODE_TIME
)

504  
	`G‘Ev’tAdd»ss
(
mš
)->
	`G‘Time
(è=ğ
msg
.GetTime();

507 
	`IsV®idEv’tNum
(
mš
è&& 
	`G‘Ev’tAdd»ss
(mš)->
	`G‘Time
(è=ğ
msg
.GetTime()) {

508 ià(
mode
 =ğ
COMPMODE_EQUAL
) {

509 ià(
	`G‘Ev’t
(
mš
è=ğ
msg
) {

510 *
ev’t_num
 = 
mš
;

511  
Œue
;

514 ià(
mode
 =ğ
COMPMODE_SAMEKIND
) {

515 ià(
MIDITimedMes§ge
::
	`IsSameKšd
(
	`G‘Ev’t
(
mš
), 
msg
)) {

516 *
ev’t_num
 = 
mš
;

517  
Œue
;

520 
mš
++;

522  
çl£
;

523 
	}
}

526 
boŞ
 
	gMIDIT¿ck
::
	$FšdEv’tNumb”
(
MIDIClockTime
 
time
, * 
ev’t_num
) const {

527 ià(
time
 > 
	`G‘EndTime
()) {

528 *
ev’t_num
 = -1;

529  
çl£
;

532 
mš
 = 0,

533 
max
 = 
ev’ts
.
	`size
() - 1;

534 
mš
 < 
max
 ) {

535 
mid
 = 
mš
 + (
max
 - min) / 2;

536 ià(
	`G‘Ev’tAdd»ss
(
mid
)->
	`G‘Time
(è< 
time
)

537 
mš
 = 
mid
 + 1;

539 
max
 = 
mid
;

542 *
ev’t_num
 = 
mš
;

543 ià(
	`G‘Ev’tAdd»ss
(
mš
)->
	`G‘Time
(è=ğ
time
)

544  
Œue
;

545  
çl£
;

546 
	}
}

596 
	gMIDIT¿ckI‹¿tÜ
::
	$MIDIT¿ckI‹¿tÜ
(
MIDIT¿ck
* 
Œk
è: 
	$Œack
(
Œk
) {

597 
	`FšdChªÃl
();

598 
	`Re£t
();

599 
	}
}

602 
	gMIDIT¿ckI‹¿tÜ
::
	$S‘T¿ck
(
MIDIT¿ck
* 
Œk
) {

603 
Œack
 = 
Œk
;

604 
	`FšdChªÃl
();

605 
	`Re£t
();

606 
	}
}

609 
	gMIDIT¿ckI‹¿tÜ
::
	$Re£t
() {

611 
cur_time
 = 0;

612 
cur_ev_num
 = 0;

615 
´og¿m
 = 0xff;

616 
i
 = 0; i < 128; i++) {

617 
cÚŒŞs
[
i
] = 0xff;

618 
nÙes_Ú
[
i
] = 0;

620 
b’d”_v®ue
 = 0;

621 
num_nÙes_Ú
 = 0;

622 
	`SÿnEv’tsAtThisTime
();

623 
	}
}

627 
boŞ
 
	gMIDIT¿ckI‹¿tÜ
::
	$FšdNÙeOff
(
uch¬
 
nÙe
, 
MIDITimedMes§ge
** 
msg
) {

628 
i
 = 
cur_ev_num
; i < 
Œack
->
	`G‘NumEv’ts
(); i ++) {

629 *
msg
 = 
Œack
->
	`G‘Ev’tAdd»ss
(
i
);

630 ià((*
msg
)->
	`IsNÙeOff
(è&& (*msg)->
	`G‘NÙe
(è=ğ
nÙe
)

631  
Œue
;

633  
çl£
;

634 
	}
}

637 
boŞ
 
	gMIDIT¿ckI‹¿tÜ
::
	$FšdPed®Off
(
MIDITimedMes§ge
** 
msg
) {

638 
i
 = 
cur_ev_num
; i < 
Œack
->
	`G‘NumEv’ts
(); i ++) {

639 *
msg
 = 
Œack
->
	`G‘Ev’tAdd»ss
(
i
);

640 ià((*
msg
)->
	`IsCÚŒŞChªge
(è&& (*msg)->
	`G‘CÚŒŞËr
(è=ğ64 && (*msg)->
	`G‘CÚŒŞËrV®ue
() < 64)

641  
Œue
;

643  
çl£
;

644 
	}
}

647 
boŞ
 
	gMIDIT¿ckI‹¿tÜ
::
	$G‘CurEv’t
(
MIDITimedMes§ge
** 
msg
, 
MIDIClockTime
 
’d
 ) {

648 ià(!
Œack
->
	`IsV®idEv’tNum
(
cur_ev_num
)è 
çl£
;

649 ià(
’d
 < 
cur_time
è 
çl£
;

650 *
msg
 = 
Œack
->
	`G‘Ev’tAdd»ss
(
cur_ev_num
);

651 
MIDIClockTime
 
Ãw_time
 = (*
msg
)->
	`G‘Time
();

652 ià(
Ãw_time
 > 
cur_time
) {

653 ià(
Ãw_time
 > 
’d
)

654  
çl£
;

655 
cur_time
 = 
Ãw_time
;

656 
	`SÿnEv’tsAtThisTime
();

658 
cur_ev_num
++;

659  
Œue
;

660 
	}
}

663 
MIDIClockTime
 
	gMIDIT¿ckI‹¿tÜ
::
	$G‘CurEv’tTime
() const {

664 ià(!
Œack
->
	`IsV®idEv’tNum
(
cur_ev_num
))  0xffffff;

665  
Œack
->
	`G‘Ev’tAdd»ss
(
cur_ev_num
)->
	`G‘Time
();

666 
	}
}

669 
boŞ
 
	gMIDIT¿ckI‹¿tÜ
::
	$Ev’tIsNow
(cÚ¡ 
MIDITimedMes§ge
& 
msg
) {

670 
MIDITimedMes§ge
 
msg1
;

671 
ev_num
;

673 
Œack
->
	`FšdEv’tNumb”
(
cur_time
, &
ev_num
);

674 
Œack
->
	`IsV®idEv’tNum
(
ev_num
è&& (
msg1
 =¿ck->
	`G‘Ev’t
Óv_num)).
	`G‘Time
(è=ğ
cur_time
) {

675 ià(
MIDITimedMes§ge
::
	`IsSameKšd
(
msg1
, 
msg
)è 
Œue
;

676 
ev_num
++;

678  
çl£
;

679 
	}
}

682 
boŞ
 
	gMIDIT¿ckI‹¿tÜ
::
	$GoToNextEv’t
() {

683 ià(!
Œack
->
	`IsV®idEv’tNum
(
cur_ev_num
)è 
çl£
;

684 
cur_ev_num
++;

685 
MIDITimedMes§ge
* 
msg
 = 
Œack
->
	`G‘Ev’tAdd»ss
(
cur_ev_num
);

686 ià(
msg
->
	`G‘Time
(è> 
cur_time
) {

687 
cur_time
 = 
msg
->
	`G‘Time
();

688 
	`SÿnEv’tsAtThisTime
();

690  
Œue
;

691 
	}
}

694 
boŞ
 
	gMIDIT¿ckI‹¿tÜ
::
	$GoToTime
(
MIDIClockTime
 
time
) {

695 
MIDITimedMes§ge
* 
msg
;

697 ià(
time
 > 
Œack
->
	`G‘EndTime
()è 
çl£
;

698 ià(
time
 <ğ
cur_time
)

699 
	`Re£t
();

700 
	`G‘CurEv’tTime
(è< 
time
)

701 
	`G‘CurEv’t
(&
msg
);

702 
cur_time
 = 
time
;

703 
	`SÿnEv’tsAtThisTime
();

704  
Œue
;

705 
	}
}

708 
	gMIDIT¿ckI‹¿tÜ
::
	$FšdChªÃl
() {

709 
chªÃl
 = 0xff;

710 
i
 = 0; i < 
Œack
->
	`G‘NumEv’ts
(); i ++) {

711 ià(
Œack
->
	`G‘Ev’t
(
i
).
	`IsChªÃlMsg
()) {

712 
chªÃl
 = 
Œack
->
	`G‘Ev’t
(
i
).
	`G‘ChªÃl
();

716 
	}
}

719 
boŞ
 
	gMIDIT¿ckI‹¿tÜ
::
	$Proûss
(cÚ¡ 
MIDITimedMes§ge
 *
msg
) {

722 if(
msg
->
	`IsChªÃlMsg
()) {

723 ià(
msg
->
	`G‘ChªÃl
(è!ğ
chªÃl
è 
çl£
;

724 
msg
->
	`G‘Ty³
()) {

725 
NOTE_OFF
 :

726 if(
nÙes_Ú
[
msg
->
	`G‘NÙe
()]) {

727 
nÙes_Ú
[
msg
->
	`G‘NÙe
()] = 0;

728 
num_nÙes_Ú
--;

731 
NOTE_ON
 :

732 ià(
msg
->
	`G‘V–oc™y
()) {

733 ià(!
nÙes_Ú
[
msg
->
	`G‘NÙe
()]) {

734 
nÙes_Ú
[
msg
->
	`G‘NÙe
()] = msg->
	`G‘V–oc™y
();

735 
num_nÙes_Ú
++;

739 ià(
nÙes_Ú
[
msg
->
	`G‘NÙe
()]) {

740 
nÙes_Ú
[
msg
->
	`G‘NÙe
()] = 0;

741 
num_nÙes_Ú
--;

745 
PITCH_BEND
 :

746 
b’d”_v®ue
 = 
msg
->
	`G‘B’d”V®ue
();

748 
CONTROL_CHANGE
 :

749 
cÚŒŞs
[
msg
->
	`G‘CÚŒŞËr
()] = msg->
	`G‘CÚŒŞËrV®ue
();

751 
PROGRAM_CHANGE
 :

752 
´og¿m
 = 
msg
->
	`G‘Prog¿mV®ue
();

755  
Œue
;

757  
çl£
;

758 
	}
}

761 
	gMIDIT¿ckI‹¿tÜ
::
	$SÿnEv’tsAtThisTime
() {

765 
MIDIClockTime
 
Şdtime
 = 
cur_time
;

766 
Şdnum
 = 
cur_ev_num
;

768 
MIDITimedMes§ge
 *
msg
;

770 
	`G‘CurEv’t
(&
msg
, 
Şdtime
))

771 
	`Proûss
(
msg
);

772 
cur_time
 = 
Şdtime
;

773 
cur_ev_num
 = 
Şdnum
;

1540 
	}
}

	@
1
.
0
44
2703
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\advancedsequencer.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\driver.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\dump_tracks.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\file.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\fileread.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\filereadmultitrack.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\filewrite.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\filewritemultitrack.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\manager.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\matrix.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\midi.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\msg.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\multitrack.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\notifier.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\process.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\queue.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\sequencer.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\smpte.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\sysex.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\timer.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\track.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\include\world.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\rtmidi-2.1.1\RtMidi.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\rtmidi-2.1.1\RtMidi.h
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\advancedsequencer.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\driver.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\dump_tracks.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\fileread.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\filereadmultitrack.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\filewrite.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\filewritemultitrack.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\manager.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\matrix.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\midi.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\msg.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\multitrack.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\notifier.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\process.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\queue.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\sequencer.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\smpte.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\sysex.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\timer.cpp
C:\Users\Nicola\Cplusplus\Github\myjdkmidi\src\track.cpp
